2025-04-01 14:18:56,081 - asyncio - DEBUG - Using selector: KqueueSelector
2025-04-01 14:18:56,081 - __main__ - INFO - Starting test run of price finder with detailed logging...
2025-04-01 14:18:56,081 - __main__ - INFO - Running price finder with batch_size=1, state=None
2025-04-01 14:18:56,081 - scripts.run_price_finder - INFO - Starting price finder integration - batch size: 1, state: None
2025-04-01 14:18:56,081 - scripts.run_price_finder - DEBUG - Config loaded: {'serpapi_key': '6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a', 'openai_key': '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', 'mistral_key': '87QKmlS8vjw0woFXpLnUKVIqLkcMa8Lz', 'llm_provider': 'mistral', 'download_dir': 'downloads'}
2025-04-01 14:18:56,082 - scripts.run_price_finder - INFO - Status tracker initialized with database
2025-04-01 14:18:56,082 - src.pipeline.orchestrator - INFO - Initializing pipeline components...
2025-04-01 14:18:56,123 - src.llm.link_analyzer - INFO - Initialized LLMLinkAnalyzer with provider=openai, model=gpt-4o
2025-04-01 14:18:56,130 - src.llm.link_analyzer - INFO - Initialized LLMLinkAnalyzer with provider=openai, model=gpt-4o
2025-04-01 14:18:56,131 - src.pipeline.orchestrator - INFO - Pipeline initialization complete
2025-04-01 14:18:56,131 - scripts.run_price_finder - INFO - PriceFinderPipeline initialized successfully
2025-04-01 14:18:56,163 - scripts.run_price_finder - INFO - Found 1 hospitals to process
2025-04-01 14:18:56,163 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x116bf53d0>, 'address': '150 HOSPITAL DRIVE', 'status': 'OPEN', 'search_status': 'pending', 'population': 28, 'county': 'CRENSHAW', 'health_sys_city': None, 'search_attempts': 0, 'city': 'LUVERNE', 'latitude': 31.69458855, 'health_sys_state': None, 'last_search_date': None, 'state': 'AL', 'longitude': -86.26319151, 'corp_parent_name': None, 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579864), 'id': 'fb2e7f3c-865f-4fe8-87c5-8722d01c09be', 'zip_code': '36049', 'owner': 'PROPRIETARY', 'website': None, 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579865), 'hospital_type': 'PSYCHIATRIC', 'helipad': True, 'price_transparency_url': None, 'name': "BEACONS CHILDREN'S HOSPITAL", 'health_sys_id': 'sys_independent', 'health_sys_name': 'Independent', 'price_file_found': False}
2025-04-01 14:18:56,163 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': 'fb2e7f3c-865f-4fe8-87c5-8722d01c09be', 'name': "BEACONS CHILDREN'S HOSPITAL", 'website': "https://www.beaconschildren'shospital.org", 'city': 'LUVERNE', 'state': 'AL', 'health_system_name': 'Independent'}
2025-04-01 14:18:56,163 - scripts.run_price_finder - INFO - Processing hospital: BEACONS CHILDREN'S HOSPITAL (ID: fb2e7f3c-865f-4fe8-87c5-8722d01c09be)
2025-04-01 14:18:56,166 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='fb2e7f3c-865f-4fe8-87c5-8722d01c09be', name="BEACONS CHILDREN'S HOSPITAL", state='AL', city='LUVERNE', address=None, website="https://www.beaconschildren'shospital.org", health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 14:18:56,168 - scripts.run_price_finder - DEBUG - Registered hospital fb2e7f3c-865f-4fe8-87c5-8722d01c09be with status tracker
2025-04-01 14:18:56,168 - src.pipeline.orchestrator - INFO - Starting price file search for BEACONS CHILDREN'S HOSPITAL (AL)
2025-04-01 14:18:56,168 - src.pipeline.status_tracker - ERROR - Error starting search for hospital fb2e7f3c-865f-4fe8-87c5-8722d01c09be: FOREIGN KEY constraint failed
2025-04-01 14:18:56,168 - src.pipeline.orchestrator - INFO - Searching for price transparency files for BEACONS CHILDREN'S HOSPITAL
2025-04-01 14:18:56,168 - src.searchers.serpapi_search - INFO - Searching for: BEACONS CHILDREN'S HOSPITAL LUVERNE, AL price transparency
2025-04-01 14:18:56,170 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 14:18:59,854 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=BEACONS+CHILDREN%27S+HOSPITAL+LUVERNE%2C+AL+price+transparency&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 14:18:59,856 - src.searchers.serpapi_search - INFO - Found 10 results for query: BEACONS CHILDREN'S HOSPITAL LUVERNE, AL price transparency
2025-04-01 14:18:59,856 - src.searchers.serpapi_search - INFO - Searching for: BEACONS CHILDREN'S HOSPITAL LUVERNE, AL chargemaster
2025-04-01 14:18:59,857 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 14:19:01,777 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=BEACONS+CHILDREN%27S+HOSPITAL+LUVERNE%2C+AL+chargemaster&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 14:19:01,781 - src.searchers.serpapi_search - INFO - Found 10 results for query: BEACONS CHILDREN'S HOSPITAL LUVERNE, AL chargemaster
2025-04-01 14:19:01,781 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for BEACONS CHILDREN'S HOSPITAL
2025-04-01 14:19:01,820 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': "\n        You are an expert at finding hospital price transparency information online.\n        \n        Your task is to analyze search results and determine which links are most likely to contain \n        price transparency information for a specific hospital.\n        \n        Hospital: BEACONS CHILDREN'S HOSPITAL\n        Location: LUVERNE, AL (if city available, otherwise just state)\n        \n        A good price transparency link should:\n        1. Lead directly to a hospital's official price list, chargemaster, or standard charges\n        2. Be from the hospital's official website (preferred) or a trusted healthcare portal\n        3. Contain machine-readable pricing data (CSVs, spreadsheets, or structured data)\n        4. Be specific to the exact hospital, not just the parent health system\n        5. Contain recent (within last 12 months) pricing information\n        \n        Bad links include:\n        1. News articles about price transparency\n        2. General information pages without actual pricing data\n        3. Links for different hospitals or healthcare systems\n        4. Academic or research papers about price transparency\n        5. Government policy pages without hospital-specific data\n        \n        For each link, provide a relevance score from 0.0 to 1.0, where:\n        - 0.0-0.2: Definitely not relevant\n        - 0.3-0.5: Possibly relevant but unclear\n        - 0.6-0.8: Likely relevant\n        - 0.9-1.0: Almost certainly relevant\n        \n        Also provide a brief reasoning for your score.\n        "}, {'role': 'user', 'content': 'Analyze these search results and determine which are most likely to contain price transparency data:\n\nResult 1:\nTitle: Price Transparency\nURL: https://www.beaconbh.com/price-transparency/\nSnippet: Beacon Behavioral Price Transparency. To see the list of standard charges and negotiated rates for services, download the file below.\n\nResult 2:\nTitle: Price Transparency > Beacon Health System\nURL: https://www.beaconhealthsystem.org/hospital-chargemaster/\nSnippet: The information provided in the hospital price transparency links below includes a comprehensive list of charges for each inpatient and outpatient service ...\n\nResult 3:\nTitle: Beacon Behavioral Hospital\nURL: https://www.perimeterhealthcare.com/beacon\nSnippet: Beacon Children\'s Hospital is one of their premier behavioral health hospitals providing inpatient psychiatric treatment for children and teenagers ages 6-17.\n\nResult 4:\nTitle: Perimeter Beacon Behavioral Hospital - Luverne, AL\nURL: https://www.rehab.com/beacon-childrens-hospital\nSnippet: Book an appointment today with Perimeter Beacon Behavioral Hospital located in Luverne, Alabama. See facility photos, get a price quote and read verified ...\n\nResult 5:\nTitle: Beacon Children\'s Hospital\nURL: https://www.medicare.gov/care-compare/details/hospital/014015?city=Luverne&state=AL&zipcode=\nSnippet: Beacon Children\'s Hospital. Overall star rating: Not available 19 ... Luverne, AL 36049. Phone Number. (334) 335-5040. Save to Favorites.\n\nResult 6:\nTitle: Provider Report for Crenshaw Community Hospital\nURL: https://turquoise.health/providers/crenshaw-community-hospital\nSnippet: Are you a transparent provider or payer? There is a market for transparency. Let patients find you by claiming your provider page and listing your services. It ...\n\nResult 7:\nTitle: Working at Beacon Children\'s Hospital in Luverne, AL\nURL: https://www.indeed.com/cmp/Beacon-Children\'s-Hospital/reviews?fcountry=US&floc=Luverne%2C+AL\nSnippet: Beacon is a great place to work if you have a passion to work with children. The management is very compassionate and try their best to work with you.\n\nResult 8:\nTitle: Price Estimator Tool\nURL: https://www.beaconhealthsystem.org/hospital-price-transparency-and-price-estimator-tool/\nSnippet: This online estimator tool provides out-of-pocket estimates for 300 common procedures and services at Beacon Granger, Elkhart General and Memorial hospitals.\n\nResult 9:\nTitle: Beacon Children\'s Hospital Hourly Pay in 2025\nURL: https://www.payscale.com/research/US/Employer=Beacon_Children%27s_Hospital/Hourly_Rate\nSnippet: The average hourly pay for Beacon Children\'s Hospital is $22.86 in 2025. Visit Payscale to research Beacon Children\'s Hospital hourly pay by ...\n\nResult 10:\nTitle: About | Beacon Behavioral Hospital in Luverne, AL\nURL: https://www.perimeterhealthcare.com/beacon-about\nSnippet: Beacon Children\'s Hospital is a family centered treatment environment designed to treat the acute mental and behavioral health needs of children ages 6-17 years ...\n\n\n        Respond in JSON format with an array of objects, each containing:\n        - result_index: index of the result (1-based)\n        - url: the URL\n        - relevance_score: float between 0 and 1\n        - reasoning: brief explanation for the score\n        \n        Example:\n        ```json\n        [\n          {\n            "result_index": 1,\n            "url": "https://example.com/prices",\n            "relevance_score": 0.9,\n            "reasoning": "Official hospital website with direct link to machine-readable files"\n          },\n          ...\n        ]\n        ```\n        '}], 'model': 'gpt-4o', 'max_tokens': 2000, 'temperature': 0.1}}
2025-04-01 14:19:01,826 - httpcore.connection - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-04-01 14:19:01,876 - httpcore.connection - DEBUG - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x114ca8a50>
2025-04-01 14:19:01,876 - httpcore.connection - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x116b17770> server_hostname='api.openai.com' timeout=5.0
2025-04-01 14:19:01,901 - httpcore.connection - DEBUG - start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x117383b10>
2025-04-01 14:19:01,902 - httpcore.http11 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-04-01 14:19:01,902 - httpcore.http11 - DEBUG - send_request_headers.complete
2025-04-01 14:19:01,902 - httpcore.http11 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-04-01 14:19:01,902 - httpcore.http11 - DEBUG - send_request_body.complete
2025-04-01 14:19:01,902 - httpcore.http11 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-04-01 14:19:02,068 - httpcore.http11 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 429, b'Too Many Requests', [(b'Date', b'Tue, 01 Apr 2025 18:19:02 GMT'), (b'Content-Type', b'application/json; charset=utf-8'), (b'Content-Length', b'337'), (b'Connection', b'keep-alive'), (b'vary', b'Origin'), (b'x-request-id', b'req_ca56f5c09b0e96c21538fa3284328de1'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=RCI7glpdVW4S7PNavsis8XsWak2OumWin.IHmtxJWlw-1743531542-1.0.1.1-0fNFgR2Mi.Qlk2MYq29Ajf4hQg5r3kez8XjiYRQXoEqeK7m1FIjal9d5ak.pbyiFN_My_cD0XQZ5exue8EU6sHLpFh7fsQJrzWkCam6hmjU; path=/; expires=Tue, 01-Apr-25 18:49:02 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=Q_w.m1cf7agApC8c1957u50p9zuGtVIadXN2_n949N0-1743531542444-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'929a17ab6db45e7f-EWR'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-04-01 14:19:02,069 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-04-01 14:19:02,070 - httpcore.http11 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-04-01 14:19:02,070 - httpcore.http11 - DEBUG - receive_response_body.complete
2025-04-01 14:19:02,070 - httpcore.http11 - DEBUG - response_closed.started
2025-04-01 14:19:02,070 - httpcore.http11 - DEBUG - response_closed.complete
2025-04-01 14:19:02,070 - openai._base_client - DEBUG - HTTP Request: POST https://api.openai.com/v1/chat/completions "429 Too Many Requests"
2025-04-01 14:19:02,071 - openai._base_client - DEBUG - Encountered httpx.HTTPStatusError
Traceback (most recent call last):
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/openai/_base_client.py", line 1541, in _request
    response.raise_for_status()
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2025-04-01 14:19:02,074 - openai._base_client - DEBUG - Retrying due to status code 429
2025-04-01 14:19:02,074 - openai._base_client - DEBUG - 2 retries left
2025-04-01 14:19:02,074 - openai._base_client - INFO - Retrying request to /chat/completions in 0.397077 seconds
2025-04-01 14:19:02,473 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': "\n        You are an expert at finding hospital price transparency information online.\n        \n        Your task is to analyze search results and determine which links are most likely to contain \n        price transparency information for a specific hospital.\n        \n        Hospital: BEACONS CHILDREN'S HOSPITAL\n        Location: LUVERNE, AL (if city available, otherwise just state)\n        \n        A good price transparency link should:\n        1. Lead directly to a hospital's official price list, chargemaster, or standard charges\n        2. Be from the hospital's official website (preferred) or a trusted healthcare portal\n        3. Contain machine-readable pricing data (CSVs, spreadsheets, or structured data)\n        4. Be specific to the exact hospital, not just the parent health system\n        5. Contain recent (within last 12 months) pricing information\n        \n        Bad links include:\n        1. News articles about price transparency\n        2. General information pages without actual pricing data\n        3. Links for different hospitals or healthcare systems\n        4. Academic or research papers about price transparency\n        5. Government policy pages without hospital-specific data\n        \n        For each link, provide a relevance score from 0.0 to 1.0, where:\n        - 0.0-0.2: Definitely not relevant\n        - 0.3-0.5: Possibly relevant but unclear\n        - 0.6-0.8: Likely relevant\n        - 0.9-1.0: Almost certainly relevant\n        \n        Also provide a brief reasoning for your score.\n        "}, {'role': 'user', 'content': 'Analyze these search results and determine which are most likely to contain price transparency data:\n\nResult 1:\nTitle: Price Transparency\nURL: https://www.beaconbh.com/price-transparency/\nSnippet: Beacon Behavioral Price Transparency. To see the list of standard charges and negotiated rates for services, download the file below.\n\nResult 2:\nTitle: Price Transparency > Beacon Health System\nURL: https://www.beaconhealthsystem.org/hospital-chargemaster/\nSnippet: The information provided in the hospital price transparency links below includes a comprehensive list of charges for each inpatient and outpatient service ...\n\nResult 3:\nTitle: Beacon Behavioral Hospital\nURL: https://www.perimeterhealthcare.com/beacon\nSnippet: Beacon Children\'s Hospital is one of their premier behavioral health hospitals providing inpatient psychiatric treatment for children and teenagers ages 6-17.\n\nResult 4:\nTitle: Perimeter Beacon Behavioral Hospital - Luverne, AL\nURL: https://www.rehab.com/beacon-childrens-hospital\nSnippet: Book an appointment today with Perimeter Beacon Behavioral Hospital located in Luverne, Alabama. See facility photos, get a price quote and read verified ...\n\nResult 5:\nTitle: Beacon Children\'s Hospital\nURL: https://www.medicare.gov/care-compare/details/hospital/014015?city=Luverne&state=AL&zipcode=\nSnippet: Beacon Children\'s Hospital. Overall star rating: Not available 19 ... Luverne, AL 36049. Phone Number. (334) 335-5040. Save to Favorites.\n\nResult 6:\nTitle: Provider Report for Crenshaw Community Hospital\nURL: https://turquoise.health/providers/crenshaw-community-hospital\nSnippet: Are you a transparent provider or payer? There is a market for transparency. Let patients find you by claiming your provider page and listing your services. It ...\n\nResult 7:\nTitle: Working at Beacon Children\'s Hospital in Luverne, AL\nURL: https://www.indeed.com/cmp/Beacon-Children\'s-Hospital/reviews?fcountry=US&floc=Luverne%2C+AL\nSnippet: Beacon is a great place to work if you have a passion to work with children. The management is very compassionate and try their best to work with you.\n\nResult 8:\nTitle: Price Estimator Tool\nURL: https://www.beaconhealthsystem.org/hospital-price-transparency-and-price-estimator-tool/\nSnippet: This online estimator tool provides out-of-pocket estimates for 300 common procedures and services at Beacon Granger, Elkhart General and Memorial hospitals.\n\nResult 9:\nTitle: Beacon Children\'s Hospital Hourly Pay in 2025\nURL: https://www.payscale.com/research/US/Employer=Beacon_Children%27s_Hospital/Hourly_Rate\nSnippet: The average hourly pay for Beacon Children\'s Hospital is $22.86 in 2025. Visit Payscale to research Beacon Children\'s Hospital hourly pay by ...\n\nResult 10:\nTitle: About | Beacon Behavioral Hospital in Luverne, AL\nURL: https://www.perimeterhealthcare.com/beacon-about\nSnippet: Beacon Children\'s Hospital is a family centered treatment environment designed to treat the acute mental and behavioral health needs of children ages 6-17 years ...\n\n\n        Respond in JSON format with an array of objects, each containing:\n        - result_index: index of the result (1-based)\n        - url: the URL\n        - relevance_score: float between 0 and 1\n        - reasoning: brief explanation for the score\n        \n        Example:\n        ```json\n        [\n          {\n            "result_index": 1,\n            "url": "https://example.com/prices",\n            "relevance_score": 0.9,\n            "reasoning": "Official hospital website with direct link to machine-readable files"\n          },\n          ...\n        ]\n        ```\n        '}], 'model': 'gpt-4o', 'max_tokens': 2000, 'temperature': 0.1}}
2025-04-01 14:19:02,475 - httpcore.http11 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-04-01 14:19:02,475 - httpcore.http11 - DEBUG - send_request_headers.complete
2025-04-01 14:19:02,475 - httpcore.http11 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-04-01 14:19:02,476 - httpcore.http11 - DEBUG - send_request_body.complete
2025-04-01 14:19:02,476 - httpcore.http11 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-04-01 14:19:02,637 - httpcore.http11 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 429, b'Too Many Requests', [(b'Date', b'Tue, 01 Apr 2025 18:19:03 GMT'), (b'Content-Type', b'application/json; charset=utf-8'), (b'Content-Length', b'337'), (b'Connection', b'keep-alive'), (b'vary', b'Origin'), (b'x-request-id', b'req_fefa53c359437ee75ac23331f631ce13'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'929a17aefb505e7f-EWR'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-04-01 14:19:02,638 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-04-01 14:19:02,638 - httpcore.http11 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-04-01 14:19:02,638 - httpcore.http11 - DEBUG - receive_response_body.complete
2025-04-01 14:19:02,638 - httpcore.http11 - DEBUG - response_closed.started
2025-04-01 14:19:02,638 - httpcore.http11 - DEBUG - response_closed.complete
2025-04-01 14:19:02,638 - openai._base_client - DEBUG - HTTP Request: POST https://api.openai.com/v1/chat/completions "429 Too Many Requests"
2025-04-01 14:19:02,639 - openai._base_client - DEBUG - Encountered httpx.HTTPStatusError
Traceback (most recent call last):
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/openai/_base_client.py", line 1541, in _request
    response.raise_for_status()
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/openai/_base_client.py", line 1541, in _request
    response.raise_for_status()
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2025-04-01 14:19:02,639 - openai._base_client - DEBUG - Retrying due to status code 429
2025-04-01 14:19:02,639 - openai._base_client - DEBUG - 1 retry left
2025-04-01 14:19:02,640 - openai._base_client - INFO - Retrying request to /chat/completions in 0.930140 seconds
2025-04-01 14:19:03,571 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': "\n        You are an expert at finding hospital price transparency information online.\n        \n        Your task is to analyze search results and determine which links are most likely to contain \n        price transparency information for a specific hospital.\n        \n        Hospital: BEACONS CHILDREN'S HOSPITAL\n        Location: LUVERNE, AL (if city available, otherwise just state)\n        \n        A good price transparency link should:\n        1. Lead directly to a hospital's official price list, chargemaster, or standard charges\n        2. Be from the hospital's official website (preferred) or a trusted healthcare portal\n        3. Contain machine-readable pricing data (CSVs, spreadsheets, or structured data)\n        4. Be specific to the exact hospital, not just the parent health system\n        5. Contain recent (within last 12 months) pricing information\n        \n        Bad links include:\n        1. News articles about price transparency\n        2. General information pages without actual pricing data\n        3. Links for different hospitals or healthcare systems\n        4. Academic or research papers about price transparency\n        5. Government policy pages without hospital-specific data\n        \n        For each link, provide a relevance score from 0.0 to 1.0, where:\n        - 0.0-0.2: Definitely not relevant\n        - 0.3-0.5: Possibly relevant but unclear\n        - 0.6-0.8: Likely relevant\n        - 0.9-1.0: Almost certainly relevant\n        \n        Also provide a brief reasoning for your score.\n        "}, {'role': 'user', 'content': 'Analyze these search results and determine which are most likely to contain price transparency data:\n\nResult 1:\nTitle: Price Transparency\nURL: https://www.beaconbh.com/price-transparency/\nSnippet: Beacon Behavioral Price Transparency. To see the list of standard charges and negotiated rates for services, download the file below.\n\nResult 2:\nTitle: Price Transparency > Beacon Health System\nURL: https://www.beaconhealthsystem.org/hospital-chargemaster/\nSnippet: The information provided in the hospital price transparency links below includes a comprehensive list of charges for each inpatient and outpatient service ...\n\nResult 3:\nTitle: Beacon Behavioral Hospital\nURL: https://www.perimeterhealthcare.com/beacon\nSnippet: Beacon Children\'s Hospital is one of their premier behavioral health hospitals providing inpatient psychiatric treatment for children and teenagers ages 6-17.\n\nResult 4:\nTitle: Perimeter Beacon Behavioral Hospital - Luverne, AL\nURL: https://www.rehab.com/beacon-childrens-hospital\nSnippet: Book an appointment today with Perimeter Beacon Behavioral Hospital located in Luverne, Alabama. See facility photos, get a price quote and read verified ...\n\nResult 5:\nTitle: Beacon Children\'s Hospital\nURL: https://www.medicare.gov/care-compare/details/hospital/014015?city=Luverne&state=AL&zipcode=\nSnippet: Beacon Children\'s Hospital. Overall star rating: Not available 19 ... Luverne, AL 36049. Phone Number. (334) 335-5040. Save to Favorites.\n\nResult 6:\nTitle: Provider Report for Crenshaw Community Hospital\nURL: https://turquoise.health/providers/crenshaw-community-hospital\nSnippet: Are you a transparent provider or payer? There is a market for transparency. Let patients find you by claiming your provider page and listing your services. It ...\n\nResult 7:\nTitle: Working at Beacon Children\'s Hospital in Luverne, AL\nURL: https://www.indeed.com/cmp/Beacon-Children\'s-Hospital/reviews?fcountry=US&floc=Luverne%2C+AL\nSnippet: Beacon is a great place to work if you have a passion to work with children. The management is very compassionate and try their best to work with you.\n\nResult 8:\nTitle: Price Estimator Tool\nURL: https://www.beaconhealthsystem.org/hospital-price-transparency-and-price-estimator-tool/\nSnippet: This online estimator tool provides out-of-pocket estimates for 300 common procedures and services at Beacon Granger, Elkhart General and Memorial hospitals.\n\nResult 9:\nTitle: Beacon Children\'s Hospital Hourly Pay in 2025\nURL: https://www.payscale.com/research/US/Employer=Beacon_Children%27s_Hospital/Hourly_Rate\nSnippet: The average hourly pay for Beacon Children\'s Hospital is $22.86 in 2025. Visit Payscale to research Beacon Children\'s Hospital hourly pay by ...\n\nResult 10:\nTitle: About | Beacon Behavioral Hospital in Luverne, AL\nURL: https://www.perimeterhealthcare.com/beacon-about\nSnippet: Beacon Children\'s Hospital is a family centered treatment environment designed to treat the acute mental and behavioral health needs of children ages 6-17 years ...\n\n\n        Respond in JSON format with an array of objects, each containing:\n        - result_index: index of the result (1-based)\n        - url: the URL\n        - relevance_score: float between 0 and 1\n        - reasoning: brief explanation for the score\n        \n        Example:\n        ```json\n        [\n          {\n            "result_index": 1,\n            "url": "https://example.com/prices",\n            "relevance_score": 0.9,\n            "reasoning": "Official hospital website with direct link to machine-readable files"\n          },\n          ...\n        ]\n        ```\n        '}], 'model': 'gpt-4o', 'max_tokens': 2000, 'temperature': 0.1}}
2025-04-01 14:19:03,573 - httpcore.http11 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-04-01 14:19:03,574 - httpcore.http11 - DEBUG - send_request_headers.complete
2025-04-01 14:19:03,574 - httpcore.http11 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-04-01 14:19:03,574 - httpcore.http11 - DEBUG - send_request_body.complete
2025-04-01 14:19:03,574 - httpcore.http11 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-04-01 14:19:03,760 - httpcore.http11 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 429, b'Too Many Requests', [(b'Date', b'Tue, 01 Apr 2025 18:19:04 GMT'), (b'Content-Type', b'application/json; charset=utf-8'), (b'Content-Length', b'337'), (b'Connection', b'keep-alive'), (b'vary', b'Origin'), (b'x-request-id', b'req_82519e315890ff672f1acdd02877725f'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'929a17b5de805e7f-EWR'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-04-01 14:19:03,760 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-04-01 14:19:03,760 - httpcore.http11 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-04-01 14:19:03,760 - httpcore.http11 - DEBUG - receive_response_body.complete
2025-04-01 14:19:03,760 - httpcore.http11 - DEBUG - response_closed.started
2025-04-01 14:19:03,761 - httpcore.http11 - DEBUG - response_closed.complete
2025-04-01 14:19:03,761 - openai._base_client - DEBUG - HTTP Request: POST https://api.openai.com/v1/chat/completions "429 Too Many Requests"
2025-04-01 14:19:03,761 - openai._base_client - DEBUG - Encountered httpx.HTTPStatusError
Traceback (most recent call last):
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/openai/_base_client.py", line 1541, in _request
    response.raise_for_status()
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/openai/_base_client.py", line 1541, in _request
    response.raise_for_status()
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/openai/_base_client.py", line 1541, in _request
    response.raise_for_status()
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2025-04-01 14:19:03,762 - openai._base_client - DEBUG - Re-raising status error
2025-04-01 14:19:03,763 - src.llm.link_analyzer - ERROR - Error calling OpenAI API: Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}}
2025-04-01 14:19:03,763 - src.pipeline.orchestrator - WARNING - No relevant links found for BEACONS CHILDREN'S HOSPITAL
2025-04-01 14:19:03,764 - src.pipeline.status_tracker - ERROR - Error marking failure for hospital fb2e7f3c-865f-4fe8-87c5-8722d01c09be: FOREIGN KEY constraint failed
2025-04-01 14:19:03,764 - src.pipeline.orchestrator - INFO - Search for BEACONS CHILDREN'S HOSPITAL completed in 7.60 seconds
2025-04-01 14:19:03,764 - scripts.run_price_finder - WARNING - Price finder returned None
2025-04-01 14:19:03,775 - scripts.run_price_finder - INFO - Successfully processed hospital BEACONS CHILDREN'S HOSPITAL
2025-04-01 14:19:03,775 - __main__ - INFO - Price finder completed with result: {'hospitals_processed': 1, 'files_found': 0, 'files_validated': 0, 'errors': 0, 'start_time': '2025-04-01T14:18:56.081813', 'end_time': '2025-04-01T14:19:03.775310'}
2025-04-01 14:20:34,989 - asyncio - DEBUG - Using selector: KqueueSelector
2025-04-01 14:21:14,415 - asyncio - DEBUG - Using selector: KqueueSelector
2025-04-01 14:21:14,415 - scripts.run_price_finder - INFO - Starting price finder integration - batch size: 1, state: None
2025-04-01 14:21:14,415 - scripts.run_price_finder - DEBUG - Config loaded: {'serpapi_key': '6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a', 'openai_key': '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', 'mistral_key': '87QKmlS8vjw0woFXpLnUKVIqLkcMa8Lz', 'llm_provider': 'mistral', 'download_dir': 'downloads'}
2025-04-01 14:21:14,418 - scripts.run_price_finder - INFO - Status tracker initialized with database
2025-04-01 14:21:14,418 - src.pipeline.orchestrator - INFO - Initializing pipeline components...
2025-04-01 14:21:14,446 - src.llm.link_analyzer - INFO - Initialized LLMLinkAnalyzer with provider=openai, model=gpt-4o
2025-04-01 14:21:14,455 - src.llm.link_analyzer - INFO - Initialized LLMLinkAnalyzer with provider=openai, model=gpt-4o
2025-04-01 14:21:14,456 - src.pipeline.orchestrator - INFO - Pipeline initialization complete
2025-04-01 14:21:14,456 - scripts.run_price_finder - INFO - PriceFinderPipeline initialized successfully
2025-04-01 14:21:14,507 - scripts.run_price_finder - INFO - Found 1 hospitals to process
2025-04-01 14:21:14,507 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x10be76510>, 'name': 'BIBB MEDICAL CENTER', 'hospital_type': 'GENERAL ACUTE CARE', 'health_sys_id': 'sys_independent', 'health_sys_name': 'Independent', 'price_file_found': False, 'address': '208 PIERSON AVENUE', 'status': 'OPEN', 'search_status': 'pending', 'population': 35, 'county': 'BIBB', 'health_sys_city': None, 'search_attempts': 0, 'city': 'CENTREVILLE', 'latitude': 32.95135837, 'health_sys_state': None, 'last_search_date': None, 'state': 'AL', 'longitude': -87.14831123, 'corp_parent_name': None, 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579865), 'id': '964b656b-0ae3-4638-9a00-a04ba8d82dda', 'zip_code': '35042', 'owner': 'GOVERNMENT - DISTRICT/AUTHORITY', 'website': None, 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579865), 'helipad': True, 'price_transparency_url': None}
2025-04-01 14:21:14,508 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': '964b656b-0ae3-4638-9a00-a04ba8d82dda', 'name': 'BIBB MEDICAL CENTER', 'website': 'https://www.bibbmedicalcenter.org', 'city': 'CENTREVILLE', 'state': 'AL', 'health_system_name': 'Independent'}
2025-04-01 14:21:14,508 - scripts.run_price_finder - INFO - Processing hospital: BIBB MEDICAL CENTER (ID: 964b656b-0ae3-4638-9a00-a04ba8d82dda)
2025-04-01 14:21:14,511 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='964b656b-0ae3-4638-9a00-a04ba8d82dda', name='BIBB MEDICAL CENTER', state='AL', city='CENTREVILLE', address=None, website='https://www.bibbmedicalcenter.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 14:21:14,513 - scripts.run_price_finder - DEBUG - Registered hospital 964b656b-0ae3-4638-9a00-a04ba8d82dda with status tracker
2025-04-01 14:21:14,513 - src.pipeline.orchestrator - INFO - Starting price file search for BIBB MEDICAL CENTER (AL)
2025-04-01 14:21:14,514 - src.pipeline.status_tracker - ERROR - Error starting search for hospital 964b656b-0ae3-4638-9a00-a04ba8d82dda: FOREIGN KEY constraint failed
2025-04-01 14:21:14,514 - src.pipeline.orchestrator - INFO - Searching for price transparency files for BIBB MEDICAL CENTER
2025-04-01 14:21:14,514 - src.searchers.serpapi_search - INFO - Searching for: BIBB MEDICAL CENTER CENTREVILLE, AL price transparency
2025-04-01 14:21:14,515 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 14:21:16,617 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=BIBB+MEDICAL+CENTER+CENTREVILLE%2C+AL+price+transparency&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 14:21:16,625 - src.searchers.serpapi_search - INFO - Found 10 results for query: BIBB MEDICAL CENTER CENTREVILLE, AL price transparency
2025-04-01 14:21:16,625 - src.searchers.serpapi_search - INFO - Searching for: BIBB MEDICAL CENTER CENTREVILLE, AL chargemaster
2025-04-01 14:21:16,627 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 14:21:19,362 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=BIBB+MEDICAL+CENTER+CENTREVILLE%2C+AL+chargemaster&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 14:21:19,366 - src.searchers.serpapi_search - INFO - Found 9 results for query: BIBB MEDICAL CENTER CENTREVILLE, AL chargemaster
2025-04-01 14:21:19,366 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for BIBB MEDICAL CENTER
2025-04-01 14:21:19,394 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': "\n        You are an expert at finding hospital price transparency information online.\n        \n        Your task is to analyze search results and determine which links are most likely to contain \n        price transparency information for a specific hospital.\n        \n        Hospital: BIBB MEDICAL CENTER\n        Location: CENTREVILLE, AL (if city available, otherwise just state)\n        \n        A good price transparency link should:\n        1. Lead directly to a hospital's official price list, chargemaster, or standard charges\n        2. Be from the hospital's official website (preferred) or a trusted healthcare portal\n        3. Contain machine-readable pricing data (CSVs, spreadsheets, or structured data)\n        4. Be specific to the exact hospital, not just the parent health system\n        5. Contain recent (within last 12 months) pricing information\n        \n        Bad links include:\n        1. News articles about price transparency\n        2. General information pages without actual pricing data\n        3. Links for different hospitals or healthcare systems\n        4. Academic or research papers about price transparency\n        5. Government policy pages without hospital-specific data\n        \n        For each link, provide a relevance score from 0.0 to 1.0, where:\n        - 0.0-0.2: Definitely not relevant\n        - 0.3-0.5: Possibly relevant but unclear\n        - 0.6-0.8: Likely relevant\n        - 0.9-1.0: Almost certainly relevant\n        \n        Also provide a brief reasoning for your score.\n        "}, {'role': 'user', 'content': 'Analyze these search results and determine which are most likely to contain price transparency data:\n\nResult 1:\nTitle: Hospital | Bibb Medical Center | Centreville | Alabama\nURL: https://www.bibbmedicalcenter.com/\nSnippet: Bibb Medical Center is dedicated to providing quality healthcare to Bibb County & surrounding areas ... Price Transparency Information. © 2021 by Bibb Medical ...\n\nResult 2:\nTitle: Nursing Home | Bibb Medical Center | Centreville | Alabama\nURL: https://www.bibbmed.com/skilled-nursing-facility\nSnippet: SKILLED NURSING FACILITY ... Centreville, Alabama 35042. Main: 205-926-4881 · Facebook · Get Directions · Privacy Policy · Price Transparency Information.\n\nResult 3:\nTitle: Name: Bibb Medical Center\nURL: https://josephpcohen.com/chargemaster/hospital/1588131643\nSnippet: Name: Bibb Medical Center. NPI Number: 1588131643. Address: 208 Pierson Ave, Centreville, Alabama, 35042. Chargemaster Source: URL. Most recent prices added ...\n\nResult 4:\nTitle: Pharmacy | Bibb Medical Center | Centreville | Alabama\nURL: https://www.bibbmed.com/pharmacy\nSnippet: Centreville, Alabama 35042. Main: 205-926-4881 · Facebook · Get Directions · Privacy Policy · Price Transparency Information. © 2021 by Bibb Medical Center, All ...\n\nResult 5:\nTitle: Laboratory | Bibb Medical Center | Centreville | Alabama\nURL: https://www.bibbmed.com/laboratory-services\nSnippet: Centreville, Alabama 35042. Main: 205-926-4881 · Facebook · Get Directions · Privacy Policy · Price Transparency Information. © 2021 by Bibb Medical Center, All ...\n\nResult 6:\nTitle: Bibb Medical Center (010058) - Free Profile\nURL: https://www.ahd.com/free_profile/010058/Bibb_Medical_Center/Centreville/Alabama/\nSnippet: Name and Address: Bibb Medical Center 208 Pierson Avenue Centreville, AL 35042. Telephone Number: (205) 926-4881. Hospital Website: www.bibbmed.com/.\n\nResult 7:\nTitle: Bibb Medical Associates | Clinic\nURL: https://www.bibbmed.com/bmaclinic\nSnippet: Bibb Medical Center · Your choice for QUALITY HEALTHCARE · 205-926-4881 ... Price Transparency Information. © 2021 by Bibb Medical Center, All Rights ...\n\nResult 8:\nTitle: bibb medical center - Covered Entity Details - HRSA\nURL: https://340bopais.hrsa.gov/cedetails/53795\nSnippet: Bibb Medical Center Joseph ... CENTREVILLE, AL 35042. Billing Address Same as Street Address. Comments; Medicaid Billing; Shipping Addresses; Contract Pharmacies ...\n\nResult 9:\nTitle: Provider Report for Bibb Medical Center\nURL: https://turquoise.health/providers/bibb-medical-center\nSnippet: Detailed provider report for Bibb Medical Center in Centreville, AL ... Price transparency hub. Blog. Latest news and updates. Live MRF Tracker. Tracking ...\n\nResult 10:\nTitle: Medical Records | Bibb Medical Center | Centreville\nURL: https://www.bibbmed.com/medical-records\nSnippet: Release forms are available at the hospital front desk. There is a charge of $1.00 per sheet for the first 25 sheets, and .50 per sheet thereafter. Once ...\n\n\n        Respond in JSON format with an array of objects, each containing:\n        - result_index: index of the result (1-based)\n        - url: the URL\n        - relevance_score: float between 0 and 1\n        - reasoning: brief explanation for the score\n        \n        Example:\n        ```json\n        [\n          {\n            "result_index": 1,\n            "url": "https://example.com/prices",\n            "relevance_score": 0.9,\n            "reasoning": "Official hospital website with direct link to machine-readable files"\n          },\n          ...\n        ]\n        ```\n        '}], 'model': 'gpt-4o', 'max_tokens': 2000, 'temperature': 0.1}}
2025-04-01 14:21:19,399 - httpcore.connection - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-04-01 14:21:19,631 - httpcore.connection - DEBUG - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10bece290>
2025-04-01 14:21:19,632 - httpcore.connection - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x10bd7f890> server_hostname='api.openai.com' timeout=5.0
2025-04-01 14:21:20,210 - httpcore.connection - DEBUG - start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10bee7290>
2025-04-01 14:21:20,211 - httpcore.http11 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-04-01 14:21:20,211 - httpcore.http11 - DEBUG - send_request_headers.complete
2025-04-01 14:21:20,211 - httpcore.http11 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-04-01 14:21:20,212 - httpcore.http11 - DEBUG - send_request_body.complete
2025-04-01 14:21:20,212 - httpcore.http11 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-04-01 14:21:21,812 - httpcore.http11 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 429, b'Too Many Requests', [(b'Date', b'Tue, 01 Apr 2025 18:21:22 GMT'), (b'Content-Type', b'application/json; charset=utf-8'), (b'Content-Length', b'337'), (b'Connection', b'keep-alive'), (b'vary', b'Origin'), (b'x-request-id', b'req_82119cee37e686a4f0a445dc2aa5c5fa'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=yllgrq7Ug6zEKZWfQ3vkkF19MkdrUHdnnbFC8Av4er4-1743531682-1.0.1.1-i8gzGlpD1ZIvBHAKoICIdsYLl9ksygp9hoDABYJrgeaVeuh5lG.ajiJ4NE7dNdLiyzXVQWPFm6gF60Qm99l250VgcONqLKqeG5FSNCtxJaA; path=/; expires=Tue, 01-Apr-25 18:51:22 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=kZgYEzW_ch88Q3WOZu7YV2ypCkqnTvj1P0NZrwS_2v4-1743531682195-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'929a1b0e6d3d423e-EWR'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-04-01 14:21:21,814 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-04-01 14:21:21,814 - httpcore.http11 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-04-01 14:21:21,814 - httpcore.http11 - DEBUG - receive_response_body.complete
2025-04-01 14:21:21,814 - httpcore.http11 - DEBUG - response_closed.started
2025-04-01 14:21:21,814 - httpcore.http11 - DEBUG - response_closed.complete
2025-04-01 14:21:21,815 - openai._base_client - DEBUG - HTTP Request: POST https://api.openai.com/v1/chat/completions "429 Too Many Requests"
2025-04-01 14:21:21,815 - openai._base_client - DEBUG - Encountered httpx.HTTPStatusError
Traceback (most recent call last):
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/openai/_base_client.py", line 1541, in _request
    response.raise_for_status()
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2025-04-01 14:21:21,819 - openai._base_client - DEBUG - Retrying due to status code 429
2025-04-01 14:21:21,819 - openai._base_client - DEBUG - 2 retries left
2025-04-01 14:21:21,819 - openai._base_client - INFO - Retrying request to /chat/completions in 0.412371 seconds
2025-04-01 14:21:22,233 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': "\n        You are an expert at finding hospital price transparency information online.\n        \n        Your task is to analyze search results and determine which links are most likely to contain \n        price transparency information for a specific hospital.\n        \n        Hospital: BIBB MEDICAL CENTER\n        Location: CENTREVILLE, AL (if city available, otherwise just state)\n        \n        A good price transparency link should:\n        1. Lead directly to a hospital's official price list, chargemaster, or standard charges\n        2. Be from the hospital's official website (preferred) or a trusted healthcare portal\n        3. Contain machine-readable pricing data (CSVs, spreadsheets, or structured data)\n        4. Be specific to the exact hospital, not just the parent health system\n        5. Contain recent (within last 12 months) pricing information\n        \n        Bad links include:\n        1. News articles about price transparency\n        2. General information pages without actual pricing data\n        3. Links for different hospitals or healthcare systems\n        4. Academic or research papers about price transparency\n        5. Government policy pages without hospital-specific data\n        \n        For each link, provide a relevance score from 0.0 to 1.0, where:\n        - 0.0-0.2: Definitely not relevant\n        - 0.3-0.5: Possibly relevant but unclear\n        - 0.6-0.8: Likely relevant\n        - 0.9-1.0: Almost certainly relevant\n        \n        Also provide a brief reasoning for your score.\n        "}, {'role': 'user', 'content': 'Analyze these search results and determine which are most likely to contain price transparency data:\n\nResult 1:\nTitle: Hospital | Bibb Medical Center | Centreville | Alabama\nURL: https://www.bibbmedicalcenter.com/\nSnippet: Bibb Medical Center is dedicated to providing quality healthcare to Bibb County & surrounding areas ... Price Transparency Information. © 2021 by Bibb Medical ...\n\nResult 2:\nTitle: Nursing Home | Bibb Medical Center | Centreville | Alabama\nURL: https://www.bibbmed.com/skilled-nursing-facility\nSnippet: SKILLED NURSING FACILITY ... Centreville, Alabama 35042. Main: 205-926-4881 · Facebook · Get Directions · Privacy Policy · Price Transparency Information.\n\nResult 3:\nTitle: Name: Bibb Medical Center\nURL: https://josephpcohen.com/chargemaster/hospital/1588131643\nSnippet: Name: Bibb Medical Center. NPI Number: 1588131643. Address: 208 Pierson Ave, Centreville, Alabama, 35042. Chargemaster Source: URL. Most recent prices added ...\n\nResult 4:\nTitle: Pharmacy | Bibb Medical Center | Centreville | Alabama\nURL: https://www.bibbmed.com/pharmacy\nSnippet: Centreville, Alabama 35042. Main: 205-926-4881 · Facebook · Get Directions · Privacy Policy · Price Transparency Information. © 2021 by Bibb Medical Center, All ...\n\nResult 5:\nTitle: Laboratory | Bibb Medical Center | Centreville | Alabama\nURL: https://www.bibbmed.com/laboratory-services\nSnippet: Centreville, Alabama 35042. Main: 205-926-4881 · Facebook · Get Directions · Privacy Policy · Price Transparency Information. © 2021 by Bibb Medical Center, All ...\n\nResult 6:\nTitle: Bibb Medical Center (010058) - Free Profile\nURL: https://www.ahd.com/free_profile/010058/Bibb_Medical_Center/Centreville/Alabama/\nSnippet: Name and Address: Bibb Medical Center 208 Pierson Avenue Centreville, AL 35042. Telephone Number: (205) 926-4881. Hospital Website: www.bibbmed.com/.\n\nResult 7:\nTitle: Bibb Medical Associates | Clinic\nURL: https://www.bibbmed.com/bmaclinic\nSnippet: Bibb Medical Center · Your choice for QUALITY HEALTHCARE · 205-926-4881 ... Price Transparency Information. © 2021 by Bibb Medical Center, All Rights ...\n\nResult 8:\nTitle: bibb medical center - Covered Entity Details - HRSA\nURL: https://340bopais.hrsa.gov/cedetails/53795\nSnippet: Bibb Medical Center Joseph ... CENTREVILLE, AL 35042. Billing Address Same as Street Address. Comments; Medicaid Billing; Shipping Addresses; Contract Pharmacies ...\n\nResult 9:\nTitle: Provider Report for Bibb Medical Center\nURL: https://turquoise.health/providers/bibb-medical-center\nSnippet: Detailed provider report for Bibb Medical Center in Centreville, AL ... Price transparency hub. Blog. Latest news and updates. Live MRF Tracker. Tracking ...\n\nResult 10:\nTitle: Medical Records | Bibb Medical Center | Centreville\nURL: https://www.bibbmed.com/medical-records\nSnippet: Release forms are available at the hospital front desk. There is a charge of $1.00 per sheet for the first 25 sheets, and .50 per sheet thereafter. Once ...\n\n\n        Respond in JSON format with an array of objects, each containing:\n        - result_index: index of the result (1-based)\n        - url: the URL\n        - relevance_score: float between 0 and 1\n        - reasoning: brief explanation for the score\n        \n        Example:\n        ```json\n        [\n          {\n            "result_index": 1,\n            "url": "https://example.com/prices",\n            "relevance_score": 0.9,\n            "reasoning": "Official hospital website with direct link to machine-readable files"\n          },\n          ...\n        ]\n        ```\n        '}], 'model': 'gpt-4o', 'max_tokens': 2000, 'temperature': 0.1}}
2025-04-01 14:21:22,235 - httpcore.http11 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-04-01 14:21:22,235 - httpcore.http11 - DEBUG - send_request_headers.complete
2025-04-01 14:21:22,235 - httpcore.http11 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-04-01 14:21:22,235 - httpcore.http11 - DEBUG - send_request_body.complete
2025-04-01 14:21:22,235 - httpcore.http11 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-04-01 14:21:23,801 - httpcore.http11 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 429, b'Too Many Requests', [(b'Date', b'Tue, 01 Apr 2025 18:21:24 GMT'), (b'Content-Type', b'application/json; charset=utf-8'), (b'Content-Length', b'337'), (b'Connection', b'keep-alive'), (b'vary', b'Origin'), (b'x-request-id', b'req_7f298b3793c988167ff1de1d1f52e836'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'929a1b187b7f423e-EWR'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-04-01 14:21:23,802 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-04-01 14:21:23,802 - httpcore.http11 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-04-01 14:21:23,802 - httpcore.http11 - DEBUG - receive_response_body.complete
2025-04-01 14:21:23,802 - httpcore.http11 - DEBUG - response_closed.started
2025-04-01 14:21:23,802 - httpcore.http11 - DEBUG - response_closed.complete
2025-04-01 14:21:23,803 - openai._base_client - DEBUG - HTTP Request: POST https://api.openai.com/v1/chat/completions "429 Too Many Requests"
2025-04-01 14:21:23,803 - openai._base_client - DEBUG - Encountered httpx.HTTPStatusError
Traceback (most recent call last):
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/openai/_base_client.py", line 1541, in _request
    response.raise_for_status()
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/openai/_base_client.py", line 1541, in _request
    response.raise_for_status()
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2025-04-01 14:21:23,803 - openai._base_client - DEBUG - Retrying due to status code 429
2025-04-01 14:21:23,804 - openai._base_client - DEBUG - 1 retry left
2025-04-01 14:21:23,804 - openai._base_client - INFO - Retrying request to /chat/completions in 0.996897 seconds
2025-04-01 14:21:24,802 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': "\n        You are an expert at finding hospital price transparency information online.\n        \n        Your task is to analyze search results and determine which links are most likely to contain \n        price transparency information for a specific hospital.\n        \n        Hospital: BIBB MEDICAL CENTER\n        Location: CENTREVILLE, AL (if city available, otherwise just state)\n        \n        A good price transparency link should:\n        1. Lead directly to a hospital's official price list, chargemaster, or standard charges\n        2. Be from the hospital's official website (preferred) or a trusted healthcare portal\n        3. Contain machine-readable pricing data (CSVs, spreadsheets, or structured data)\n        4. Be specific to the exact hospital, not just the parent health system\n        5. Contain recent (within last 12 months) pricing information\n        \n        Bad links include:\n        1. News articles about price transparency\n        2. General information pages without actual pricing data\n        3. Links for different hospitals or healthcare systems\n        4. Academic or research papers about price transparency\n        5. Government policy pages without hospital-specific data\n        \n        For each link, provide a relevance score from 0.0 to 1.0, where:\n        - 0.0-0.2: Definitely not relevant\n        - 0.3-0.5: Possibly relevant but unclear\n        - 0.6-0.8: Likely relevant\n        - 0.9-1.0: Almost certainly relevant\n        \n        Also provide a brief reasoning for your score.\n        "}, {'role': 'user', 'content': 'Analyze these search results and determine which are most likely to contain price transparency data:\n\nResult 1:\nTitle: Hospital | Bibb Medical Center | Centreville | Alabama\nURL: https://www.bibbmedicalcenter.com/\nSnippet: Bibb Medical Center is dedicated to providing quality healthcare to Bibb County & surrounding areas ... Price Transparency Information. © 2021 by Bibb Medical ...\n\nResult 2:\nTitle: Nursing Home | Bibb Medical Center | Centreville | Alabama\nURL: https://www.bibbmed.com/skilled-nursing-facility\nSnippet: SKILLED NURSING FACILITY ... Centreville, Alabama 35042. Main: 205-926-4881 · Facebook · Get Directions · Privacy Policy · Price Transparency Information.\n\nResult 3:\nTitle: Name: Bibb Medical Center\nURL: https://josephpcohen.com/chargemaster/hospital/1588131643\nSnippet: Name: Bibb Medical Center. NPI Number: 1588131643. Address: 208 Pierson Ave, Centreville, Alabama, 35042. Chargemaster Source: URL. Most recent prices added ...\n\nResult 4:\nTitle: Pharmacy | Bibb Medical Center | Centreville | Alabama\nURL: https://www.bibbmed.com/pharmacy\nSnippet: Centreville, Alabama 35042. Main: 205-926-4881 · Facebook · Get Directions · Privacy Policy · Price Transparency Information. © 2021 by Bibb Medical Center, All ...\n\nResult 5:\nTitle: Laboratory | Bibb Medical Center | Centreville | Alabama\nURL: https://www.bibbmed.com/laboratory-services\nSnippet: Centreville, Alabama 35042. Main: 205-926-4881 · Facebook · Get Directions · Privacy Policy · Price Transparency Information. © 2021 by Bibb Medical Center, All ...\n\nResult 6:\nTitle: Bibb Medical Center (010058) - Free Profile\nURL: https://www.ahd.com/free_profile/010058/Bibb_Medical_Center/Centreville/Alabama/\nSnippet: Name and Address: Bibb Medical Center 208 Pierson Avenue Centreville, AL 35042. Telephone Number: (205) 926-4881. Hospital Website: www.bibbmed.com/.\n\nResult 7:\nTitle: Bibb Medical Associates | Clinic\nURL: https://www.bibbmed.com/bmaclinic\nSnippet: Bibb Medical Center · Your choice for QUALITY HEALTHCARE · 205-926-4881 ... Price Transparency Information. © 2021 by Bibb Medical Center, All Rights ...\n\nResult 8:\nTitle: bibb medical center - Covered Entity Details - HRSA\nURL: https://340bopais.hrsa.gov/cedetails/53795\nSnippet: Bibb Medical Center Joseph ... CENTREVILLE, AL 35042. Billing Address Same as Street Address. Comments; Medicaid Billing; Shipping Addresses; Contract Pharmacies ...\n\nResult 9:\nTitle: Provider Report for Bibb Medical Center\nURL: https://turquoise.health/providers/bibb-medical-center\nSnippet: Detailed provider report for Bibb Medical Center in Centreville, AL ... Price transparency hub. Blog. Latest news and updates. Live MRF Tracker. Tracking ...\n\nResult 10:\nTitle: Medical Records | Bibb Medical Center | Centreville\nURL: https://www.bibbmed.com/medical-records\nSnippet: Release forms are available at the hospital front desk. There is a charge of $1.00 per sheet for the first 25 sheets, and .50 per sheet thereafter. Once ...\n\n\n        Respond in JSON format with an array of objects, each containing:\n        - result_index: index of the result (1-based)\n        - url: the URL\n        - relevance_score: float between 0 and 1\n        - reasoning: brief explanation for the score\n        \n        Example:\n        ```json\n        [\n          {\n            "result_index": 1,\n            "url": "https://example.com/prices",\n            "relevance_score": 0.9,\n            "reasoning": "Official hospital website with direct link to machine-readable files"\n          },\n          ...\n        ]\n        ```\n        '}], 'model': 'gpt-4o', 'max_tokens': 2000, 'temperature': 0.1}}
2025-04-01 14:21:24,803 - httpcore.http11 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-04-01 14:21:24,804 - httpcore.http11 - DEBUG - send_request_headers.complete
2025-04-01 14:21:24,804 - httpcore.http11 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-04-01 14:21:24,804 - httpcore.http11 - DEBUG - send_request_body.complete
2025-04-01 14:21:24,804 - httpcore.http11 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-04-01 14:21:24,937 - httpcore.http11 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 429, b'Too Many Requests', [(b'Date', b'Tue, 01 Apr 2025 18:21:25 GMT'), (b'Content-Type', b'application/json; charset=utf-8'), (b'Content-Length', b'337'), (b'Connection', b'keep-alive'), (b'vary', b'Origin'), (b'x-request-id', b'req_d924ac3024d4c4c58ab14b4bc0be7886'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'929a1b288f05423e-EWR'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-04-01 14:21:24,938 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-04-01 14:21:24,938 - httpcore.http11 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-04-01 14:21:24,938 - httpcore.http11 - DEBUG - receive_response_body.complete
2025-04-01 14:21:24,938 - httpcore.http11 - DEBUG - response_closed.started
2025-04-01 14:21:24,938 - httpcore.http11 - DEBUG - response_closed.complete
2025-04-01 14:21:24,938 - openai._base_client - DEBUG - HTTP Request: POST https://api.openai.com/v1/chat/completions "429 Too Many Requests"
2025-04-01 14:21:24,938 - openai._base_client - DEBUG - Encountered httpx.HTTPStatusError
Traceback (most recent call last):
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/openai/_base_client.py", line 1541, in _request
    response.raise_for_status()
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/openai/_base_client.py", line 1541, in _request
    response.raise_for_status()
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/openai/_base_client.py", line 1541, in _request
    response.raise_for_status()
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2025-04-01 14:21:24,939 - openai._base_client - DEBUG - Re-raising status error
2025-04-01 14:21:24,942 - src.llm.link_analyzer - ERROR - Error calling OpenAI API: Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}}
2025-04-01 14:21:24,942 - src.pipeline.orchestrator - WARNING - No relevant links found for BIBB MEDICAL CENTER
2025-04-01 14:21:24,943 - src.pipeline.status_tracker - ERROR - Error marking failure for hospital 964b656b-0ae3-4638-9a00-a04ba8d82dda: FOREIGN KEY constraint failed
2025-04-01 14:21:24,943 - src.pipeline.orchestrator - INFO - Search for BIBB MEDICAL CENTER completed in 10.43 seconds
2025-04-01 14:21:24,943 - scripts.run_price_finder - WARNING - Price finder returned None
2025-04-01 14:21:24,954 - scripts.run_price_finder - INFO - Successfully processed hospital BIBB MEDICAL CENTER
2025-04-01 19:00:04,355 - __main__ - INFO - === Starting Price Finder Scheduler ===
2025-04-01 19:00:04,356 - asyncio - DEBUG - Using selector: KqueueSelector
2025-04-01 19:00:04,356 - __main__ - INFO - Starting scheduled price finder runner
2025-04-01 19:00:04,356 - __main__ - INFO - [2025-04-01 19:00:04] Running scheduled price finder with batch size 5
2025-04-01 19:00:04,356 - scripts.run_price_finder - INFO - Starting price finder integration - batch size: 5, state: None
2025-04-01 19:00:04,356 - scripts.run_price_finder - DEBUG - Config loaded: {'serpapi_key': '6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a', 'openai_key': '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', 'mistral_key': '87QKmlS8vjw0woFXpLnUKVIqLkcMa8Lz', 'llm_provider': 'mistral', 'download_dir': 'downloads'}
2025-04-01 19:00:04,357 - scripts.custom_status_tracker - INFO - Initialized MainDBStatusTracker with main application database
2025-04-01 19:00:04,357 - scripts.run_price_finder - INFO - Status tracker initialized with main application database
2025-04-01 19:00:04,357 - src.pipeline.orchestrator - INFO - Initializing pipeline components...
2025-04-01 19:00:04,357 - src.llm.link_analyzer - INFO - Initialized LLMLinkAnalyzer with provider=mistral, model=mistral-large-latest
2025-04-01 19:00:04,357 - src.llm.link_analyzer - INFO - Initialized LLMLinkAnalyzer with provider=mistral, model=mistral-large-latest
2025-04-01 19:00:04,357 - src.pipeline.orchestrator - INFO - Pipeline initialization complete
2025-04-01 19:00:04,357 - scripts.run_price_finder - INFO - PriceFinderPipeline initialized successfully with custom status tracker
2025-04-01 19:00:04,485 - scripts.run_price_finder - INFO - Found 5 hospitals to process
2025-04-01 19:00:04,485 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x10b46c4d0>, 'zip_code': '35233', 'helipad': True, 'price_transparency_url': None, 'name': "CHILDREN'S HOSPITAL OF ALABAMA", 'hospital_type': 'CHILDREN', 'health_sys_id': 'sys_childrens_of_alabama_birmingham_al', 'health_sys_name': 'Childrens of Alabama', 'price_file_found': False, 'address': '1600 SEVENTH AVENUE SOUTH', 'status': 'OPEN', 'search_status': 'pending', 'population': 332, 'county': 'JEFFERSON', 'health_sys_city': 'Birmingham', 'search_attempts': 0, 'city': 'BIRMINGHAM', 'latitude': 33.5040481500001, 'health_sys_state': 'AL', 'last_search_date': None, 'state': 'AL', 'longitude': -86.8051591399999, 'corp_parent_name': 'CHILDRENS OF ALABAMA', 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579867), 'id': '974fc382-8c5a-4f55-acd2-5b2df98a0441', 'owner': 'NON-PROFIT', 'website': None, 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579867)}
2025-04-01 19:00:04,486 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': '974fc382-8c5a-4f55-acd2-5b2df98a0441', 'name': "CHILDREN'S HOSPITAL OF ALABAMA", 'website': "https://www.children'shospitalofalabama.org", 'city': 'BIRMINGHAM', 'state': 'AL', 'health_system_name': 'Childrens of Alabama'}
2025-04-01 19:00:04,486 - scripts.run_price_finder - INFO - Processing hospital: CHILDREN'S HOSPITAL OF ALABAMA (ID: 974fc382-8c5a-4f55-acd2-5b2df98a0441)
2025-04-01 19:00:04,489 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='974fc382-8c5a-4f55-acd2-5b2df98a0441', name="CHILDREN'S HOSPITAL OF ALABAMA", state='AL', city='BIRMINGHAM', address=None, website="https://www.children'shospitalofalabama.org", health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:00:04,489 - src.pipeline.orchestrator - INFO - Starting price file search for CHILDREN'S HOSPITAL OF ALABAMA (AL)
2025-04-01 19:00:04,496 - src.pipeline.orchestrator - INFO - Searching for price transparency files for CHILDREN'S HOSPITAL OF ALABAMA
2025-04-01 19:00:04,496 - src.searchers.serpapi_search - INFO - Searching for: CHILDREN'S HOSPITAL OF ALABAMA BIRMINGHAM, AL price transparency standard charges
2025-04-01 19:00:04,498 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:00:05,820 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=CHILDREN%27S+HOSPITAL+OF+ALABAMA+BIRMINGHAM%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:00:05,821 - src.searchers.serpapi_search - INFO - Found 14 results for query: CHILDREN'S HOSPITAL OF ALABAMA BIRMINGHAM, AL price transparency standard charges
2025-04-01 19:00:05,821 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for CHILDREN'S HOSPITAL OF ALABAMA
2025-04-01 19:00:05,823 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:00:23,258 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:00:23,263 - src.pipeline.orchestrator - INFO - Crawling https://www.childrensal.org/patients-visitors/patient-billing-information/price-transparency for CHILDREN'S HOSPITAL OF ALABAMA (#1 of top 3)
2025-04-01 19:00:23,264 - src.searchers.web_crawler - INFO - Crawling URL: https://www.childrensal.org/patients-visitors/patient-billing-information/price-transparency
2025-04-01 19:00:25,681 - src.searchers.web_crawler - ERROR - Error fetching https://www.childrensal.org/patients-visitors/patient-billing-information/price-transparency with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:00:25,702 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:00:32,308 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:00:32,310 - src.pipeline.orchestrator - INFO - Found 5 potential price file links for CHILDREN'S HOSPITAL OF ALABAMA
2025-04-01 19:00:32,310 - src.pipeline.orchestrator - INFO - Downloading file from https://cdnepic01.chsys.org/public-webserver/price-transparency/BRH/630307306_the-childrens-hospital-of-alabama_standardcharges.csv
2025-04-01 19:02:10,289 - src.searchers.web_crawler - ERROR - Error downloading file from https://cdnepic01.chsys.org/public-webserver/price-transparency/BRH/630307306_the-childrens-hospital-of-alabama_standardcharges.csv: Response payload is not completed
2025-04-01 19:02:10,291 - src.pipeline.orchestrator - WARNING - Failed to download file from https://cdnepic01.chsys.org/public-webserver/price-transparency/BRH/630307306_the-childrens-hospital-of-alabama_standardcharges.csv
2025-04-01 19:02:10,291 - src.pipeline.orchestrator - INFO - Downloading file from https://www.childrensal.org/standard-charges
2025-04-01 19:02:12,417 - src.searchers.web_crawler - ERROR - Failed to download file from https://www.childrensal.org/standard-charges, status: 404
2025-04-01 19:02:12,418 - src.pipeline.orchestrator - WARNING - Failed to download file from https://www.childrensal.org/standard-charges
2025-04-01 19:02:12,418 - src.pipeline.orchestrator - INFO - Crawling https://www.childrensal.org/patients-visitors/patient-billing-information for CHILDREN'S HOSPITAL OF ALABAMA (#2 of top 3)
2025-04-01 19:02:12,418 - src.searchers.web_crawler - INFO - Crawling URL: https://www.childrensal.org/patients-visitors/patient-billing-information
2025-04-01 19:02:13,480 - src.searchers.web_crawler - ERROR - Error fetching https://www.childrensal.org/patients-visitors/patient-billing-information with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:02:13,496 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:02:15,386 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:02:15,389 - src.pipeline.orchestrator - INFO - Found 2 potential price file links for CHILDREN'S HOSPITAL OF ALABAMA
2025-04-01 19:02:15,389 - src.pipeline.orchestrator - INFO - Downloading file from https://www.childrensal.org/patients-visitors/billing/price-transparency
2025-04-01 19:02:17,312 - src.searchers.web_crawler - ERROR - Failed to download file from https://www.childrensal.org/patients-visitors/billing/price-transparency, status: 404
2025-04-01 19:02:17,312 - src.pipeline.orchestrator - WARNING - Failed to download file from https://www.childrensal.org/patients-visitors/billing/price-transparency
2025-04-01 19:02:17,312 - src.pipeline.orchestrator - INFO - Downloading file from https://www.childrensal.org/patients-visitors/patient-billing-information
2025-04-01 19:02:17,379 - src.searchers.web_crawler - INFO - Downloaded file from https://www.childrensal.org/patients-visitors/patient-billing-information to downloads/patient-billing-information
2025-04-01 19:02:17,379 - src.validators.file_validator - INFO - Invalid file extension: 
2025-04-01 19:02:17,379 - src.pipeline.orchestrator - INFO - File from https://www.childrensal.org/patients-visitors/patient-billing-information is not a valid price transparency file format
2025-04-01 19:02:17,385 - src.pipeline.orchestrator - INFO - Failed search for CHILDREN'S HOSPITAL OF ALABAMA completed in 2.21 minutes
2025-04-01 19:02:17,385 - scripts.run_price_finder - WARNING - Price finder returned None
2025-04-01 19:02:17,389 - scripts.run_price_finder - INFO - Successfully processed hospital CHILDREN'S HOSPITAL OF ALABAMA
2025-04-01 19:02:17,389 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:02:17,390 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x10b4a7590>, 'helipad': True, 'price_transparency_url': None, 'zip_code': '36904', 'health_sys_id': 'sys_ochsner_health_system_new orleans_la', 'hospital_type': 'CRITICAL ACCESS', 'health_sys_name': 'Ochsner Health System', 'name': 'CHOCTAW GENERAL HOSPITAL', 'price_file_found': False, 'status': 'OPEN', 'address': '401 VANITY FAIR DRIVE', 'search_status': 'pending', 'population': 25, 'search_attempts': 0, 'health_sys_city': 'New Orleans', 'county': 'CHOCTAW', 'latitude': 32.0931053400001, 'health_sys_state': 'LA', 'city': 'BUTLER', 'last_search_date': None, 'longitude': -88.20949244, 'corp_parent_name': 'OCHSNER HEALTH SYSTEM', 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579868), 'state': 'AL', 'id': 'f2c7d6c7-dc12-4b3b-875d-d0ef15d6d173', 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579868), 'owner': 'NON-PROFIT', 'website': None}
2025-04-01 19:02:17,391 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': 'f2c7d6c7-dc12-4b3b-875d-d0ef15d6d173', 'name': 'CHOCTAW GENERAL HOSPITAL', 'website': 'https://www.choctawgeneralhospital.org', 'city': 'BUTLER', 'state': 'AL', 'health_system_name': 'Ochsner Health System'}
2025-04-01 19:02:17,391 - scripts.run_price_finder - INFO - Processing hospital: CHOCTAW GENERAL HOSPITAL (ID: f2c7d6c7-dc12-4b3b-875d-d0ef15d6d173)
2025-04-01 19:02:17,391 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='f2c7d6c7-dc12-4b3b-875d-d0ef15d6d173', name='CHOCTAW GENERAL HOSPITAL', state='AL', city='BUTLER', address=None, website='https://www.choctawgeneralhospital.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:02:17,391 - src.pipeline.orchestrator - INFO - Starting price file search for CHOCTAW GENERAL HOSPITAL (AL)
2025-04-01 19:02:17,393 - src.pipeline.orchestrator - INFO - Searching for price transparency files for CHOCTAW GENERAL HOSPITAL
2025-04-01 19:02:17,393 - src.searchers.serpapi_search - INFO - Searching for: CHOCTAW GENERAL HOSPITAL BUTLER, AL price transparency standard charges
2025-04-01 19:02:17,394 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:02:19,463 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=CHOCTAW+GENERAL+HOSPITAL+BUTLER%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:02:19,464 - src.searchers.serpapi_search - INFO - Found 14 results for query: CHOCTAW GENERAL HOSPITAL BUTLER, AL price transparency standard charges
2025-04-01 19:02:19,465 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for CHOCTAW GENERAL HOSPITAL
2025-04-01 19:02:19,465 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:02:39,712 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:02:39,714 - src.pipeline.orchestrator - INFO - Crawling https://ochsner-craft.s3.amazonaws.com/core/640655993_rush-hospitalbutler-inc._standardcharges.csv.csv for CHOCTAW GENERAL HOSPITAL (#1 of top 3)
2025-04-01 19:02:39,714 - src.searchers.web_crawler - INFO - Crawling URL: https://ochsner-craft.s3.amazonaws.com/core/640655993_rush-hospitalbutler-inc._standardcharges.csv.csv
2025-04-01 19:03:04,195 - src.searchers.web_crawler - ERROR - Error fetching https://ochsner-craft.s3.amazonaws.com/core/640655993_rush-hospitalbutler-inc._standardcharges.csv.csv with aiohttp: 'utf-8' codec can't decode byte 0x96 in position 2527: invalid start byte
2025-04-01 19:03:04,959 - src.searchers.web_crawler - ERROR - Error fetching https://ochsner-craft.s3.amazonaws.com/core/640655993_rush-hospitalbutler-inc._standardcharges.csv.csv with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:03:04,961 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:03:05,458 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:03:05,460 - src.pipeline.orchestrator - INFO - Found 0 potential price file links for CHOCTAW GENERAL HOSPITAL
2025-04-01 19:03:05,460 - src.pipeline.orchestrator - INFO - Crawling http://www.choctawregional.com/standard-charges/ for CHOCTAW GENERAL HOSPITAL (#2 of top 3)
2025-04-01 19:03:05,460 - src.searchers.web_crawler - INFO - Crawling URL: http://www.choctawregional.com/standard-charges/
2025-04-01 19:03:06,395 - src.searchers.web_crawler - ERROR - Error fetching http://www.choctawregional.com/standard-charges/ with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:03:06,412 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:03:08,335 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:03:08,337 - src.pipeline.orchestrator - INFO - Found 3 potential price file links for CHOCTAW GENERAL HOSPITAL
2025-04-01 19:03:08,337 - src.pipeline.orchestrator - INFO - Downloading file from http://www.choctawregional.com/wp-content/uploads/2019/01/CRMC-Standard-Charges1.1.csv
2025-04-01 19:03:08,752 - src.searchers.web_crawler - INFO - Downloaded file from http://www.choctawregional.com/wp-content/uploads/2019/01/CRMC-Standard-Charges1.1.csv to downloads/CRMC-Standard-Charges1.1.csv
2025-04-01 19:03:08,754 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:03:12,017 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:03:12,019 - src.pipeline.orchestrator - INFO - File from http://www.choctawregional.com/wp-content/uploads/2019/01/CRMC-Standard-Charges1.1.csv is not a match for CHOCTAW GENERAL HOSPITAL: Rule-based: No hospital name or location matches found. LLM: The file contains service descriptions and pricing information, which are key components of a valid price transparency file. However, it does not mention the hospital name 'CHOCTAW GENERAL HOSPITAL' or its location 'BUTLER, AL'. Additionally, it lacks specific codes like CPT or DRG codes, which are often used in such files.
2025-04-01 19:03:12,019 - src.pipeline.orchestrator - INFO - Downloading file from http://www.choctawregional.com/standard-charges/
2025-04-01 19:03:12,428 - src.searchers.web_crawler - INFO - Downloaded file from http://www.choctawregional.com/standard-charges/ to downloads/download_20250401_190312.dat
2025-04-01 19:03:12,429 - src.validators.file_validator - INFO - Invalid file extension: .dat
2025-04-01 19:03:12,429 - src.pipeline.orchestrator - INFO - File from http://www.choctawregional.com/standard-charges/ is not a valid price transparency file format
2025-04-01 19:03:12,433 - src.pipeline.orchestrator - INFO - Failed search for CHOCTAW GENERAL HOSPITAL completed in 55.04 seconds
2025-04-01 19:03:12,433 - scripts.run_price_finder - WARNING - Price finder returned None
2025-04-01 19:03:12,436 - scripts.run_price_finder - INFO - Successfully processed hospital CHOCTAW GENERAL HOSPITAL
2025-04-01 19:03:12,437 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x10b4a75f0>, 'helipad': True, 'price_transparency_url': None, 'zip_code': '35161', 'health_sys_id': 'sys_independent', 'hospital_type': 'GENERAL ACUTE CARE', 'health_sys_name': 'Independent', 'name': 'CITIZENS BAPTIST MEDICAL CENTER', 'price_file_found': False, 'status': 'OPEN', 'address': '604 STONE AVENUE, PO BOX 978', 'search_status': 'pending', 'population': 122, 'search_attempts': 0, 'health_sys_city': None, 'county': 'TALLADEGA', 'latitude': 33.4402768200001, 'health_sys_state': None, 'city': 'TALLADEGA', 'last_search_date': None, 'longitude': -86.0907834, 'corp_parent_name': None, 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579868), 'state': 'AL', 'id': 'd2f45d0b-c5b5-4381-aa95-c4a9bb15bebf', 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579868), 'owner': 'PROPRIETARY', 'website': None}
2025-04-01 19:03:12,437 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': 'd2f45d0b-c5b5-4381-aa95-c4a9bb15bebf', 'name': 'CITIZENS BAPTIST MEDICAL CENTER', 'website': 'https://www.citizensbaptistmedicalcenter.org', 'city': 'TALLADEGA', 'state': 'AL', 'health_system_name': 'Independent'}
2025-04-01 19:03:12,437 - scripts.run_price_finder - INFO - Processing hospital: CITIZENS BAPTIST MEDICAL CENTER (ID: d2f45d0b-c5b5-4381-aa95-c4a9bb15bebf)
2025-04-01 19:03:12,438 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='d2f45d0b-c5b5-4381-aa95-c4a9bb15bebf', name='CITIZENS BAPTIST MEDICAL CENTER', state='AL', city='TALLADEGA', address=None, website='https://www.citizensbaptistmedicalcenter.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:03:12,438 - src.pipeline.orchestrator - INFO - Starting price file search for CITIZENS BAPTIST MEDICAL CENTER (AL)
2025-04-01 19:03:12,440 - src.pipeline.orchestrator - INFO - Searching for price transparency files for CITIZENS BAPTIST MEDICAL CENTER
2025-04-01 19:03:12,440 - src.searchers.serpapi_search - INFO - Searching for: CITIZENS BAPTIST MEDICAL CENTER TALLADEGA, AL price transparency standard charges
2025-04-01 19:03:12,441 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:03:15,665 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=CITIZENS+BAPTIST+MEDICAL+CENTER+TALLADEGA%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:03:15,666 - src.searchers.serpapi_search - INFO - Found 14 results for query: CITIZENS BAPTIST MEDICAL CENTER TALLADEGA, AL price transparency standard charges
2025-04-01 19:03:15,666 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for CITIZENS BAPTIST MEDICAL CENTER
2025-04-01 19:03:15,667 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:03:47,830 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:03:47,832 - src.pipeline.orchestrator - INFO - Crawling https://turquoise.health/providers/citizens-baptist-medical-center/information for CITIZENS BAPTIST MEDICAL CENTER (#1 of top 3)
2025-04-01 19:03:47,832 - src.searchers.web_crawler - INFO - Crawling URL: https://turquoise.health/providers/citizens-baptist-medical-center/information
2025-04-01 19:03:49,507 - src.searchers.web_crawler - ERROR - Error fetching https://turquoise.health/providers/citizens-baptist-medical-center/information with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:03:49,513 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:03:49,513 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:03:49,527 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:03:58,650 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:03:58,652 - src.pipeline.orchestrator - INFO - Found 0 potential price file links for CITIZENS BAPTIST MEDICAL CENTER
2025-04-01 19:03:58,652 - src.pipeline.orchestrator - INFO - Crawling https://www.ebaptisthealthcare.org/patientfinancialresources/price-transparency-standard-hospital-charges for CITIZENS BAPTIST MEDICAL CENTER (#2 of top 3)
2025-04-01 19:03:58,652 - src.searchers.web_crawler - INFO - Crawling URL: https://www.ebaptisthealthcare.org/patientfinancialresources/price-transparency-standard-hospital-charges
2025-04-01 19:04:01,110 - src.searchers.web_crawler - ERROR - Error fetching https://www.ebaptisthealthcare.org/patientfinancialresources/price-transparency-standard-hospital-charges with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:04:01,122 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:04:06,940 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:04:06,942 - src.pipeline.orchestrator - INFO - Found 5 potential price file links for CITIZENS BAPTIST MEDICAL CENTER
2025-04-01 19:04:06,942 - src.pipeline.orchestrator - INFO - Downloading file from Gulf Breeze Hospital Charges Readable File
2025-04-01 19:04:06,942 - src.searchers.web_crawler - ERROR - Error downloading file from Gulf Breeze Hospital Charges Readable File: Gulf%20Breeze%20Hospital%20Charges%20Readable%20File
2025-04-01 19:04:06,942 - src.pipeline.orchestrator - WARNING - Failed to download file from Gulf Breeze Hospital Charges Readable File
2025-04-01 19:04:06,942 - src.pipeline.orchestrator - INFO - Downloading file from https://www.ebaptisthealthcare.org/patientfinancialresources/price-transparency-standard-hospital-charges
2025-04-01 19:04:07,233 - src.searchers.web_crawler - INFO - Downloaded file from https://www.ebaptisthealthcare.org/patientfinancialresources/price-transparency-standard-hospital-charges to downloads/price-transparency-standard-hospital-charges
2025-04-01 19:04:07,233 - src.validators.file_validator - INFO - Invalid file extension: 
2025-04-01 19:04:07,233 - src.pipeline.orchestrator - INFO - File from https://www.ebaptisthealthcare.org/patientfinancialresources/price-transparency-standard-hospital-charges is not a valid price transparency file format
2025-04-01 19:04:07,233 - src.pipeline.orchestrator - INFO - Crawling https://www.baptisthealthal.com/patient-financial-resources/pricing-info-estimates/hospital-pricing-information for CITIZENS BAPTIST MEDICAL CENTER (#3 of top 3)
2025-04-01 19:04:07,233 - src.searchers.web_crawler - INFO - Crawling URL: https://www.baptisthealthal.com/patient-financial-resources/pricing-info-estimates/hospital-pricing-information
2025-04-01 19:04:08,091 - src.searchers.web_crawler - ERROR - Error fetching https://www.baptisthealthal.com/patient-financial-resources/pricing-info-estimates/hospital-pricing-information with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:04:08,110 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:04:10,374 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:04:10,375 - src.pipeline.orchestrator - INFO - Found 4 potential price file links for CITIZENS BAPTIST MEDICAL CENTER
2025-04-01 19:04:10,375 - src.pipeline.orchestrator - INFO - Downloading file from https://www.baptisthealthal.com/patient-financial-resources
2025-04-01 19:04:10,886 - src.searchers.web_crawler - INFO - Downloaded file from https://www.baptisthealthal.com/patient-financial-resources to downloads/patient-financial-resources
2025-04-01 19:04:10,887 - src.validators.file_validator - INFO - Invalid file extension: 
2025-04-01 19:04:10,887 - src.pipeline.orchestrator - INFO - File from https://www.baptisthealthal.com/patient-financial-resources is not a valid price transparency file format
2025-04-01 19:04:10,887 - src.pipeline.orchestrator - INFO - Downloading file from https://www.baptisthealthal.com/patient-financial-resources/pricing-info-estimates
2025-04-01 19:04:11,470 - src.searchers.web_crawler - INFO - Downloaded file from https://www.baptisthealthal.com/patient-financial-resources/pricing-info-estimates to downloads/pricing-info-estimates
2025-04-01 19:04:11,470 - src.validators.file_validator - INFO - Invalid file extension: 
2025-04-01 19:04:11,470 - src.pipeline.orchestrator - INFO - File from https://www.baptisthealthal.com/patient-financial-resources/pricing-info-estimates is not a valid price transparency file format
2025-04-01 19:04:11,474 - src.pipeline.orchestrator - INFO - Failed search for CITIZENS BAPTIST MEDICAL CENTER completed in 59.04 seconds
2025-04-01 19:04:11,474 - scripts.run_price_finder - WARNING - Price finder returned None
2025-04-01 19:04:11,478 - scripts.run_price_finder - INFO - Successfully processed hospital CITIZENS BAPTIST MEDICAL CENTER
2025-04-01 19:04:11,479 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x10b4a7650>, 'helipad': True, 'price_transparency_url': None, 'zip_code': '36251', 'health_sys_id': 'sys_independent', 'hospital_type': 'GENERAL ACUTE CARE', 'health_sys_name': 'Independent', 'name': 'CLAY COUNTY HOSPITAL', 'price_file_found': False, 'status': 'OPEN', 'address': '83825 HIGHWAY 9, PO BOX 1270', 'search_status': 'pending', 'population': 53, 'search_attempts': 0, 'health_sys_city': None, 'county': 'CLAY', 'latitude': 33.2775639400001, 'health_sys_state': None, 'city': 'ASHLAND', 'last_search_date': None, 'longitude': -85.8239827799999, 'corp_parent_name': None, 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579868), 'state': 'AL', 'id': 'ec648ee2-07a6-4ab5-aebd-e787ecc56d76', 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579869), 'owner': 'GOVERNMENT - DISTRICT/AUTHORITY', 'website': None}
2025-04-01 19:04:11,479 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': 'ec648ee2-07a6-4ab5-aebd-e787ecc56d76', 'name': 'CLAY COUNTY HOSPITAL', 'website': 'https://www.claycountyhospital.org', 'city': 'ASHLAND', 'state': 'AL', 'health_system_name': 'Independent'}
2025-04-01 19:04:11,479 - scripts.run_price_finder - INFO - Processing hospital: CLAY COUNTY HOSPITAL (ID: ec648ee2-07a6-4ab5-aebd-e787ecc56d76)
2025-04-01 19:04:11,480 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='ec648ee2-07a6-4ab5-aebd-e787ecc56d76', name='CLAY COUNTY HOSPITAL', state='AL', city='ASHLAND', address=None, website='https://www.claycountyhospital.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:04:11,480 - src.pipeline.orchestrator - INFO - Starting price file search for CLAY COUNTY HOSPITAL (AL)
2025-04-01 19:04:11,482 - src.pipeline.orchestrator - INFO - Searching for price transparency files for CLAY COUNTY HOSPITAL
2025-04-01 19:04:11,482 - src.searchers.serpapi_search - INFO - Searching for: CLAY COUNTY HOSPITAL ASHLAND, AL price transparency standard charges
2025-04-01 19:04:11,483 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:04:14,962 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=CLAY+COUNTY+HOSPITAL+ASHLAND%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:04:14,963 - src.searchers.serpapi_search - INFO - Found 14 results for query: CLAY COUNTY HOSPITAL ASHLAND, AL price transparency standard charges
2025-04-01 19:04:14,963 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for CLAY COUNTY HOSPITAL
2025-04-01 19:04:14,964 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:04:33,793 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:04:33,795 - src.pipeline.orchestrator - INFO - Crawling https://www.claycountyhospital.com/getpage.php?name=Hospital_Pricing for CLAY COUNTY HOSPITAL (#1 of top 3)
2025-04-01 19:04:33,795 - src.searchers.web_crawler - INFO - Crawling URL: https://www.claycountyhospital.com/getpage.php?name=Hospital_Pricing
2025-04-01 19:04:35,140 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:04:35,612 - src.searchers.web_crawler - ERROR - Error fetching https://www.claycountyhospital.com/getpage.php?name=Hospital_Pricing with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:04:35,620 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:04:40,624 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:04:40,626 - src.pipeline.orchestrator - INFO - Found 6 potential price file links for CLAY COUNTY HOSPITAL
2025-04-01 19:04:40,626 - src.pipeline.orchestrator - INFO - Downloading file from https://www.claycountyhospital.com/docs/Financial_Assistance_Policy_Summary.pdf?sub=Patient+Information
2025-04-01 19:04:40,929 - src.searchers.web_crawler - INFO - Downloaded file from https://www.claycountyhospital.com/docs/Financial_Assistance_Policy_Summary.pdf?sub=Patient+Information to downloads/Financial_Assistance_Policy_Summary.pdf
2025-04-01 19:04:40,929 - src.validators.file_validator - INFO - Invalid file extension: .pdf
2025-04-01 19:04:40,929 - src.pipeline.orchestrator - INFO - File from https://www.claycountyhospital.com/docs/Financial_Assistance_Policy_Summary.pdf?sub=Patient+Information is not a valid price transparency file format
2025-04-01 19:04:40,929 - src.pipeline.orchestrator - INFO - Downloading file from https://www.clayhospital.com/hospital-pricing/price-transparency-machine-readable-file
2025-04-01 19:05:56,003 - src.searchers.web_crawler - ERROR - Error downloading file from https://www.clayhospital.com/hospital-pricing/price-transparency-machine-readable-file: Cannot connect to host www.clayhospital.com:443 ssl:default [Connect call failed ('3.33.139.32', 443)]
2025-04-01 19:05:56,004 - src.pipeline.orchestrator - WARNING - Failed to download file from https://www.clayhospital.com/hospital-pricing/price-transparency-machine-readable-file
2025-04-01 19:05:56,004 - src.pipeline.orchestrator - INFO - Crawling https://claycountyhospital.org/clay-county-hospital/about-us/pricing-transparency/ for CLAY COUNTY HOSPITAL (#2 of top 3)
2025-04-01 19:05:56,004 - src.searchers.web_crawler - INFO - Crawling URL: https://claycountyhospital.org/clay-county-hospital/about-us/pricing-transparency/
2025-04-01 19:05:57,439 - src.searchers.web_crawler - ERROR - Error fetching https://claycountyhospital.org/clay-county-hospital/about-us/pricing-transparency/ with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:05:57,449 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:06:06,000 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:06:06,003 - src.pipeline.orchestrator - INFO - Found 6 potential price file links for CLAY COUNTY HOSPITAL
2025-04-01 19:06:06,003 - src.pipeline.orchestrator - INFO - Downloading file from https://www.claycountyhospital.org/clay-county-hospital-shoppable-services
2025-04-01 19:06:06,210 - src.searchers.web_crawler - ERROR - Error downloading file from https://www.claycountyhospital.org/clay-county-hospital-shoppable-services: Cannot connect to host www.claycountyhospital.org:443 ssl:default [[SSL: SSLV3_ALERT_HANDSHAKE_FAILURE] ssl/tls alert handshake failure (_ssl.c:1006)]
2025-04-01 19:06:06,210 - src.pipeline.orchestrator - WARNING - Failed to download file from https://www.claycountyhospital.org/clay-county-hospital-shoppable-services
2025-04-01 19:06:06,210 - src.pipeline.orchestrator - INFO - Downloading file from https://claycountyhospital.org/billing/
2025-04-01 19:06:06,425 - src.searchers.web_crawler - INFO - Downloaded file from https://claycountyhospital.org/billing/ to downloads/download_20250401_190606.dat
2025-04-01 19:06:06,425 - src.validators.file_validator - INFO - Invalid file extension: .dat
2025-04-01 19:06:06,425 - src.pipeline.orchestrator - INFO - File from https://claycountyhospital.org/billing/ is not a valid price transparency file format
2025-04-01 19:06:06,425 - src.pipeline.orchestrator - INFO - Crawling https://apps.para-hcfs.com/PTT/FinalLinks/Clay_V2.aspx for CLAY COUNTY HOSPITAL (#3 of top 3)
2025-04-01 19:06:06,425 - src.searchers.web_crawler - INFO - Crawling URL: https://apps.para-hcfs.com/PTT/FinalLinks/Clay_V2.aspx
2025-04-01 19:06:07,607 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:06:07,607 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:06:07,628 - src.searchers.web_crawler - ERROR - Error fetching https://apps.para-hcfs.com/PTT/FinalLinks/Clay_V2.aspx with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:06:07,652 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:06:14,436 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:06:14,443 - src.pipeline.orchestrator - INFO - Found 6 potential price file links for CLAY COUNTY HOSPITAL
2025-04-01 19:06:14,443 - src.pipeline.orchestrator - INFO - Downloading file from Download Average Charges by Type of Patient Group Listing January 27, 2025
2025-04-01 19:06:14,443 - src.searchers.web_crawler - ERROR - Error downloading file from Download Average Charges by Type of Patient Group Listing January 27, 2025: Download%20Average%20Charges%20by%20Type%20of%20Patient%20Group%20Listing%20January%2027,%202025
2025-04-01 19:06:14,444 - src.pipeline.orchestrator - WARNING - Failed to download file from Download Average Charges by Type of Patient Group Listing January 27, 2025
2025-04-01 19:06:14,444 - src.pipeline.orchestrator - INFO - Downloading file from https://www.cms.gov/newsroom/fact-sheets/cy-2020-hospital-outpatient-prospective-payment-system-opps-policy-changes-hospital-price
2025-04-01 19:06:14,647 - src.searchers.web_crawler - INFO - Downloaded file from https://www.cms.gov/newsroom/fact-sheets/cy-2020-hospital-outpatient-prospective-payment-system-opps-policy-changes-hospital-price to downloads/cy-2020-hospital-outpatient-prospective-payment-system-opps-policy-changes-hospital-price
2025-04-01 19:06:14,648 - src.validators.file_validator - INFO - Invalid file extension: 
2025-04-01 19:06:14,648 - src.pipeline.orchestrator - INFO - File from https://www.cms.gov/newsroom/fact-sheets/cy-2020-hospital-outpatient-prospective-payment-system-opps-policy-changes-hospital-price is not a valid price transparency file format
2025-04-01 19:06:14,653 - src.pipeline.orchestrator - INFO - Failed search for CLAY COUNTY HOSPITAL completed in 2.05 minutes
2025-04-01 19:06:14,653 - scripts.run_price_finder - WARNING - Price finder returned None
2025-04-01 19:06:14,656 - scripts.run_price_finder - INFO - Successfully processed hospital CLAY COUNTY HOSPITAL
2025-04-01 19:06:14,657 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x10b4a76b0>, 'helipad': True, 'price_transparency_url': None, 'zip_code': '36083', 'health_sys_id': 'sys_independent', 'hospital_type': 'GENERAL ACUTE CARE', 'health_sys_name': 'Independent', 'name': 'CENTRAL ALABAMA VETERANS HEALTH CARE SYSTEM EAST CAMPUS', 'price_file_found': False, 'status': 'OPEN', 'address': '2400 HOSPITAL ROAD', 'search_status': 'pending', 'population': 143, 'search_attempts': 0, 'health_sys_city': None, 'county': 'MACON', 'latitude': 32.44521832, 'health_sys_state': None, 'city': 'TUSKEGEE', 'last_search_date': None, 'longitude': -85.71214861, 'corp_parent_name': 'VETERANS HEALTH ADMINISTRATION', 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579867), 'state': 'AL', 'id': '1de3a1ee-3e3a-417e-93dd-2248e827e079', 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579867), 'owner': 'NOT AVAILABLE', 'website': None}
2025-04-01 19:06:14,657 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': '1de3a1ee-3e3a-417e-93dd-2248e827e079', 'name': 'CENTRAL ALABAMA VETERANS HEALTH CARE SYSTEM EAST CAMPUS', 'website': 'https://www.centralalabamaveteranshealthcaresystemeastcampus.org', 'city': 'TUSKEGEE', 'state': 'AL', 'health_system_name': 'Independent'}
2025-04-01 19:06:14,657 - scripts.run_price_finder - INFO - Processing hospital: CENTRAL ALABAMA VETERANS HEALTH CARE SYSTEM EAST CAMPUS (ID: 1de3a1ee-3e3a-417e-93dd-2248e827e079)
2025-04-01 19:06:14,657 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='1de3a1ee-3e3a-417e-93dd-2248e827e079', name='CENTRAL ALABAMA VETERANS HEALTH CARE SYSTEM EAST CAMPUS', state='AL', city='TUSKEGEE', address=None, website='https://www.centralalabamaveteranshealthcaresystemeastcampus.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:06:14,657 - src.pipeline.orchestrator - INFO - Starting price file search for CENTRAL ALABAMA VETERANS HEALTH CARE SYSTEM EAST CAMPUS (AL)
2025-04-01 19:06:14,660 - src.pipeline.orchestrator - INFO - Searching for price transparency files for CENTRAL ALABAMA VETERANS HEALTH CARE SYSTEM EAST CAMPUS
2025-04-01 19:06:14,660 - src.searchers.serpapi_search - INFO - Searching for: CENTRAL ALABAMA VETERANS HEALTH CARE SYSTEM EAST CAMPUS TUSKEGEE, AL price transparency standard charges
2025-04-01 19:06:14,661 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:06:19,826 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=CENTRAL+ALABAMA+VETERANS+HEALTH+CARE+SYSTEM+EAST+CAMPUS+TUSKEGEE%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:06:19,827 - src.searchers.serpapi_search - INFO - Found 13 results for query: CENTRAL ALABAMA VETERANS HEALTH CARE SYSTEM EAST CAMPUS TUSKEGEE, AL price transparency standard charges
2025-04-01 19:06:19,827 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for CENTRAL ALABAMA VETERANS HEALTH CARE SYSTEM EAST CAMPUS
2025-04-01 19:06:19,828 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:06:42,100 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:06:42,113 - src.pipeline.orchestrator - INFO - Crawling https://www.va.gov/central-alabama-health-care/billing-and-insurance/ for CENTRAL ALABAMA VETERANS HEALTH CARE SYSTEM EAST CAMPUS (#1 of top 3)
2025-04-01 19:06:42,113 - src.searchers.web_crawler - INFO - Crawling URL: https://www.va.gov/central-alabama-health-care/billing-and-insurance/
2025-04-01 19:06:43,189 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:06:43,190 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:06:43,190 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:06:43,190 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:06:43,822 - src.searchers.web_crawler - ERROR - Error fetching https://www.va.gov/central-alabama-health-care/billing-and-insurance/ with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:06:43,828 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:06:44,551 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:06:44,553 - src.pipeline.orchestrator - INFO - Found 1 potential price file links for CENTRAL ALABAMA VETERANS HEALTH CARE SYSTEM EAST CAMPUS
2025-04-01 19:06:44,553 - src.pipeline.orchestrator - INFO - Downloading file from https://www.va.gov/central-alabama-health-care/billing-and-insurance/#content
2025-04-01 19:06:45,593 - src.searchers.web_crawler - INFO - Downloaded file from https://www.va.gov/central-alabama-health-care/billing-and-insurance/#content to downloads/download_20250401_190645.dat
2025-04-01 19:06:45,593 - src.validators.file_validator - INFO - Invalid file extension: .dat
2025-04-01 19:06:45,594 - src.pipeline.orchestrator - INFO - File from https://www.va.gov/central-alabama-health-care/billing-and-insurance/#content is not a valid price transparency file format
2025-04-01 19:06:45,597 - src.pipeline.orchestrator - INFO - Failed search for CENTRAL ALABAMA VETERANS HEALTH CARE SYSTEM EAST CAMPUS completed in 30.94 seconds
2025-04-01 19:06:45,597 - scripts.run_price_finder - WARNING - Price finder returned None
2025-04-01 19:06:45,600 - scripts.run_price_finder - INFO - Successfully processed hospital CENTRAL ALABAMA VETERANS HEALTH CARE SYSTEM EAST CAMPUS
2025-04-01 19:06:45,600 - __main__ - INFO - Completed run: processed 5 hospitals, found 0 files, validated 0 files, errors: 0
2025-04-01 19:06:45,600 - __main__ - INFO - Waiting for 193 seconds until next run
2025-04-01 19:09:58,601 - __main__ - INFO - [2025-04-01 19:09:58] Running scheduled price finder with batch size 13
2025-04-01 19:09:58,603 - scripts.run_price_finder - INFO - Starting price finder integration - batch size: 13, state: None
2025-04-01 19:09:58,603 - scripts.run_price_finder - DEBUG - Config loaded: {'serpapi_key': '6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a', 'openai_key': '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', 'mistral_key': '87QKmlS8vjw0woFXpLnUKVIqLkcMa8Lz', 'llm_provider': 'mistral', 'download_dir': 'downloads'}
2025-04-01 19:09:58,605 - scripts.custom_status_tracker - INFO - Initialized MainDBStatusTracker with main application database
2025-04-01 19:09:58,605 - scripts.run_price_finder - INFO - Status tracker initialized with main application database
2025-04-01 19:09:58,605 - src.pipeline.orchestrator - INFO - Initializing pipeline components...
2025-04-01 19:09:58,605 - src.llm.link_analyzer - INFO - Initialized LLMLinkAnalyzer with provider=mistral, model=mistral-large-latest
2025-04-01 19:09:58,605 - src.llm.link_analyzer - INFO - Initialized LLMLinkAnalyzer with provider=mistral, model=mistral-large-latest
2025-04-01 19:09:58,606 - src.pipeline.orchestrator - INFO - Pipeline initialization complete
2025-04-01 19:09:58,606 - scripts.run_price_finder - INFO - PriceFinderPipeline initialized successfully with custom status tracker
2025-04-01 19:09:58,623 - scripts.run_price_finder - INFO - Found 13 hospitals to process
2025-04-01 19:09:58,623 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x10bd39550>, 'zip_code': '35150', 'helipad': False, 'price_transparency_url': None, 'name': 'COOSA VALLEY MEDICAL CENTER', 'hospital_type': 'GENERAL ACUTE CARE', 'health_sys_id': 'sys_independent', 'health_sys_name': 'Independent', 'price_file_found': False, 'address': '315 WEST HICKORY STREET', 'status': 'OPEN', 'search_status': 'pending', 'population': 168, 'county': 'TALLADEGA', 'health_sys_city': None, 'search_attempts': 0, 'city': 'SYLACAUGA', 'latitude': 33.1645602300001, 'health_sys_state': None, 'last_search_date': None, 'state': 'AL', 'longitude': -86.25548758, 'corp_parent_name': 'COOSA VALLEY MEDICAL CENTER', 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579869), 'id': '404352eb-45e6-4d6c-abfd-e82f6bf821b2', 'owner': 'GOVERNMENT - DISTRICT/AUTHORITY', 'website': None, 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579870)}
2025-04-01 19:09:58,623 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': '404352eb-45e6-4d6c-abfd-e82f6bf821b2', 'name': 'COOSA VALLEY MEDICAL CENTER', 'website': 'https://www.coosavalleymedicalcenter.org', 'city': 'SYLACAUGA', 'state': 'AL', 'health_system_name': 'Independent'}
2025-04-01 19:09:58,623 - scripts.run_price_finder - INFO - Processing hospital: COOSA VALLEY MEDICAL CENTER (ID: 404352eb-45e6-4d6c-abfd-e82f6bf821b2)
2025-04-01 19:09:58,625 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='404352eb-45e6-4d6c-abfd-e82f6bf821b2', name='COOSA VALLEY MEDICAL CENTER', state='AL', city='SYLACAUGA', address=None, website='https://www.coosavalleymedicalcenter.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:09:58,625 - src.pipeline.orchestrator - INFO - Starting price file search for COOSA VALLEY MEDICAL CENTER (AL)
2025-04-01 19:09:58,627 - src.pipeline.orchestrator - INFO - Searching for price transparency files for COOSA VALLEY MEDICAL CENTER
2025-04-01 19:09:58,627 - src.searchers.serpapi_search - INFO - Searching for: COOSA VALLEY MEDICAL CENTER SYLACAUGA, AL price transparency standard charges
2025-04-01 19:09:58,629 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:10:01,284 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=COOSA+VALLEY+MEDICAL+CENTER+SYLACAUGA%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:10:01,285 - src.searchers.serpapi_search - INFO - Found 14 results for query: COOSA VALLEY MEDICAL CENTER SYLACAUGA, AL price transparency standard charges
2025-04-01 19:10:01,285 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for COOSA VALLEY MEDICAL CENTER
2025-04-01 19:10:01,286 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:10:27,211 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:10:27,213 - src.pipeline.orchestrator - INFO - Crawling https://cvhealth.net/wp-content/uploads/2025/01/201282261_sylacauga-health-care-authority-inc_standardcharges.csv for COOSA VALLEY MEDICAL CENTER (#1 of top 3)
2025-04-01 19:10:27,213 - src.searchers.web_crawler - INFO - Crawling URL: https://cvhealth.net/wp-content/uploads/2025/01/201282261_sylacauga-health-care-authority-inc_standardcharges.csv
2025-04-01 19:10:27,477 - src.searchers.web_crawler - ERROR - Error fetching https://cvhealth.net/wp-content/uploads/2025/01/201282261_sylacauga-health-care-authority-inc_standardcharges.csv with aiohttp: Server disconnected
2025-04-01 19:10:28,499 - src.searchers.web_crawler - ERROR - Error fetching https://cvhealth.net/wp-content/uploads/2025/01/201282261_sylacauga-health-care-authority-inc_standardcharges.csv with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:10:28,501 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:10:29,344 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:10:29,346 - src.pipeline.orchestrator - INFO - Found 0 potential price file links for COOSA VALLEY MEDICAL CENTER
2025-04-01 19:10:29,346 - src.pipeline.orchestrator - INFO - Crawling https://cvhealth.net/patients-visitors/patient-financial-information/price-transparency/ for COOSA VALLEY MEDICAL CENTER (#2 of top 3)
2025-04-01 19:10:29,346 - src.searchers.web_crawler - INFO - Crawling URL: https://cvhealth.net/patients-visitors/patient-financial-information/price-transparency/
2025-04-01 19:10:29,541 - src.searchers.web_crawler - ERROR - Error fetching https://cvhealth.net/patients-visitors/patient-financial-information/price-transparency/ with aiohttp: Server disconnected
2025-04-01 19:10:29,909 - src.searchers.web_crawler - ERROR - Error fetching https://cvhealth.net/patients-visitors/patient-financial-information/price-transparency/ with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:10:29,910 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:10:30,675 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:10:30,677 - src.pipeline.orchestrator - INFO - Found 0 potential price file links for COOSA VALLEY MEDICAL CENTER
2025-04-01 19:10:30,681 - src.pipeline.orchestrator - INFO - Failed search for COOSA VALLEY MEDICAL CENTER completed in 32.06 seconds
2025-04-01 19:10:30,681 - scripts.run_price_finder - WARNING - Price finder returned None
2025-04-01 19:10:30,683 - scripts.run_price_finder - INFO - Successfully processed hospital COOSA VALLEY MEDICAL CENTER
2025-04-01 19:10:30,684 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x10bd39370>, 'helipad': True, 'price_transparency_url': None, 'zip_code': '36078', 'health_sys_id': 'sys_independent', 'hospital_type': 'GENERAL ACUTE CARE', 'health_sys_name': 'Independent', 'name': 'COMMUNITY HOSPITAL, INC', 'price_file_found': False, 'status': 'OPEN', 'address': '805 FRIENDSHIP ROAD', 'search_status': 'pending', 'population': 69, 'search_attempts': 0, 'health_sys_city': None, 'county': 'ELMORE', 'latitude': 32.53390983, 'health_sys_state': None, 'city': 'TALLASSEE', 'last_search_date': None, 'longitude': -85.91224661, 'corp_parent_name': None, 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579869), 'state': 'AL', 'id': 'c915cf57-73c6-4105-8daf-b2e6a189628b', 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579869), 'owner': 'NON-PROFIT', 'website': None}
2025-04-01 19:10:30,684 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': 'c915cf57-73c6-4105-8daf-b2e6a189628b', 'name': 'COMMUNITY HOSPITAL, INC', 'website': 'https://www.communityhospital,inc.org', 'city': 'TALLASSEE', 'state': 'AL', 'health_system_name': 'Independent'}
2025-04-01 19:10:30,684 - scripts.run_price_finder - INFO - Processing hospital: COMMUNITY HOSPITAL, INC (ID: c915cf57-73c6-4105-8daf-b2e6a189628b)
2025-04-01 19:10:30,684 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='c915cf57-73c6-4105-8daf-b2e6a189628b', name='COMMUNITY HOSPITAL, INC', state='AL', city='TALLASSEE', address=None, website='https://www.communityhospital,inc.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:10:30,684 - src.pipeline.orchestrator - INFO - Starting price file search for COMMUNITY HOSPITAL, INC (AL)
2025-04-01 19:10:30,686 - src.pipeline.orchestrator - INFO - Searching for price transparency files for COMMUNITY HOSPITAL, INC
2025-04-01 19:10:30,686 - src.searchers.serpapi_search - INFO - Searching for: COMMUNITY HOSPITAL, INC TALLASSEE, AL price transparency standard charges
2025-04-01 19:10:30,687 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:10:32,802 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=COMMUNITY+HOSPITAL%2C+INC+TALLASSEE%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:10:32,803 - src.searchers.serpapi_search - INFO - Found 12 results for query: COMMUNITY HOSPITAL, INC TALLASSEE, AL price transparency standard charges
2025-04-01 19:10:32,803 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for COMMUNITY HOSPITAL, INC
2025-04-01 19:10:32,804 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:10:52,711 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:10:52,714 - src.pipeline.orchestrator - INFO - Crawling http://www.chal.org/about/resources for COMMUNITY HOSPITAL, INC (#1 of top 3)
2025-04-01 19:10:52,714 - src.searchers.web_crawler - INFO - Crawling URL: http://www.chal.org/about/resources
2025-04-01 19:10:54,164 - src.searchers.web_crawler - ERROR - Error fetching http://www.chal.org/about/resources with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:10:54,167 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:10:54,167 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:10:54,167 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:10:54,171 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:10:58,629 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:10:58,633 - src.pipeline.orchestrator - INFO - Found 4 potential price file links for COMMUNITY HOSPITAL, INC
2025-04-01 19:10:58,633 - src.pipeline.orchestrator - INFO - Downloading file from http://www.chal.org/Community_Hospital_Machine_Readable_Standard_Charges_12_2020.csv
2025-04-01 19:10:59,207 - src.searchers.web_crawler - INFO - Downloaded file from http://www.chal.org/Community_Hospital_Machine_Readable_Standard_Charges_12_2020.csv to downloads/Community_Hospital_Machine_Readable_Standard_Charges_12_2020.csv
2025-04-01 19:10:59,209 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:11:02,593 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:11:02,595 - src.pipeline.orchestrator - INFO - File from http://www.chal.org/Community_Hospital_Machine_Readable_Standard_Charges_12_2020.csv is not a match for COMMUNITY HOSPITAL, INC: Rule-based: Found location matches: state: AL, but no hospital name match. LLM: The file contains valid pricing information with service descriptions, revenue codes, and various payer-specific negotiated charges. However, it does not explicitly mention the hospital name 'COMMUNITY HOSPITAL, INC' or its location 'TALLASSEE, AL'. The validation score is high because the data structure and content align well with price transparency requirements.
2025-04-01 19:11:02,595 - src.pipeline.orchestrator - INFO - Downloading file from http://www.chal.org/Community_Hospital_Machine_Readable_Standard_Charges_12_2020.pdf
2025-04-01 19:11:03,607 - src.searchers.web_crawler - INFO - Downloaded file from http://www.chal.org/Community_Hospital_Machine_Readable_Standard_Charges_12_2020.pdf to downloads/Community_Hospital_Machine_Readable_Standard_Charges_12_2020.pdf
2025-04-01 19:11:03,607 - src.validators.file_validator - INFO - Invalid file extension: .pdf
2025-04-01 19:11:03,607 - src.pipeline.orchestrator - INFO - File from http://www.chal.org/Community_Hospital_Machine_Readable_Standard_Charges_12_2020.pdf is not a valid price transparency file format
2025-04-01 19:11:03,607 - src.pipeline.orchestrator - INFO - Crawling https://yourcommunityhospital.com/patient-resources/pricing-charge-data for COMMUNITY HOSPITAL, INC (#2 of top 3)
2025-04-01 19:11:03,607 - src.searchers.web_crawler - INFO - Crawling URL: https://yourcommunityhospital.com/patient-resources/pricing-charge-data
2025-04-01 19:11:05,107 - src.searchers.web_crawler - ERROR - Error fetching https://yourcommunityhospital.com/patient-resources/pricing-charge-data with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:11:05,115 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:11:15,037 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:11:15,045 - src.pipeline.orchestrator - INFO - Found 4 potential price file links for COMMUNITY HOSPITAL, INC
2025-04-01 19:11:15,045 - src.pipeline.orchestrator - INFO - Downloading file from https://www.montrosehospital.com/your-health/billing-financial-services/pricing-charge-data
2025-04-01 19:11:15,272 - src.searchers.web_crawler - ERROR - Error downloading file from https://www.montrosehospital.com/your-health/billing-financial-services/pricing-charge-data: Cannot connect to host www.montrosehospital.com:443 ssl:True [SSLCertVerificationError: (1, "[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: Hostname mismatch, certificate is not valid for 'www.montrosehospital.com'. (_ssl.c:1006)")]
2025-04-01 19:11:15,272 - src.pipeline.orchestrator - WARNING - Failed to download file from https://www.montrosehospital.com/your-health/billing-financial-services/pricing-charge-data
2025-04-01 19:11:15,272 - src.pipeline.orchestrator - INFO - Downloading file from https://cdn.yourcommunityhospital.com/files/CH+Website+CDM+3.15.24.xlsx
2025-04-01 19:11:16,246 - src.searchers.web_crawler - INFO - Downloaded file from https://cdn.yourcommunityhospital.com/files/CH+Website+CDM+3.15.24.xlsx to downloads/CH+Website+CDM+3.15.24.xlsx
2025-04-01 19:11:16,276 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:11:16,396 - src.validators.file_validator - INFO - Headers don't suggest price data: ['Community Hospital Chargemaster ', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', 'Unnamed: 7', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', 'Unnamed: 11', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', 'Unnamed: 19', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', 'Unnamed: 23', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26', 'Unnamed: 27', 'Unnamed: 28', 'Unnamed: 29', 'Unnamed: 30', 'Unnamed: 31', 'Unnamed: 32', 'Unnamed: 33']
2025-04-01 19:11:16,396 - src.pipeline.orchestrator - INFO - File from https://cdn.yourcommunityhospital.com/files/CH+Website+CDM+3.15.24.xlsx is not a valid price transparency file format
2025-04-01 19:11:16,396 - src.pipeline.orchestrator - INFO - Crawling https://www.ecommunity.com/central-pricing-office/list-of-standard-charges for COMMUNITY HOSPITAL, INC (#3 of top 3)
2025-04-01 19:11:16,396 - src.searchers.web_crawler - INFO - Crawling URL: https://www.ecommunity.com/central-pricing-office/list-of-standard-charges
2025-04-01 19:11:17,405 - src.searchers.web_crawler - ERROR - Error fetching https://www.ecommunity.com/central-pricing-office/list-of-standard-charges with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:11:17,413 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:11:19,562 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:11:19,563 - src.pipeline.orchestrator - INFO - Found 4 potential price file links for COMMUNITY HOSPITAL, INC
2025-04-01 19:11:19,563 - src.pipeline.orchestrator - INFO - Downloading file from https://media.ecommunity.com/PricingTransparency/Community_Hospital_Fairbanks.csv
2025-04-01 19:12:20,582 - src.searchers.web_crawler - INFO - Downloaded file from https://media.ecommunity.com/PricingTransparency/Community_Hospital_Fairbanks.csv to downloads/Community_Hospital_Fairbanks.csv
2025-04-01 19:12:20,591 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:12:24,137 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:12:24,139 - src.pipeline.orchestrator - INFO - File from https://media.ecommunity.com/PricingTransparency/Community_Hospital_Fairbanks.csv is not a match for COMMUNITY HOSPITAL, INC: Rule-based: No hospital name or location matches found. LLM: While the file contains valid pricing data with CPT codes, descriptions, and various payer rates, it does not belong to 'COMMUNITY HOSPITAL, INC' in 'TALLASSEE, AL'. The hospital name mentioned in the file is 'Fairbanks Hospital, Inc.' located in 'Indianapolis, IN'.
2025-04-01 19:12:24,139 - src.pipeline.orchestrator - INFO - Downloading file from https://media.ecommunity.com/PricingTransparency/Community_Hospital_Anderson.csv
2025-04-01 19:13:50,040 - src.searchers.web_crawler - INFO - Downloaded file from https://media.ecommunity.com/PricingTransparency/Community_Hospital_Anderson.csv to downloads/Community_Hospital_Anderson.csv
2025-04-01 19:13:50,050 - src.validators.file_validator - WARNING - File is very large (142.77 MB): downloads/Community_Hospital_Anderson.csv
2025-04-01 19:13:50,052 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:13:54,618 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:13:54,620 - src.pipeline.orchestrator - INFO - File from https://media.ecommunity.com/PricingTransparency/Community_Hospital_Anderson.csv is not a match for COMMUNITY HOSPITAL, INC: Rule-based: No hospital name or location matches found. LLM: While the file contains valid pricing data with CPT codes and corresponding charges, the hospital name mentioned is 'Community Hospital Anderson of Madison County, Inc' located in Indianapolis, IN, which does not match the specified 'COMMUNITY HOSPITAL, INC' in Tallassee, AL. Therefore, it is not a valid price transparency file for the specified hospital.
2025-04-01 19:13:54,628 - src.pipeline.orchestrator - INFO - Failed search for COMMUNITY HOSPITAL, INC completed in 3.40 minutes
2025-04-01 19:13:54,631 - scripts.run_price_finder - WARNING - Price finder returned None
2025-04-01 19:13:54,634 - scripts.run_price_finder - INFO - Successfully processed hospital COMMUNITY HOSPITAL, INC
2025-04-01 19:13:54,635 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x10bd392b0>, 'helipad': False, 'price_transparency_url': None, 'zip_code': '35801', 'health_sys_id': 'sys_community_health_systems_franklin_tn', 'hospital_type': 'GENERAL ACUTE CARE', 'health_sys_name': 'Community Health Systems', 'name': 'CRESTWOOD MEDICAL CENTER', 'price_file_found': False, 'status': 'OPEN', 'address': '1 HOSPITAL DRIVE', 'search_status': 'pending', 'population': 180, 'search_attempts': 0, 'health_sys_city': 'Franklin', 'county': 'MADISON', 'latitude': 34.6936114000001, 'health_sys_state': 'TN', 'city': 'HUNTSVILLE', 'last_search_date': None, 'longitude': -86.5721715399999, 'corp_parent_name': 'COMMUNITY HEALTH SYSTEMS INC', 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579871), 'state': 'AL', 'id': '0f5c3ee2-ac02-4668-912d-43ba5d092ed3', 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579871), 'owner': 'PROPRIETARY', 'website': None}
2025-04-01 19:13:54,635 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': '0f5c3ee2-ac02-4668-912d-43ba5d092ed3', 'name': 'CRESTWOOD MEDICAL CENTER', 'website': 'https://www.crestwoodmedicalcenter.org', 'city': 'HUNTSVILLE', 'state': 'AL', 'health_system_name': 'Community Health Systems'}
2025-04-01 19:13:54,635 - scripts.run_price_finder - INFO - Processing hospital: CRESTWOOD MEDICAL CENTER (ID: 0f5c3ee2-ac02-4668-912d-43ba5d092ed3)
2025-04-01 19:13:54,635 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='0f5c3ee2-ac02-4668-912d-43ba5d092ed3', name='CRESTWOOD MEDICAL CENTER', state='AL', city='HUNTSVILLE', address=None, website='https://www.crestwoodmedicalcenter.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:13:54,635 - src.pipeline.orchestrator - INFO - Starting price file search for CRESTWOOD MEDICAL CENTER (AL)
2025-04-01 19:13:54,637 - src.pipeline.orchestrator - INFO - Searching for price transparency files for CRESTWOOD MEDICAL CENTER
2025-04-01 19:13:54,637 - src.searchers.serpapi_search - INFO - Searching for: CRESTWOOD MEDICAL CENTER HUNTSVILLE, AL price transparency standard charges
2025-04-01 19:13:54,638 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:13:57,537 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=CRESTWOOD+MEDICAL+CENTER+HUNTSVILLE%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:13:57,540 - src.searchers.serpapi_search - INFO - Found 14 results for query: CRESTWOOD MEDICAL CENTER HUNTSVILLE, AL price transparency standard charges
2025-04-01 19:13:57,540 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for CRESTWOOD MEDICAL CENTER
2025-04-01 19:13:57,540 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:14:17,231 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:14:17,234 - src.pipeline.orchestrator - INFO - Crawling https://www.crestwoodmedcenter.com/pricing-information for CRESTWOOD MEDICAL CENTER (#1 of top 3)
2025-04-01 19:14:17,234 - src.searchers.web_crawler - INFO - Crawling URL: https://www.crestwoodmedcenter.com/pricing-information
2025-04-01 19:14:19,429 - src.searchers.web_crawler - ERROR - Error fetching https://www.crestwoodmedcenter.com/pricing-information with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:14:19,447 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:14:21,987 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:14:21,988 - src.pipeline.orchestrator - INFO - Found 4 potential price file links for CRESTWOOD MEDICAL CENTER
2025-04-01 19:14:21,988 - src.pipeline.orchestrator - INFO - Downloading file from https://www.crestwoodmedcenter.com/Uploads/Public/Documents/charge-masters/charge-masters-2024/621647983_crestwood-medical-center_standardcharges.csv
2025-04-01 19:14:53,001 - src.searchers.web_crawler - INFO - Downloaded file from https://www.crestwoodmedcenter.com/Uploads/Public/Documents/charge-masters/charge-masters-2024/621647983_crestwood-medical-center_standardcharges.csv to downloads/621647983_crestwood-medical-center_standardcharges.csv
2025-04-01 19:14:53,007 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:15:14,814 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:15:14,816 - src.pipeline.orchestrator - INFO - Found valid price file for CRESTWOOD MEDICAL CENTER: https://www.crestwoodmedcenter.com/Uploads/Public/Documents/charge-masters/charge-masters-2024/621647983_crestwood-medical-center_standardcharges.csv, confidence: 1.0
2025-04-01 19:15:14,818 - scripts.custom_status_tracker - ERROR - Error marking success for hospital 0f5c3ee2-ac02-4668-912d-43ba5d092ed3: type object 'HospitalPriceFile' has no attribute 'url'
2025-04-01 19:15:14,819 - src.pipeline.orchestrator - INFO - Successful search for CRESTWOOD MEDICAL CENTER completed in 1.34 minutes
2025-04-01 19:15:14,821 - scripts.run_price_finder - INFO - Price finder result: {'hospital_id': '0f5c3ee2-ac02-4668-912d-43ba5d092ed3', 'url': 'https://www.crestwoodmedcenter.com/Uploads/Public/Documents/charge-masters/charge-masters-2024/621647983_crestwood-medical-center_standardcharges.csv', 'file_type': 'csv', 'validated': True, 'validation_date': None, 'validation_score': 0.95, 'validation_notes': "The file contains detailed service descriptions with CPT codes, pricing information including gross charges, discounted cash prices, and various payer-specific negotiated rates. The header rows include relevant pricing columns such as 'standard_charge|gross', 'standard_charge|discounted_cash', 'standard_charge|min', and 'standard_charge|max'. The hospital name 'Crestwood Medical Center' is clearly mentioned along with its location in Huntsville, AL, which matches the specified hospital. The data appears comprehensive and aligns well with the requirements for hospital price transparency.", 'file_size': 88884827, 'last_modified': None, 'download_date': None, 'contains_prices': True, 'contains_hospital_name': True, 'coverage_period': None, 'processed': False, 'processing_date': None, 'processing_errors': []}
2025-04-01 19:15:14,823 - scripts.run_price_finder - ERROR - Error processing hospital 0f5c3ee2-ac02-4668-912d-43ba5d092ed3: type object 'HospitalPriceFile' has no attribute 'url'
2025-04-01 19:15:14,823 - scripts.run_price_finder - ERROR - Traceback (most recent call last):
  File "/Users/bentenner/OmegaReal/backend/scripts/run_price_finder.py", line 217, in update_database_from_price_finder
    HospitalPriceFile.file_url == result_dict.get("url")
    ^^^^^^^^^^^^^^^^^^^^^
AttributeError: type object 'HospitalPriceFile' has no attribute 'url'

2025-04-01 19:15:14,824 - scripts.run_price_finder - INFO - Successfully processed hospital CRESTWOOD MEDICAL CENTER
2025-04-01 19:15:14,825 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x10bd393d0>, 'helipad': False, 'price_transparency_url': None, 'zip_code': '36116', 'health_sys_id': 'sys_independent', 'hospital_type': 'PSYCHIATRIC', 'health_sys_name': 'Independent', 'name': 'CROSSBRIDGE BEHAVIORAL HEALTH A BAPTIST SOUTH FACILITY', 'price_file_found': False, 'status': 'OPEN', 'address': '4385 NARROW LANE ROAD', 'search_status': 'pending', 'population': 60, 'search_attempts': 0, 'health_sys_city': None, 'county': 'MONTGOMERY', 'latitude': 32.32346327, 'health_sys_state': None, 'city': 'MONTGOMERY', 'last_search_date': None, 'longitude': -86.28134483, 'corp_parent_name': None, 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579871), 'state': 'AL', 'id': '4239d8c0-0c53-4bd3-a584-0c78610b5278', 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579871), 'owner': 'GOVERNMENT - DISTRICT/AUTHORITY', 'website': None}
2025-04-01 19:15:14,825 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': '4239d8c0-0c53-4bd3-a584-0c78610b5278', 'name': 'CROSSBRIDGE BEHAVIORAL HEALTH A BAPTIST SOUTH FACILITY', 'website': 'https://www.crossbridgebehavioralhealthabaptistsouthfacility.org', 'city': 'MONTGOMERY', 'state': 'AL', 'health_system_name': 'Independent'}
2025-04-01 19:15:14,825 - scripts.run_price_finder - INFO - Processing hospital: CROSSBRIDGE BEHAVIORAL HEALTH A BAPTIST SOUTH FACILITY (ID: 4239d8c0-0c53-4bd3-a584-0c78610b5278)
2025-04-01 19:15:14,827 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='4239d8c0-0c53-4bd3-a584-0c78610b5278', name='CROSSBRIDGE BEHAVIORAL HEALTH A BAPTIST SOUTH FACILITY', state='AL', city='MONTGOMERY', address=None, website='https://www.crossbridgebehavioralhealthabaptistsouthfacility.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:15:14,827 - src.pipeline.orchestrator - INFO - Starting price file search for CROSSBRIDGE BEHAVIORAL HEALTH A BAPTIST SOUTH FACILITY (AL)
2025-04-01 19:15:14,829 - src.pipeline.orchestrator - INFO - Searching for price transparency files for CROSSBRIDGE BEHAVIORAL HEALTH A BAPTIST SOUTH FACILITY
2025-04-01 19:15:14,829 - src.searchers.serpapi_search - INFO - Searching for: CROSSBRIDGE BEHAVIORAL HEALTH A BAPTIST SOUTH FACILITY MONTGOMERY, AL price transparency standard charges
2025-04-01 19:15:14,830 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:15:16,169 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=CROSSBRIDGE+BEHAVIORAL+HEALTH+A+BAPTIST+SOUTH+FACILITY+MONTGOMERY%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:15:16,171 - src.searchers.serpapi_search - INFO - Found 9 results for query: CROSSBRIDGE BEHAVIORAL HEALTH A BAPTIST SOUTH FACILITY MONTGOMERY, AL price transparency standard charges
2025-04-01 19:15:16,171 - src.pipeline.orchestrator - INFO - Analyzing 9 search results for CROSSBRIDGE BEHAVIORAL HEALTH A BAPTIST SOUTH FACILITY
2025-04-01 19:15:16,171 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:15:32,067 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:15:32,069 - src.pipeline.orchestrator - INFO - Crawling https://www.ebaptisthealthcare.org/patientfinancialresources/price-transparency-standard-hospital-charges for CROSSBRIDGE BEHAVIORAL HEALTH A BAPTIST SOUTH FACILITY (#1 of top 3)
2025-04-01 19:15:32,069 - src.searchers.web_crawler - INFO - Crawling URL: https://www.ebaptisthealthcare.org/patientfinancialresources/price-transparency-standard-hospital-charges
2025-04-01 19:15:32,678 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:15:33,300 - src.searchers.web_crawler - ERROR - Error fetching https://www.ebaptisthealthcare.org/patientfinancialresources/price-transparency-standard-hospital-charges with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:15:33,310 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:15:39,614 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:15:39,616 - src.pipeline.orchestrator - INFO - Found 5 potential price file links for CROSSBRIDGE BEHAVIORAL HEALTH A BAPTIST SOUTH FACILITY
2025-04-01 19:15:39,616 - src.pipeline.orchestrator - INFO - Downloading file from Gulf Breeze Hospital Charges Readable File
2025-04-01 19:15:39,616 - src.searchers.web_crawler - ERROR - Error downloading file from Gulf Breeze Hospital Charges Readable File: Gulf%20Breeze%20Hospital%20Charges%20Readable%20File
2025-04-01 19:15:39,616 - src.pipeline.orchestrator - WARNING - Failed to download file from Gulf Breeze Hospital Charges Readable File
2025-04-01 19:15:39,616 - src.pipeline.orchestrator - INFO - Downloading file from https://www.ebaptisthealthcare.org/patientfinancialresources/price-transparency-standard-hospital-charges
2025-04-01 19:15:39,901 - src.searchers.web_crawler - INFO - Downloaded file from https://www.ebaptisthealthcare.org/patientfinancialresources/price-transparency-standard-hospital-charges to downloads/price-transparency-standard-hospital-charges
2025-04-01 19:15:39,901 - src.validators.file_validator - INFO - Invalid file extension: 
2025-04-01 19:15:39,901 - src.pipeline.orchestrator - INFO - File from https://www.ebaptisthealthcare.org/patientfinancialresources/price-transparency-standard-hospital-charges is not a valid price transparency file format
2025-04-01 19:15:39,901 - src.pipeline.orchestrator - INFO - Crawling https://www.baptisthealthal.com/patient-financial-resources/pricing-info-estimates/hospital-pricing-information for CROSSBRIDGE BEHAVIORAL HEALTH A BAPTIST SOUTH FACILITY (#2 of top 3)
2025-04-01 19:15:39,901 - src.searchers.web_crawler - INFO - Crawling URL: https://www.baptisthealthal.com/patient-financial-resources/pricing-info-estimates/hospital-pricing-information
2025-04-01 19:15:40,844 - src.searchers.web_crawler - ERROR - Error fetching https://www.baptisthealthal.com/patient-financial-resources/pricing-info-estimates/hospital-pricing-information with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:15:40,850 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:15:40,863 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:15:49,350 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:15:49,352 - src.pipeline.orchestrator - INFO - Found 8 potential price file links for CROSSBRIDGE BEHAVIORAL HEALTH A BAPTIST SOUTH FACILITY
2025-04-01 19:15:49,352 - src.pipeline.orchestrator - INFO - Downloading file from Baptist Health Shelby Hospital Shoppable Services Standard Charges - (Right Click to Save/Download)
2025-04-01 19:15:49,352 - src.searchers.web_crawler - ERROR - Error downloading file from Baptist Health Shelby Hospital Shoppable Services Standard Charges - (Right Click to Save/Download): Baptist%20Health%20Shelby%20Hospital%20Shoppable%20Services%20Standard%20Charges%20-%20(Right%20Click%20to%20Save/Download)
2025-04-01 19:15:49,352 - src.pipeline.orchestrator - WARNING - Failed to download file from Baptist Health Shelby Hospital Shoppable Services Standard Charges - (Right Click to Save/Download)
2025-04-01 19:15:49,352 - src.pipeline.orchestrator - INFO - Downloading file from https://www.baptisthealthal.com/patient-financial-resources
2025-04-01 19:15:49,829 - src.searchers.web_crawler - INFO - Downloaded file from https://www.baptisthealthal.com/patient-financial-resources to downloads/patient-financial-resources
2025-04-01 19:15:49,830 - src.validators.file_validator - INFO - Invalid file extension: 
2025-04-01 19:15:49,830 - src.pipeline.orchestrator - INFO - File from https://www.baptisthealthal.com/patient-financial-resources is not a valid price transparency file format
2025-04-01 19:15:49,830 - src.pipeline.orchestrator - INFO - Crawling https://www.baptisthealthsystem.com/patients/pricing-info-estimates/hospital-pricing-information for CROSSBRIDGE BEHAVIORAL HEALTH A BAPTIST SOUTH FACILITY (#3 of top 3)
2025-04-01 19:15:49,830 - src.searchers.web_crawler - INFO - Crawling URL: https://www.baptisthealthsystem.com/patients/pricing-info-estimates/hospital-pricing-information
2025-04-01 19:15:50,048 - src.searchers.web_crawler - WARNING - Failed to fetch https://www.baptisthealthsystem.com/patients/pricing-info-estimates/hospital-pricing-information with status 403
2025-04-01 19:15:50,440 - src.searchers.web_crawler - ERROR - Error fetching https://www.baptisthealthsystem.com/patients/pricing-info-estimates/hospital-pricing-information with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:15:50,441 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:15:53,033 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:15:53,034 - src.pipeline.orchestrator - INFO - Found 0 potential price file links for CROSSBRIDGE BEHAVIORAL HEALTH A BAPTIST SOUTH FACILITY
2025-04-01 19:15:53,038 - src.pipeline.orchestrator - INFO - Failed search for CROSSBRIDGE BEHAVIORAL HEALTH A BAPTIST SOUTH FACILITY completed in 38.21 seconds
2025-04-01 19:15:53,038 - scripts.run_price_finder - WARNING - Price finder returned None
2025-04-01 19:15:53,041 - scripts.run_price_finder - INFO - Successfully processed hospital CROSSBRIDGE BEHAVIORAL HEALTH A BAPTIST SOUTH FACILITY
2025-04-01 19:15:53,042 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x10bd39430>, 'helipad': True, 'price_transparency_url': None, 'zip_code': '36049', 'health_sys_id': 'sys_independent', 'hospital_type': 'GENERAL ACUTE CARE', 'health_sys_name': 'Independent', 'name': 'CRENSHAW COMMUNITY HOSPITAL', 'price_file_found': False, 'status': 'OPEN', 'address': '101 HOSPITAL CIRCLE', 'search_status': 'pending', 'population': 65, 'search_attempts': 0, 'health_sys_city': None, 'county': 'CRENSHAW', 'latitude': 31.69354407, 'health_sys_state': None, 'city': 'LUVERNE', 'last_search_date': None, 'longitude': -86.2650457, 'corp_parent_name': None, 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579870), 'state': 'AL', 'id': 'e1c8e089-f8ef-4923-b2ca-3b5006a3326d', 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579870), 'owner': 'GOVERNMENT - DISTRICT/AUTHORITY', 'website': None}
2025-04-01 19:15:53,042 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': 'e1c8e089-f8ef-4923-b2ca-3b5006a3326d', 'name': 'CRENSHAW COMMUNITY HOSPITAL', 'website': 'https://www.crenshawcommunityhospital.org', 'city': 'LUVERNE', 'state': 'AL', 'health_system_name': 'Independent'}
2025-04-01 19:15:53,042 - scripts.run_price_finder - INFO - Processing hospital: CRENSHAW COMMUNITY HOSPITAL (ID: e1c8e089-f8ef-4923-b2ca-3b5006a3326d)
2025-04-01 19:15:53,043 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='e1c8e089-f8ef-4923-b2ca-3b5006a3326d', name='CRENSHAW COMMUNITY HOSPITAL', state='AL', city='LUVERNE', address=None, website='https://www.crenshawcommunityhospital.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:15:53,043 - src.pipeline.orchestrator - INFO - Starting price file search for CRENSHAW COMMUNITY HOSPITAL (AL)
2025-04-01 19:15:53,045 - src.pipeline.orchestrator - INFO - Searching for price transparency files for CRENSHAW COMMUNITY HOSPITAL
2025-04-01 19:15:53,045 - src.searchers.serpapi_search - INFO - Searching for: CRENSHAW COMMUNITY HOSPITAL LUVERNE, AL price transparency standard charges
2025-04-01 19:15:53,046 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:15:54,920 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=CRENSHAW+COMMUNITY+HOSPITAL+LUVERNE%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:15:54,921 - src.searchers.serpapi_search - INFO - Found 14 results for query: CRENSHAW COMMUNITY HOSPITAL LUVERNE, AL price transparency standard charges
2025-04-01 19:15:54,921 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for CRENSHAW COMMUNITY HOSPITAL
2025-04-01 19:15:54,922 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:19:46,186 - __main__ - INFO - === Starting Price Finder Scheduler ===
2025-04-01 19:19:46,186 - asyncio - DEBUG - Using selector: KqueueSelector
2025-04-01 19:19:46,187 - __main__ - INFO - Starting scheduled price finder runner
2025-04-01 19:19:46,187 - __main__ - INFO - [2025-04-01 19:19:46] Running scheduled price finder with batch size 10
2025-04-01 19:19:46,187 - scripts.run_price_finder - INFO - Starting price finder integration - batch size: 10, state: None
2025-04-01 19:19:46,187 - scripts.run_price_finder - DEBUG - Config loaded: {'serpapi_key': '6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a', 'openai_key': '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', 'mistral_key': '87QKmlS8vjw0woFXpLnUKVIqLkcMa8Lz', 'llm_provider': 'mistral', 'download_dir': 'downloads'}
2025-04-01 19:19:46,187 - scripts.custom_status_tracker - INFO - Initialized MainDBStatusTracker with main application database
2025-04-01 19:19:46,187 - scripts.run_price_finder - INFO - Status tracker initialized with main application database
2025-04-01 19:19:46,187 - src.pipeline.orchestrator - INFO - Initializing pipeline components...
2025-04-01 19:19:46,187 - src.llm.link_analyzer - INFO - Initialized LLMLinkAnalyzer with provider=mistral, model=mistral-large-latest
2025-04-01 19:19:46,187 - src.llm.link_analyzer - INFO - Initialized LLMLinkAnalyzer with provider=mistral, model=mistral-large-latest
2025-04-01 19:19:46,188 - src.pipeline.orchestrator - INFO - Pipeline initialization complete
2025-04-01 19:19:46,188 - scripts.run_price_finder - INFO - PriceFinderPipeline initialized successfully with custom status tracker
2025-04-01 19:19:46,230 - scripts.run_price_finder - INFO - Found 10 hospitals to process
2025-04-01 19:19:46,230 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x114e6ce90>, 'zip_code': '35601', 'helipad': False, 'price_transparency_url': None, 'name': 'DECATUR MORGAN HOSPITAL - PARKWAY CAMPUS', 'hospital_type': 'GENERAL ACUTE CARE', 'health_sys_id': 'sys_huntsville_hospital_health_system_huntsville_a', 'health_sys_name': 'Huntsville Hospital Health System', 'price_file_found': False, 'address': '1874 BELTLINE ROAD SW', 'status': 'OPEN', 'search_status': 'pending', 'population': 120, 'county': 'MORGAN', 'health_sys_city': 'Huntsville', 'search_attempts': 0, 'city': 'DECATUR', 'latitude': 34.57689679, 'health_sys_state': 'AL', 'last_search_date': None, 'state': 'AL', 'longitude': -87.0158086599999, 'corp_parent_name': 'HEALTHGROUP OF ALABAMA', 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579874), 'id': '20ab9e35-e344-4798-ad14-a02c18926fa5', 'owner': 'PROPRIETARY', 'website': None, 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579874)}
2025-04-01 19:19:46,230 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': '20ab9e35-e344-4798-ad14-a02c18926fa5', 'name': 'DECATUR MORGAN HOSPITAL - PARKWAY CAMPUS', 'website': 'https://www.decaturmorganhospital-parkwaycampus.org', 'city': 'DECATUR', 'state': 'AL', 'health_system_name': 'Huntsville Hospital Health System'}
2025-04-01 19:19:46,230 - scripts.run_price_finder - INFO - Processing hospital: DECATUR MORGAN HOSPITAL - PARKWAY CAMPUS (ID: 20ab9e35-e344-4798-ad14-a02c18926fa5)
2025-04-01 19:19:46,233 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='20ab9e35-e344-4798-ad14-a02c18926fa5', name='DECATUR MORGAN HOSPITAL - PARKWAY CAMPUS', state='AL', city='DECATUR', address=None, website='https://www.decaturmorganhospital-parkwaycampus.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:19:46,233 - src.pipeline.orchestrator - INFO - Starting price file search for DECATUR MORGAN HOSPITAL - PARKWAY CAMPUS (AL)
2025-04-01 19:19:46,237 - src.pipeline.orchestrator - INFO - Searching for price transparency files for DECATUR MORGAN HOSPITAL - PARKWAY CAMPUS
2025-04-01 19:19:46,238 - src.searchers.serpapi_search - INFO - Searching for: DECATUR MORGAN HOSPITAL - PARKWAY CAMPUS DECATUR, AL price transparency standard charges
2025-04-01 19:19:46,239 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:19:47,739 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=DECATUR+MORGAN+HOSPITAL+-+PARKWAY+CAMPUS+DECATUR%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:19:47,740 - src.searchers.serpapi_search - INFO - Found 14 results for query: DECATUR MORGAN HOSPITAL - PARKWAY CAMPUS DECATUR, AL price transparency standard charges
2025-04-01 19:19:47,740 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for DECATUR MORGAN HOSPITAL - PARKWAY CAMPUS
2025-04-01 19:19:47,741 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:20:04,976 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:20:04,979 - src.pipeline.orchestrator - INFO - Crawling https://decaturmorganhospital.net/patients-visitors/price-transparency for DECATUR MORGAN HOSPITAL - PARKWAY CAMPUS (#1 of top 3)
2025-04-01 19:20:04,979 - src.searchers.web_crawler - INFO - Crawling URL: https://decaturmorganhospital.net/patients-visitors/price-transparency
2025-04-01 19:20:06,858 - src.searchers.web_crawler - ERROR - Error fetching https://decaturmorganhospital.net/patients-visitors/price-transparency with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:20:06,868 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:20:14,656 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:20:14,659 - src.pipeline.orchestrator - INFO - Found 6 potential price file links for DECATUR MORGAN HOSPITAL - PARKWAY CAMPUS
2025-04-01 19:20:14,659 - src.pipeline.orchestrator - INFO - Downloading file from https://www.decaturmorganhospital.com/Decatur-Morgan-Hospital-West-Standard-Charge-File
2025-04-01 19:20:44,663 - src.searchers.web_crawler - ERROR - Error downloading file from https://www.decaturmorganhospital.com/Decatur-Morgan-Hospital-West-Standard-Charge-File: Cannot connect to host www.decaturmorganhospital.com:443 ssl:default [nodename nor servname provided, or not known]
2025-04-01 19:20:44,664 - src.pipeline.orchestrator - WARNING - Failed to download file from https://www.decaturmorganhospital.com/Decatur-Morgan-Hospital-West-Standard-Charge-File
2025-04-01 19:20:44,664 - src.pipeline.orchestrator - INFO - Downloading file from https://www.decaturmorganhospital.com/standard-charges
2025-04-01 19:21:14,668 - src.searchers.web_crawler - ERROR - Error downloading file from https://www.decaturmorganhospital.com/standard-charges: Cannot connect to host www.decaturmorganhospital.com:443 ssl:default [nodename nor servname provided, or not known]
2025-04-01 19:21:14,669 - src.pipeline.orchestrator - WARNING - Failed to download file from https://www.decaturmorganhospital.com/standard-charges
2025-04-01 19:21:14,669 - src.pipeline.orchestrator - INFO - Crawling https://decaturmorganhospital.net/patients-visitors/patient-cost-estimator for DECATUR MORGAN HOSPITAL - PARKWAY CAMPUS (#2 of top 3)
2025-04-01 19:21:14,669 - src.searchers.web_crawler - INFO - Crawling URL: https://decaturmorganhospital.net/patients-visitors/patient-cost-estimator
2025-04-01 19:21:15,521 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:21:16,229 - src.searchers.web_crawler - ERROR - Error fetching https://decaturmorganhospital.net/patients-visitors/patient-cost-estimator with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:21:16,237 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:21:20,698 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:21:20,700 - src.pipeline.orchestrator - INFO - Found 2 potential price file links for DECATUR MORGAN HOSPITAL - PARKWAY CAMPUS
2025-04-01 19:21:20,700 - src.pipeline.orchestrator - INFO - Downloading file from https://decaturmorganhospital.net/patients-visitors/price-transparency
2025-04-01 19:21:21,091 - src.searchers.web_crawler - INFO - Downloaded file from https://decaturmorganhospital.net/patients-visitors/price-transparency to downloads/price-transparency
2025-04-01 19:21:21,091 - src.validators.file_validator - INFO - Invalid file extension: 
2025-04-01 19:21:21,091 - src.pipeline.orchestrator - INFO - File from https://decaturmorganhospital.net/patients-visitors/price-transparency is not a valid price transparency file format
2025-04-01 19:21:21,091 - src.pipeline.orchestrator - INFO - Downloading file from https://decaturmorganhospital.net/patients-visitors/financial-assistance
2025-04-01 19:21:21,566 - src.searchers.web_crawler - INFO - Downloaded file from https://decaturmorganhospital.net/patients-visitors/financial-assistance to downloads/financial-assistance
2025-04-01 19:21:21,566 - src.validators.file_validator - INFO - Invalid file extension: 
2025-04-01 19:21:21,566 - src.pipeline.orchestrator - INFO - File from https://decaturmorganhospital.net/patients-visitors/financial-assistance is not a valid price transparency file format
2025-04-01 19:21:21,583 - scripts.custom_status_tracker - INFO - Successfully updated hospital 20ab9e35-e344-4798-ad14-a02c18926fa5 with not_found status
2025-04-01 19:21:21,585 - src.pipeline.orchestrator - INFO - Failed search for DECATUR MORGAN HOSPITAL - PARKWAY CAMPUS completed in 1.59 minutes
2025-04-01 19:21:21,585 - scripts.run_price_finder - WARNING - Price finder returned None
2025-04-01 19:21:21,591 - scripts.run_price_finder - INFO - Successfully updated database for hospital DECATUR MORGAN HOSPITAL - PARKWAY CAMPUS
2025-04-01 19:21:21,591 - scripts.run_price_finder - INFO - Successfully processed hospital DECATUR MORGAN HOSPITAL - PARKWAY CAMPUS
2025-04-01 19:21:21,591 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x114ea2b10>, 'zip_code': '36360', 'price_transparency_url': None, 'helipad': True, 'price_file_found': False, 'health_sys_id': 'sys_independent', 'hospital_type': 'GENERAL ACUTE CARE', 'health_sys_name': 'Independent', 'name': 'DALE MEDICAL CENTER', 'status': 'OPEN', 'address': '126 HOSPITAL AVENUE', 'search_status': 'pending', 'population': 89, 'health_sys_city': None, 'search_attempts': 0, 'county': 'DALE', 'city': 'OZARK', 'health_sys_state': None, 'latitude': 31.4515766600001, 'last_search_date': None, 'longitude': -85.63208804, 'state': 'AL', 'corp_parent_name': 'DALE MEDICAL CENTER', 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579872), 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579873), 'id': '63c804cf-dd77-4f27-950f-853b816c3873', 'website': None, 'owner': 'GOVERNMENT - LOCAL'}
2025-04-01 19:21:21,592 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': '63c804cf-dd77-4f27-950f-853b816c3873', 'name': 'DALE MEDICAL CENTER', 'website': 'https://www.dalemedicalcenter.org', 'city': 'OZARK', 'state': 'AL', 'health_system_name': 'Independent'}
2025-04-01 19:21:21,592 - scripts.run_price_finder - INFO - Processing hospital: DALE MEDICAL CENTER (ID: 63c804cf-dd77-4f27-950f-853b816c3873)
2025-04-01 19:21:21,593 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='63c804cf-dd77-4f27-950f-853b816c3873', name='DALE MEDICAL CENTER', state='AL', city='OZARK', address=None, website='https://www.dalemedicalcenter.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:21:21,593 - src.pipeline.orchestrator - INFO - Starting price file search for DALE MEDICAL CENTER (AL)
2025-04-01 19:21:21,596 - src.pipeline.orchestrator - INFO - Searching for price transparency files for DALE MEDICAL CENTER
2025-04-01 19:21:21,596 - src.searchers.serpapi_search - INFO - Searching for: DALE MEDICAL CENTER OZARK, AL price transparency standard charges
2025-04-01 19:21:21,596 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:21:24,711 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=DALE+MEDICAL+CENTER+OZARK%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:21:24,713 - src.searchers.serpapi_search - INFO - Found 11 results for query: DALE MEDICAL CENTER OZARK, AL price transparency standard charges
2025-04-01 19:21:24,713 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for DALE MEDICAL CENTER
2025-04-01 19:21:24,713 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:21:44,762 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:21:44,767 - src.pipeline.orchestrator - INFO - Crawling https://www.dalemedical.org/getpage.php?name=Hospital_Pricing for DALE MEDICAL CENTER (#1 of top 3)
2025-04-01 19:21:44,767 - src.searchers.web_crawler - INFO - Crawling URL: https://www.dalemedical.org/getpage.php?name=Hospital_Pricing
2025-04-01 19:21:46,436 - src.searchers.web_crawler - ERROR - Error fetching https://www.dalemedical.org/getpage.php?name=Hospital_Pricing with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:21:46,447 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:21:48,555 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:21:48,557 - src.pipeline.orchestrator - INFO - Found 4 potential price file links for DALE MEDICAL CENTER
2025-04-01 19:21:48,557 - src.pipeline.orchestrator - INFO - Downloading file from https://www.dalemedical.org/docs/PARA_NSA_Template_for_Right_to_Receive_a_Good_Faith_Estimate_of_Expected_Charges_updated_12.28.21.pdf?sub=Patient%20Info
2025-04-01 19:21:48,846 - src.searchers.web_crawler - INFO - Downloaded file from https://www.dalemedical.org/docs/PARA_NSA_Template_for_Right_to_Receive_a_Good_Faith_Estimate_of_Expected_Charges_updated_12.28.21.pdf?sub=Patient%20Info to downloads/PARA_NSA_Template_for_Right_to_Receive_a_Good_Faith_Estimate_of_Expected_Charges_updated_12.28.21.pdf
2025-04-01 19:21:48,846 - src.validators.file_validator - INFO - Invalid file extension: .pdf
2025-04-01 19:21:48,846 - src.pipeline.orchestrator - INFO - File from https://www.dalemedical.org/docs/PARA_NSA_Template_for_Right_to_Receive_a_Good_Faith_Estimate_of_Expected_Charges_updated_12.28.21.pdf?sub=Patient%20Info is not a valid price transparency file format
2025-04-01 19:21:48,846 - src.pipeline.orchestrator - INFO - Downloading file from https://www.dalemedical.org/docs/Average_Charges_Per_Stay_by_DRG.xlsx
2025-04-01 19:21:49,196 - src.searchers.web_crawler - INFO - Downloaded file from https://www.dalemedical.org/docs/Average_Charges_Per_Stay_by_DRG.xlsx to downloads/Average_Charges_Per_Stay_by_DRG.xlsx
2025-04-01 19:21:49,206 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:21:49,207 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:21:49,285 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:21:52,366 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:21:52,368 - src.pipeline.orchestrator - INFO - File from https://www.dalemedical.org/docs/Average_Charges_Per_Stay_by_DRG.xlsx is not a match for DALE MEDICAL CENTER: Rule-based: No hospital name or location matches found. LLM: The file contains DRG codes with corresponding descriptions and average total charges per stay, which are valid components of hospital price transparency data. However, it does not explicitly mention 'DALE MEDICAL CENTER' or its location 'OZARK, AL'. The validation score is high because the data structure is correct, but the lack of hospital-specific information prevents a perfect score.
2025-04-01 19:21:52,368 - src.pipeline.orchestrator - INFO - Crawling https://www.dalemedical.org/getpage.php?name=patient_billing for DALE MEDICAL CENTER (#2 of top 3)
2025-04-01 19:21:52,368 - src.searchers.web_crawler - INFO - Crawling URL: https://www.dalemedical.org/getpage.php?name=patient_billing
2025-04-01 19:21:53,226 - src.searchers.web_crawler - ERROR - Error fetching https://www.dalemedical.org/getpage.php?name=patient_billing with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:21:53,238 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:21:58,811 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:21:58,813 - src.pipeline.orchestrator - INFO - Found 3 potential price file links for DALE MEDICAL CENTER
2025-04-01 19:21:58,813 - src.pipeline.orchestrator - INFO - Downloading file from https://www.dalemedical.org/getpage.php?name=Patient_Accounts_Insurance_Billing&sub=Patient%20Info
2025-04-01 19:21:59,316 - src.searchers.web_crawler - INFO - Downloaded file from https://www.dalemedical.org/getpage.php?name=Patient_Accounts_Insurance_Billing&sub=Patient%20Info to downloads/getpage.php
2025-04-01 19:21:59,316 - src.validators.file_validator - INFO - Invalid file extension: .php
2025-04-01 19:21:59,316 - src.pipeline.orchestrator - INFO - File from https://www.dalemedical.org/getpage.php?name=Patient_Accounts_Insurance_Billing&sub=Patient%20Info is not a valid price transparency file format
2025-04-01 19:21:59,316 - src.pipeline.orchestrator - INFO - Downloading file from https://www.dalemedical.org/docs/PARA_NSA_Template_for_Right_to_Receive_a_Good_Faith_Estimate_of_Expected_Charges_updated_12.28.21.pdf?sub=Patient%20Info
2025-04-01 19:21:59,606 - src.searchers.web_crawler - INFO - Downloaded file from https://www.dalemedical.org/docs/PARA_NSA_Template_for_Right_to_Receive_a_Good_Faith_Estimate_of_Expected_Charges_updated_12.28.21.pdf?sub=Patient%20Info to downloads/PARA_NSA_Template_for_Right_to_Receive_a_Good_Faith_Estimate_of_Expected_Charges_updated_12.28.21.pdf
2025-04-01 19:21:59,606 - src.validators.file_validator - INFO - Invalid file extension: .pdf
2025-04-01 19:21:59,606 - src.pipeline.orchestrator - INFO - File from https://www.dalemedical.org/docs/PARA_NSA_Template_for_Right_to_Receive_a_Good_Faith_Estimate_of_Expected_Charges_updated_12.28.21.pdf?sub=Patient%20Info is not a valid price transparency file format
2025-04-01 19:21:59,606 - src.pipeline.orchestrator - INFO - Crawling https://www.dalemedical.org/ for DALE MEDICAL CENTER (#3 of top 3)
2025-04-01 19:21:59,606 - src.searchers.web_crawler - INFO - Crawling URL: https://www.dalemedical.org/
2025-04-01 19:22:00,570 - src.searchers.web_crawler - ERROR - Error fetching https://www.dalemedical.org/ with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:22:00,577 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:22:00,585 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:22:01,292 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:22:01,293 - src.pipeline.orchestrator - INFO - Found 2 potential price file links for DALE MEDICAL CENTER
2025-04-01 19:22:01,293 - src.pipeline.orchestrator - INFO - Downloading file from https://www.dalemedical.org/getpage.php?name=Patient_Accounts_Insurance_Billing&sub=Patient%20Info
2025-04-01 19:22:01,731 - src.searchers.web_crawler - INFO - Downloaded file from https://www.dalemedical.org/getpage.php?name=Patient_Accounts_Insurance_Billing&sub=Patient%20Info to downloads/getpage.php
2025-04-01 19:22:01,731 - src.validators.file_validator - INFO - Invalid file extension: .php
2025-04-01 19:22:01,731 - src.pipeline.orchestrator - INFO - File from https://www.dalemedical.org/getpage.php?name=Patient_Accounts_Insurance_Billing&sub=Patient%20Info is not a valid price transparency file format
2025-04-01 19:22:01,731 - src.pipeline.orchestrator - INFO - Downloading file from https://www.dalemedical.org/docs/PARA_NSA_Template_for_Right_to_Receive_a_Good_Faith_Estimate_of_Expected_Charges_updated_12.28.21.pdf?sub=Patient%20Info
2025-04-01 19:22:02,026 - src.searchers.web_crawler - INFO - Downloaded file from https://www.dalemedical.org/docs/PARA_NSA_Template_for_Right_to_Receive_a_Good_Faith_Estimate_of_Expected_Charges_updated_12.28.21.pdf?sub=Patient%20Info to downloads/PARA_NSA_Template_for_Right_to_Receive_a_Good_Faith_Estimate_of_Expected_Charges_updated_12.28.21.pdf
2025-04-01 19:22:02,026 - src.validators.file_validator - INFO - Invalid file extension: .pdf
2025-04-01 19:22:02,026 - src.pipeline.orchestrator - INFO - File from https://www.dalemedical.org/docs/PARA_NSA_Template_for_Right_to_Receive_a_Good_Faith_Estimate_of_Expected_Charges_updated_12.28.21.pdf?sub=Patient%20Info is not a valid price transparency file format
2025-04-01 19:22:02,031 - scripts.custom_status_tracker - INFO - Successfully updated hospital 63c804cf-dd77-4f27-950f-853b816c3873 with not_found status
2025-04-01 19:22:02,032 - src.pipeline.orchestrator - INFO - Failed search for DALE MEDICAL CENTER completed in 40.44 seconds
2025-04-01 19:22:02,033 - scripts.run_price_finder - WARNING - Price finder returned None
2025-04-01 19:22:02,036 - scripts.run_price_finder - INFO - Successfully updated database for hospital DALE MEDICAL CENTER
2025-04-01 19:22:02,036 - scripts.run_price_finder - INFO - Successfully processed hospital DALE MEDICAL CENTER
2025-04-01 19:22:02,036 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x114ed1610>, 'zip_code': '35058', 'price_transparency_url': None, 'helipad': True, 'price_file_found': False, 'health_sys_id': 'sys_independent', 'hospital_type': 'GENERAL ACUTE CARE', 'health_sys_name': 'Independent', 'name': 'CULLMAN REGIONAL MEDICAL CENTER', 'status': 'OPEN', 'address': '1912 ALABAMA HIGHWAY 157', 'search_status': 'pending', 'population': 150, 'health_sys_city': None, 'search_attempts': 0, 'county': 'CULLMAN', 'city': 'CULLMAN', 'health_sys_state': None, 'latitude': 34.2013272, 'last_search_date': None, 'longitude': -86.80572957, 'state': 'AL', 'corp_parent_name': None, 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579872), 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579872), 'id': '1c41b065-99de-440e-aca6-998ff6c4da8a', 'website': None, 'owner': 'NON-PROFIT'}
2025-04-01 19:22:02,036 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': '1c41b065-99de-440e-aca6-998ff6c4da8a', 'name': 'CULLMAN REGIONAL MEDICAL CENTER', 'website': 'https://www.cullmanregionalmedicalcenter.org', 'city': 'CULLMAN', 'state': 'AL', 'health_system_name': 'Independent'}
2025-04-01 19:22:02,036 - scripts.run_price_finder - INFO - Processing hospital: CULLMAN REGIONAL MEDICAL CENTER (ID: 1c41b065-99de-440e-aca6-998ff6c4da8a)
2025-04-01 19:22:02,037 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='1c41b065-99de-440e-aca6-998ff6c4da8a', name='CULLMAN REGIONAL MEDICAL CENTER', state='AL', city='CULLMAN', address=None, website='https://www.cullmanregionalmedicalcenter.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:22:02,037 - src.pipeline.orchestrator - INFO - Starting price file search for CULLMAN REGIONAL MEDICAL CENTER (AL)
2025-04-01 19:22:02,039 - src.pipeline.orchestrator - INFO - Searching for price transparency files for CULLMAN REGIONAL MEDICAL CENTER
2025-04-01 19:22:02,039 - src.searchers.serpapi_search - INFO - Searching for: CULLMAN REGIONAL MEDICAL CENTER CULLMAN, AL price transparency standard charges
2025-04-01 19:22:02,040 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:22:02,731 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=CULLMAN+REGIONAL+MEDICAL+CENTER+CULLMAN%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:22:02,733 - src.searchers.serpapi_search - INFO - Found 14 results for query: CULLMAN REGIONAL MEDICAL CENTER CULLMAN, AL price transparency standard charges
2025-04-01 19:22:02,733 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for CULLMAN REGIONAL MEDICAL CENTER
2025-04-01 19:22:02,734 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:22:20,926 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:22:20,931 - src.pipeline.orchestrator - INFO - Crawling https://cullmanregional.com/patient-price-list/ for CULLMAN REGIONAL MEDICAL CENTER (#1 of top 3)
2025-04-01 19:22:20,931 - src.searchers.web_crawler - INFO - Crawling URL: https://cullmanregional.com/patient-price-list/
2025-04-01 19:22:23,083 - src.searchers.web_crawler - ERROR - Error fetching https://cullmanregional.com/patient-price-list/ with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:22:23,098 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:22:27,788 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:22:27,790 - src.pipeline.orchestrator - INFO - Found 4 potential price file links for CULLMAN REGIONAL MEDICAL CENTER
2025-04-01 19:22:27,790 - src.pipeline.orchestrator - INFO - Downloading file from https://cullmanregional.com/patient-care/financial-services/
2025-04-01 19:22:28,147 - src.searchers.web_crawler - INFO - Downloaded file from https://cullmanregional.com/patient-care/financial-services/ to downloads/download_20250401_192228.dat
2025-04-01 19:22:28,148 - src.validators.file_validator - INFO - Invalid file extension: .dat
2025-04-01 19:22:28,148 - src.pipeline.orchestrator - INFO - File from https://cullmanregional.com/patient-care/financial-services/ is not a valid price transparency file format
2025-04-01 19:22:28,148 - src.pipeline.orchestrator - INFO - Downloading file from https://cullmanregional.com/wp-content/uploads/2025/01/631058174_cullman-regional-medical-center_standardcharges.csv
2025-04-01 19:22:28,967 - src.searchers.web_crawler - INFO - Downloaded file from https://cullmanregional.com/wp-content/uploads/2025/01/631058174_cullman-regional-medical-center_standardcharges.csv to downloads/631058174_cullman-regional-medical-center_standardcharges.csv
2025-04-01 19:22:28,984 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:22:32,243 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:22:32,244 - src.pipeline.orchestrator - INFO - Found valid price file for CULLMAN REGIONAL MEDICAL CENTER: https://cullmanregional.com/wp-content/uploads/2025/01/631058174_cullman-regional-medical-center_standardcharges.csv, confidence: 1.0
2025-04-01 19:22:32,250 - scripts.custom_status_tracker - INFO - Successfully updated hospital 1c41b065-99de-440e-aca6-998ff6c4da8a status
2025-04-01 19:22:32,252 - scripts.custom_status_tracker - ERROR - Error updating price file for hospital 1c41b065-99de-440e-aca6-998ff6c4da8a: 'validation_score' is an invalid keyword argument for HospitalPriceFile
2025-04-01 19:22:32,253 - src.pipeline.orchestrator - INFO - Successful search for CULLMAN REGIONAL MEDICAL CENTER completed in 30.22 seconds
2025-04-01 19:22:32,253 - scripts.run_price_finder - INFO - Price finder result: {'hospital_id': '1c41b065-99de-440e-aca6-998ff6c4da8a', 'url': 'https://cullmanregional.com/wp-content/uploads/2025/01/631058174_cullman-regional-medical-center_standardcharges.csv', 'file_type': 'csv', 'validated': True, 'validation_date': None, 'validation_score': 0.95, 'validation_notes': "The file contains CPT codes, service descriptions, and various pricing information such as gross charges, discounted cash prices, and payer-specific negotiated charges. The hospital name 'CULLMAN REGIONAL MEDICAL CENTER' is clearly mentioned, matching the specified hospital. The data structure aligns well with expected headers for price transparency files, including detailed pricing breakdowns and payer information.", 'file_size': 9444520, 'last_modified': None, 'download_date': None, 'contains_prices': True, 'contains_hospital_name': True, 'coverage_period': None, 'processed': False, 'processing_date': None, 'processing_errors': []}
2025-04-01 19:22:32,255 - scripts.run_price_finder - ERROR - Error processing hospital 1c41b065-99de-440e-aca6-998ff6c4da8a: 'validation_score' is an invalid keyword argument for HospitalPriceFile
2025-04-01 19:22:32,258 - scripts.run_price_finder - ERROR - Traceback (most recent call last):
  File "/Users/bentenner/OmegaReal/backend/scripts/run_price_finder.py", line 228, in update_database_from_price_finder
    price_file = HospitalPriceFile(
                 ^^^^^^^^^^^^^^^^^^
  File "<string>", line 4, in __init__
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/sqlalchemy/orm/state.py", line 571, in _initialize_instance
    with util.safe_reraise():
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/sqlalchemy/orm/state.py", line 569, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/sqlalchemy/orm/decl_base.py", line 2175, in _declarative_constructor
    raise TypeError(
TypeError: 'validation_score' is an invalid keyword argument for HospitalPriceFile

2025-04-01 19:22:32,261 - scripts.run_price_finder - INFO - Successfully processed hospital CULLMAN REGIONAL MEDICAL CENTER
2025-04-01 19:22:32,261 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x114ed1670>, 'zip_code': '35601', 'price_transparency_url': None, 'helipad': True, 'price_file_found': False, 'health_sys_id': 'sys_huntsville_hospital_health_system_huntsville_a', 'hospital_type': 'GENERAL ACUTE CARE', 'health_sys_name': 'Huntsville Hospital Health System', 'name': 'DECATUR MORGAN HOSPITAL - DECATUR CAMPUS', 'status': 'OPEN', 'address': '1201 SEVENTH STREET SOUTHEAST', 'search_status': 'pending', 'population': 273, 'health_sys_city': 'Huntsville', 'search_attempts': 0, 'county': 'MORGAN', 'city': 'DECATUR', 'health_sys_state': 'AL', 'latitude': 34.59034409, 'last_search_date': None, 'longitude': -86.9714815299999, 'state': 'AL', 'corp_parent_name': 'HEALTHGROUP OF ALABAMA', 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579873), 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579874), 'id': '7efe4834-e51a-4d32-9040-5bd157ea7ba3', 'website': None, 'owner': 'PROPRIETARY'}
2025-04-01 19:22:32,261 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': '7efe4834-e51a-4d32-9040-5bd157ea7ba3', 'name': 'DECATUR MORGAN HOSPITAL - DECATUR CAMPUS', 'website': 'https://www.decaturmorganhospital-decaturcampus.org', 'city': 'DECATUR', 'state': 'AL', 'health_system_name': 'Huntsville Hospital Health System'}
2025-04-01 19:22:32,261 - scripts.run_price_finder - INFO - Processing hospital: DECATUR MORGAN HOSPITAL - DECATUR CAMPUS (ID: 7efe4834-e51a-4d32-9040-5bd157ea7ba3)
2025-04-01 19:22:32,262 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='7efe4834-e51a-4d32-9040-5bd157ea7ba3', name='DECATUR MORGAN HOSPITAL - DECATUR CAMPUS', state='AL', city='DECATUR', address=None, website='https://www.decaturmorganhospital-decaturcampus.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:22:32,262 - src.pipeline.orchestrator - INFO - Starting price file search for DECATUR MORGAN HOSPITAL - DECATUR CAMPUS (AL)
2025-04-01 19:22:32,264 - src.pipeline.orchestrator - INFO - Searching for price transparency files for DECATUR MORGAN HOSPITAL - DECATUR CAMPUS
2025-04-01 19:22:32,264 - src.searchers.serpapi_search - INFO - Searching for: DECATUR MORGAN HOSPITAL - DECATUR CAMPUS DECATUR, AL price transparency standard charges
2025-04-01 19:22:32,265 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:22:33,729 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=DECATUR+MORGAN+HOSPITAL+-+DECATUR+CAMPUS+DECATUR%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:22:33,730 - src.searchers.serpapi_search - INFO - Found 14 results for query: DECATUR MORGAN HOSPITAL - DECATUR CAMPUS DECATUR, AL price transparency standard charges
2025-04-01 19:22:33,730 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for DECATUR MORGAN HOSPITAL - DECATUR CAMPUS
2025-04-01 19:22:33,731 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:22:51,752 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:22:51,755 - src.pipeline.orchestrator - INFO - Crawling https://decaturmorganhospital.net/patients-visitors/price-transparency for DECATUR MORGAN HOSPITAL - DECATUR CAMPUS (#1 of top 3)
2025-04-01 19:22:51,755 - src.searchers.web_crawler - INFO - Crawling URL: https://decaturmorganhospital.net/patients-visitors/price-transparency
2025-04-01 19:22:53,477 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:22:54,149 - src.searchers.web_crawler - ERROR - Error fetching https://decaturmorganhospital.net/patients-visitors/price-transparency with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:22:54,196 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:22:54,203 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:22:58,611 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:22:58,612 - src.pipeline.orchestrator - INFO - Found 5 potential price file links for DECATUR MORGAN HOSPITAL - DECATUR CAMPUS
2025-04-01 19:22:58,612 - src.pipeline.orchestrator - INFO - Downloading file from https://www.decaturmorganhospital.com/decatur-morgan-hospital-standard-charge-file
2025-04-01 19:23:28,615 - src.searchers.web_crawler - ERROR - Error downloading file from https://www.decaturmorganhospital.com/decatur-morgan-hospital-standard-charge-file: Cannot connect to host www.decaturmorganhospital.com:443 ssl:default [nodename nor servname provided, or not known]
2025-04-01 19:23:28,616 - src.pipeline.orchestrator - WARNING - Failed to download file from https://www.decaturmorganhospital.com/decatur-morgan-hospital-standard-charge-file
2025-04-01 19:23:28,616 - src.pipeline.orchestrator - INFO - Downloading file from https://decaturmorganhospital.net/patients-visitors/price-transparency#tm-main
2025-04-01 19:23:29,229 - src.searchers.web_crawler - INFO - Downloaded file from https://decaturmorganhospital.net/patients-visitors/price-transparency#tm-main to downloads/price-transparency
2025-04-01 19:23:29,229 - src.validators.file_validator - INFO - Invalid file extension: 
2025-04-01 19:23:29,229 - src.pipeline.orchestrator - INFO - File from https://decaturmorganhospital.net/patients-visitors/price-transparency#tm-main is not a valid price transparency file format
2025-04-01 19:23:29,229 - src.pipeline.orchestrator - INFO - Crawling https://decaturmorganhospital.net/patients-visitors/patient-cost-estimator for DECATUR MORGAN HOSPITAL - DECATUR CAMPUS (#2 of top 3)
2025-04-01 19:23:29,229 - src.searchers.web_crawler - INFO - Crawling URL: https://decaturmorganhospital.net/patients-visitors/patient-cost-estimator
2025-04-01 19:23:30,826 - src.searchers.web_crawler - ERROR - Error fetching https://decaturmorganhospital.net/patients-visitors/patient-cost-estimator with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:23:30,835 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:23:32,771 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:23:32,774 - src.pipeline.orchestrator - INFO - Found 2 potential price file links for DECATUR MORGAN HOSPITAL - DECATUR CAMPUS
2025-04-01 19:23:32,774 - src.pipeline.orchestrator - INFO - Downloading file from https://decaturmorganhospital.net/patients-visitors/price-transparency
2025-04-01 19:23:33,089 - src.searchers.web_crawler - INFO - Downloaded file from https://decaturmorganhospital.net/patients-visitors/price-transparency to downloads/price-transparency
2025-04-01 19:23:33,089 - src.validators.file_validator - INFO - Invalid file extension: 
2025-04-01 19:23:33,089 - src.pipeline.orchestrator - INFO - File from https://decaturmorganhospital.net/patients-visitors/price-transparency is not a valid price transparency file format
2025-04-01 19:23:33,089 - src.pipeline.orchestrator - INFO - Downloading file from https://decaturmorganhospital.net/patients-visitors/financial-assistance
2025-04-01 19:23:33,680 - src.searchers.web_crawler - INFO - Downloaded file from https://decaturmorganhospital.net/patients-visitors/financial-assistance to downloads/financial-assistance
2025-04-01 19:23:33,680 - src.validators.file_validator - INFO - Invalid file extension: 
2025-04-01 19:23:33,680 - src.pipeline.orchestrator - INFO - File from https://decaturmorganhospital.net/patients-visitors/financial-assistance is not a valid price transparency file format
2025-04-01 19:23:33,680 - src.pipeline.orchestrator - INFO - Crawling https://turquoise.health/providers/decatur-morgan-decatur-campus for DECATUR MORGAN HOSPITAL - DECATUR CAMPUS (#3 of top 3)
2025-04-01 19:23:33,680 - src.searchers.web_crawler - INFO - Crawling URL: https://turquoise.health/providers/decatur-morgan-decatur-campus
2025-04-01 19:23:34,525 - src.searchers.web_crawler - ERROR - Error fetching https://turquoise.health/providers/decatur-morgan-decatur-campus with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:23:34,529 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:23:34,547 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:23:36,294 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:23:36,295 - src.pipeline.orchestrator - INFO - Found 0 potential price file links for DECATUR MORGAN HOSPITAL - DECATUR CAMPUS
2025-04-01 19:23:36,301 - scripts.custom_status_tracker - INFO - Successfully updated hospital 7efe4834-e51a-4d32-9040-5bd157ea7ba3 with not_found status
2025-04-01 19:23:36,302 - src.pipeline.orchestrator - INFO - Failed search for DECATUR MORGAN HOSPITAL - DECATUR CAMPUS completed in 1.07 minutes
2025-04-01 19:23:36,302 - scripts.run_price_finder - WARNING - Price finder returned None
2025-04-01 19:23:36,306 - scripts.run_price_finder - INFO - Successfully updated database for hospital DECATUR MORGAN HOSPITAL - DECATUR CAMPUS
2025-04-01 19:23:36,306 - scripts.run_price_finder - INFO - Successfully processed hospital DECATUR MORGAN HOSPITAL - DECATUR CAMPUS
2025-04-01 19:23:36,306 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x114ed16d0>, 'zip_code': '36420', 'price_transparency_url': None, 'helipad': True, 'price_file_found': False, 'health_sys_id': 'sys_scionhealth_louisville_ky', 'hospital_type': 'GENERAL ACUTE CARE', 'health_sys_name': 'ScionHealth', 'name': 'ANDALUSIA HEALTH', 'status': 'OPEN', 'address': '849 SOUTH THREE NOTCH STREET, PO BOX 760', 'search_status': 'searching', 'population': 88, 'health_sys_city': 'Louisville', 'search_attempts': 1, 'county': 'COVINGTON', 'city': 'ANDALUSIA', 'health_sys_state': 'KY', 'latitude': 31.29579533, 'last_search_date': None, 'longitude': -86.49454911, 'state': 'AL', 'corp_parent_name': 'SCIONHEALTH', 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579859), 'updated_at': datetime.datetime(2025, 4, 1, 17, 56, 10, 463147), 'id': 'f2ba2520-7e51-4fed-977f-c98587ec2456', 'website': None, 'owner': 'PROPRIETARY'}
2025-04-01 19:23:36,306 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': 'f2ba2520-7e51-4fed-977f-c98587ec2456', 'name': 'ANDALUSIA HEALTH', 'website': 'https://www.andalusiahealth.org', 'city': 'ANDALUSIA', 'state': 'AL', 'health_system_name': 'ScionHealth'}
2025-04-01 19:23:36,306 - scripts.run_price_finder - INFO - Processing hospital: ANDALUSIA HEALTH (ID: f2ba2520-7e51-4fed-977f-c98587ec2456)
2025-04-01 19:23:36,308 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='f2ba2520-7e51-4fed-977f-c98587ec2456', name='ANDALUSIA HEALTH', state='AL', city='ANDALUSIA', address=None, website='https://www.andalusiahealth.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:23:36,308 - src.pipeline.orchestrator - INFO - Starting price file search for ANDALUSIA HEALTH (AL)
2025-04-01 19:23:36,310 - src.pipeline.orchestrator - INFO - Searching for price transparency files for ANDALUSIA HEALTH
2025-04-01 19:23:36,310 - src.searchers.serpapi_search - INFO - Searching for: ANDALUSIA HEALTH ANDALUSIA, AL price transparency standard charges
2025-04-01 19:23:36,311 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:23:40,289 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=ANDALUSIA+HEALTH+ANDALUSIA%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:23:40,290 - src.searchers.serpapi_search - INFO - Found 14 results for query: ANDALUSIA HEALTH ANDALUSIA, AL price transparency standard charges
2025-04-01 19:23:40,290 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for ANDALUSIA HEALTH
2025-04-01 19:23:40,291 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:23:57,286 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:23:57,288 - src.pipeline.orchestrator - INFO - Crawling https://hospitalpricedisclosure.com/Default?ci=i6ONagzmVJ4SGUBWC7W82Q*-* for ANDALUSIA HEALTH (#1 of top 3)
2025-04-01 19:23:57,289 - src.searchers.web_crawler - INFO - Crawling URL: https://hospitalpricedisclosure.com/Default?ci=i6ONagzmVJ4SGUBWC7W82Q*-*
2025-04-01 19:23:58,998 - src.searchers.web_crawler - ERROR - Error fetching https://hospitalpricedisclosure.com/Default?ci=i6ONagzmVJ4SGUBWC7W82Q*-* with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:23:59,033 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:24:01,283 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:24:01,284 - src.pipeline.orchestrator - INFO - Found 4 potential price file links for ANDALUSIA HEALTH
2025-04-01 19:24:01,284 - src.pipeline.orchestrator - INFO - Downloading file from https://example.com/machine-readable-file-andalusia-health
2025-04-01 19:24:01,784 - src.searchers.web_crawler - ERROR - Failed to download file from https://example.com/machine-readable-file-andalusia-health, status: 404
2025-04-01 19:24:01,784 - src.pipeline.orchestrator - WARNING - Failed to download file from https://example.com/machine-readable-file-andalusia-health
2025-04-01 19:24:01,785 - src.pipeline.orchestrator - INFO - Downloading file from https://hospitalpricedisclosure.com/default.aspx
2025-04-01 19:24:02,017 - src.searchers.web_crawler - INFO - Downloaded file from https://hospitalpricedisclosure.com/default.aspx to downloads/default.aspx
2025-04-01 19:24:02,017 - src.validators.file_validator - INFO - Invalid file extension: .aspx
2025-04-01 19:24:02,017 - src.pipeline.orchestrator - INFO - File from https://hospitalpricedisclosure.com/default.aspx is not a valid price transparency file format
2025-04-01 19:24:02,017 - src.pipeline.orchestrator - INFO - Crawling https://www.andalusiahealth.com/cost-estimator for ANDALUSIA HEALTH (#2 of top 3)
2025-04-01 19:24:02,017 - src.searchers.web_crawler - INFO - Crawling URL: https://www.andalusiahealth.com/cost-estimator
2025-04-01 19:24:02,732 - src.searchers.web_crawler - ERROR - Error fetching https://www.andalusiahealth.com/cost-estimator with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:24:02,740 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:24:05,054 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:24:05,056 - src.pipeline.orchestrator - INFO - Found 3 potential price file links for ANDALUSIA HEALTH
2025-04-01 19:24:05,056 - src.pipeline.orchestrator - INFO - Downloading file from https://www.andalusiahealth.com/hospital-charges-listing
2025-04-01 19:24:05,952 - src.searchers.web_crawler - INFO - Downloaded file from https://www.andalusiahealth.com/hospital-charges-listing to downloads/hospital-charges-listing
2025-04-01 19:24:05,957 - src.validators.file_validator - INFO - Invalid file extension: 
2025-04-01 19:24:05,958 - src.pipeline.orchestrator - INFO - File from https://www.andalusiahealth.com/hospital-charges-listing is not a valid price transparency file format
2025-04-01 19:24:05,959 - src.pipeline.orchestrator - INFO - Downloading file from https://hospitalpricedisclosure.com/default.aspx?pi=ynjv1MOGFWujAAuytgs3gQ*-*
2025-04-01 19:24:06,320 - src.searchers.web_crawler - INFO - Downloaded file from https://hospitalpricedisclosure.com/default.aspx?pi=ynjv1MOGFWujAAuytgs3gQ*-* to downloads/default.aspx
2025-04-01 19:24:06,321 - src.validators.file_validator - INFO - Invalid file extension: .aspx
2025-04-01 19:24:06,321 - src.pipeline.orchestrator - INFO - File from https://hospitalpricedisclosure.com/default.aspx?pi=ynjv1MOGFWujAAuytgs3gQ*-* is not a valid price transparency file format
2025-04-01 19:24:06,321 - src.pipeline.orchestrator - INFO - Crawling https://www.andalusiahealth.com/understanding-your-healthcare-costs for ANDALUSIA HEALTH (#3 of top 3)
2025-04-01 19:24:06,321 - src.searchers.web_crawler - INFO - Crawling URL: https://www.andalusiahealth.com/understanding-your-healthcare-costs
2025-04-01 19:24:06,931 - src.searchers.web_crawler - ERROR - Error fetching https://www.andalusiahealth.com/understanding-your-healthcare-costs with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:24:06,937 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:24:08,867 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:24:08,868 - src.pipeline.orchestrator - INFO - Found 4 potential price file links for ANDALUSIA HEALTH
2025-04-01 19:24:08,868 - src.pipeline.orchestrator - INFO - Downloading file from https://hospitalpricedisclosure.com/default.aspx?pi=ynjv1MOGFWujAAuytgs3gQ*-*
2025-04-01 19:24:09,178 - src.searchers.web_crawler - INFO - Downloaded file from https://hospitalpricedisclosure.com/default.aspx?pi=ynjv1MOGFWujAAuytgs3gQ*-* to downloads/default.aspx
2025-04-01 19:24:09,178 - src.validators.file_validator - INFO - Invalid file extension: .aspx
2025-04-01 19:24:09,178 - src.pipeline.orchestrator - INFO - File from https://hospitalpricedisclosure.com/default.aspx?pi=ynjv1MOGFWujAAuytgs3gQ*-* is not a valid price transparency file format
2025-04-01 19:24:09,178 - src.pipeline.orchestrator - INFO - Downloading file from https://www.andalusiahealth.com/sites/andalusia/assets/uploads/AL - Notice Regarding Patient Protections Against Surprise Billing.pdf
2025-04-01 19:24:09,800 - src.searchers.web_crawler - INFO - Downloaded file from https://www.andalusiahealth.com/sites/andalusia/assets/uploads/AL - Notice Regarding Patient Protections Against Surprise Billing.pdf to downloads/AL - Notice Regarding Patient Protections Against Surprise Billing.pdf
2025-04-01 19:24:09,800 - src.validators.file_validator - INFO - Invalid file extension: .pdf
2025-04-01 19:24:09,800 - src.pipeline.orchestrator - INFO - File from https://www.andalusiahealth.com/sites/andalusia/assets/uploads/AL - Notice Regarding Patient Protections Against Surprise Billing.pdf is not a valid price transparency file format
2025-04-01 19:24:09,803 - scripts.custom_status_tracker - INFO - Successfully updated hospital f2ba2520-7e51-4fed-977f-c98587ec2456 with not_found status
2025-04-01 19:24:09,804 - src.pipeline.orchestrator - INFO - Failed search for ANDALUSIA HEALTH completed in 33.50 seconds
2025-04-01 19:24:09,804 - scripts.run_price_finder - WARNING - Price finder returned None
2025-04-01 19:24:09,807 - scripts.run_price_finder - INFO - Successfully updated database for hospital ANDALUSIA HEALTH
2025-04-01 19:24:09,807 - scripts.run_price_finder - INFO - Successfully processed hospital ANDALUSIA HEALTH
2025-04-01 19:24:09,808 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x114ed1730>, 'zip_code': '36502', 'price_transparency_url': None, 'helipad': True, 'price_file_found': False, 'health_sys_id': 'sys_infirmary_health_system_mobile_al', 'hospital_type': 'GENERAL ACUTE CARE', 'health_sys_name': 'Infirmary Health System', 'name': 'ATMORE COMMUNITY HOSPITAL', 'status': 'OPEN', 'address': '401 MEDICAL PARK DR', 'search_status': 'searching', 'population': 51, 'health_sys_city': 'Mobile', 'search_attempts': 1, 'county': 'ESCAMBIA', 'city': 'ATMORE', 'health_sys_state': 'AL', 'latitude': 31.0170238700001, 'last_search_date': None, 'longitude': -87.47879851, 'state': 'AL', 'corp_parent_name': None, 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579862), 'updated_at': datetime.datetime(2025, 4, 1, 18, 0, 16, 757531), 'id': 'f1165b29-70a5-480b-881a-a3a5fa6af02b', 'website': None, 'owner': 'NON-PROFIT'}
2025-04-01 19:24:09,808 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': 'f1165b29-70a5-480b-881a-a3a5fa6af02b', 'name': 'ATMORE COMMUNITY HOSPITAL', 'website': 'https://www.atmorecommunityhospital.org', 'city': 'ATMORE', 'state': 'AL', 'health_system_name': 'Infirmary Health System'}
2025-04-01 19:24:09,808 - scripts.run_price_finder - INFO - Processing hospital: ATMORE COMMUNITY HOSPITAL (ID: f1165b29-70a5-480b-881a-a3a5fa6af02b)
2025-04-01 19:24:09,808 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='f1165b29-70a5-480b-881a-a3a5fa6af02b', name='ATMORE COMMUNITY HOSPITAL', state='AL', city='ATMORE', address=None, website='https://www.atmorecommunityhospital.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:24:09,808 - src.pipeline.orchestrator - INFO - Starting price file search for ATMORE COMMUNITY HOSPITAL (AL)
2025-04-01 19:24:09,810 - src.pipeline.orchestrator - INFO - Searching for price transparency files for ATMORE COMMUNITY HOSPITAL
2025-04-01 19:24:09,810 - src.searchers.serpapi_search - INFO - Searching for: ATMORE COMMUNITY HOSPITAL ATMORE, AL price transparency standard charges
2025-04-01 19:24:09,811 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:24:10,445 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=ATMORE+COMMUNITY+HOSPITAL+ATMORE%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:24:10,446 - src.searchers.serpapi_search - INFO - Found 14 results for query: ATMORE COMMUNITY HOSPITAL ATMORE, AL price transparency standard charges
2025-04-01 19:24:10,446 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for ATMORE COMMUNITY HOSPITAL
2025-04-01 19:24:10,447 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:24:26,818 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:24:26,820 - src.pipeline.orchestrator - INFO - Crawling https://www.atmorehealth.org/getpage.php?name=Standard_Billing for ATMORE COMMUNITY HOSPITAL (#1 of top 3)
2025-04-01 19:24:26,820 - src.searchers.web_crawler - INFO - Crawling URL: https://www.atmorehealth.org/getpage.php?name=Standard_Billing
2025-04-01 19:24:28,048 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:24:28,048 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:24:28,749 - src.searchers.web_crawler - ERROR - Error fetching https://www.atmorehealth.org/getpage.php?name=Standard_Billing with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:24:28,762 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:24:32,924 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:24:32,926 - src.pipeline.orchestrator - INFO - Found 5 potential price file links for ATMORE COMMUNITY HOSPITAL
2025-04-01 19:24:32,926 - src.pipeline.orchestrator - INFO - Downloading file from https://www.atmorehealth.org/getpage.php?name=Standard_Billing#main_content_area
2025-04-01 19:24:33,376 - src.searchers.web_crawler - INFO - Downloaded file from https://www.atmorehealth.org/getpage.php?name=Standard_Billing#main_content_area to downloads/getpage.php
2025-04-01 19:24:33,376 - src.validators.file_validator - INFO - Invalid file extension: .php
2025-04-01 19:24:33,376 - src.pipeline.orchestrator - INFO - File from https://www.atmorehealth.org/getpage.php?name=Standard_Billing#main_content_area is not a valid price transparency file format
2025-04-01 19:24:33,376 - src.pipeline.orchestrator - INFO - Downloading file from https://www.atmorehospital.com/averagedrg.htm
2025-04-01 19:24:33,404 - src.searchers.web_crawler - ERROR - Error downloading file from https://www.atmorehospital.com/averagedrg.htm: Cannot connect to host www.atmorehospital.com:443 ssl:default [nodename nor servname provided, or not known]
2025-04-01 19:24:33,404 - src.pipeline.orchestrator - WARNING - Failed to download file from https://www.atmorehospital.com/averagedrg.htm
2025-04-01 19:24:33,404 - src.pipeline.orchestrator - INFO - Crawling https://www.atmorehealth.org/getpage.php?name=Price_Transparency for ATMORE COMMUNITY HOSPITAL (#2 of top 3)
2025-04-01 19:24:33,404 - src.searchers.web_crawler - INFO - Crawling URL: https://www.atmorehealth.org/getpage.php?name=Price_Transparency
2025-04-01 19:24:34,274 - src.searchers.web_crawler - ERROR - Error fetching https://www.atmorehealth.org/getpage.php?name=Price_Transparency with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:24:34,284 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:24:36,385 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:24:36,386 - src.pipeline.orchestrator - INFO - Found 4 potential price file links for ATMORE COMMUNITY HOSPITAL
2025-04-01 19:24:36,386 - src.pipeline.orchestrator - INFO - Downloading file from https://www.atmorehealth.org/getpage.php?name=Price_Transparency#main_content_area
2025-04-01 19:24:36,815 - src.searchers.web_crawler - INFO - Downloaded file from https://www.atmorehealth.org/getpage.php?name=Price_Transparency#main_content_area to downloads/getpage.php
2025-04-01 19:24:36,816 - src.validators.file_validator - INFO - Invalid file extension: .php
2025-04-01 19:24:36,816 - src.pipeline.orchestrator - INFO - File from https://www.atmorehealth.org/getpage.php?name=Price_Transparency#main_content_area is not a valid price transparency file format
2025-04-01 19:24:36,816 - src.pipeline.orchestrator - INFO - Downloading file from https://www.atmorehealth.org/getpage.php?name=Price_Transparency##
2025-04-01 19:24:37,270 - src.searchers.web_crawler - INFO - Downloaded file from https://www.atmorehealth.org/getpage.php?name=Price_Transparency## to downloads/getpage.php
2025-04-01 19:24:37,271 - src.validators.file_validator - INFO - Invalid file extension: .php
2025-04-01 19:24:37,271 - src.pipeline.orchestrator - INFO - File from https://www.atmorehealth.org/getpage.php?name=Price_Transparency## is not a valid price transparency file format
2025-04-01 19:24:37,271 - src.pipeline.orchestrator - INFO - Crawling https://turquoise.health/providers/atmore-community-hospital for ATMORE COMMUNITY HOSPITAL (#3 of top 3)
2025-04-01 19:24:37,271 - src.searchers.web_crawler - INFO - Crawling URL: https://turquoise.health/providers/atmore-community-hospital
2025-04-01 19:24:38,190 - src.searchers.web_crawler - ERROR - Error fetching https://turquoise.health/providers/atmore-community-hospital with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:24:38,194 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:24:38,194 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:24:38,211 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:24:40,274 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:24:40,275 - src.pipeline.orchestrator - INFO - Found 0 potential price file links for ATMORE COMMUNITY HOSPITAL
2025-04-01 19:24:40,279 - scripts.custom_status_tracker - INFO - Successfully updated hospital f1165b29-70a5-480b-881a-a3a5fa6af02b with not_found status
2025-04-01 19:24:40,280 - src.pipeline.orchestrator - INFO - Failed search for ATMORE COMMUNITY HOSPITAL completed in 30.47 seconds
2025-04-01 19:24:40,280 - scripts.run_price_finder - WARNING - Price finder returned None
2025-04-01 19:24:40,283 - scripts.run_price_finder - INFO - Successfully updated database for hospital ATMORE COMMUNITY HOSPITAL
2025-04-01 19:24:40,283 - scripts.run_price_finder - INFO - Successfully processed hospital ATMORE COMMUNITY HOSPITAL
2025-04-01 19:24:40,283 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x114ed1790>, 'zip_code': '35401', 'price_transparency_url': None, 'helipad': True, 'price_file_found': False, 'health_sys_id': 'sys_dch_health_system_tuscaloosa_al', 'hospital_type': 'GENERAL ACUTE CARE', 'health_sys_name': 'DCH Health System', 'name': 'DCH REGIONAL MEDICAL CENTER', 'status': 'OPEN', 'address': '809 UNIVERSITY BOULEVARD EAST', 'search_status': 'pending', 'population': 583, 'health_sys_city': 'Tuscaloosa', 'search_attempts': 0, 'county': 'TUSCALOOSA', 'city': 'TUSCALOOSA', 'health_sys_state': 'AL', 'latitude': 33.2048205300001, 'last_search_date': None, 'longitude': -87.52741947, 'state': 'AL', 'corp_parent_name': 'DCH HEALTH SYSTEM', 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579873), 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579873), 'id': 'e015f96f-7524-4664-bb82-1920ded4b369', 'website': None, 'owner': 'GOVERNMENT - DISTRICT/AUTHORITY'}
2025-04-01 19:24:40,283 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': 'e015f96f-7524-4664-bb82-1920ded4b369', 'name': 'DCH REGIONAL MEDICAL CENTER', 'website': 'https://www.dchregionalmedicalcenter.org', 'city': 'TUSCALOOSA', 'state': 'AL', 'health_system_name': 'DCH Health System'}
2025-04-01 19:24:40,284 - scripts.run_price_finder - INFO - Processing hospital: DCH REGIONAL MEDICAL CENTER (ID: e015f96f-7524-4664-bb82-1920ded4b369)
2025-04-01 19:24:40,284 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='e015f96f-7524-4664-bb82-1920ded4b369', name='DCH REGIONAL MEDICAL CENTER', state='AL', city='TUSCALOOSA', address=None, website='https://www.dchregionalmedicalcenter.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:24:40,284 - src.pipeline.orchestrator - INFO - Starting price file search for DCH REGIONAL MEDICAL CENTER (AL)
2025-04-01 19:24:40,286 - src.pipeline.orchestrator - INFO - Searching for price transparency files for DCH REGIONAL MEDICAL CENTER
2025-04-01 19:24:40,286 - src.searchers.serpapi_search - INFO - Searching for: DCH REGIONAL MEDICAL CENTER TUSCALOOSA, AL price transparency standard charges
2025-04-01 19:24:40,287 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:24:41,114 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=DCH+REGIONAL+MEDICAL+CENTER+TUSCALOOSA%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:24:41,115 - src.searchers.serpapi_search - INFO - Found 12 results for query: DCH REGIONAL MEDICAL CENTER TUSCALOOSA, AL price transparency standard charges
2025-04-01 19:24:41,115 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for DCH REGIONAL MEDICAL CENTER
2025-04-01 19:24:41,116 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:25:01,390 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:25:01,392 - src.pipeline.orchestrator - INFO - Crawling https://www.dchsystem.com/patient-visitor/understanding-the-cost-of-your-care/chargemaster/list-of-charges/ for DCH REGIONAL MEDICAL CENTER (#1 of top 3)
2025-04-01 19:25:01,392 - src.searchers.web_crawler - INFO - Crawling URL: https://www.dchsystem.com/patient-visitor/understanding-the-cost-of-your-care/chargemaster/list-of-charges/
2025-04-01 19:25:02,909 - src.searchers.web_crawler - ERROR - Error fetching https://www.dchsystem.com/patient-visitor/understanding-the-cost-of-your-care/chargemaster/list-of-charges/ with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:25:02,930 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:25:13,140 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:25:13,142 - src.pipeline.orchestrator - INFO - Found 8 potential price file links for DCH REGIONAL MEDICAL CENTER
2025-04-01 19:25:13,142 - src.pipeline.orchestrator - INFO - Downloading file from https://www.dchsystem.com/documents/chargemaster 2021/Pharmacy-Chargemaster-2-17-21.xlsx
2025-04-01 19:25:13,593 - src.searchers.web_crawler - INFO - Downloaded file from https://www.dchsystem.com/documents/chargemaster 2021/Pharmacy-Chargemaster-2-17-21.xlsx to downloads/Pharmacy-Chargemaster-2-17-21.xlsx
2025-04-01 19:25:13,740 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:25:13,741 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:25:13,741 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:25:13,741 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:25:13,741 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:25:13,828 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:25:17,451 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:25:17,453 - src.pipeline.orchestrator - INFO - File from https://www.dchsystem.com/documents/chargemaster 2021/Pharmacy-Chargemaster-2-17-21.xlsx is not a match for DCH REGIONAL MEDICAL CENTER: Rule-based: No hospital name or location matches found. LLM: The file contains procedure descriptions, HCPCS codes, and pricing information, which are key elements of valid hospital price transparency data. However, it does not explicitly mention the hospital name 'DCH REGIONAL MEDICAL CENTER' or its location 'TUSCALOOSA, AL'. The validation score is high because the essential pricing data is present, but the lack of hospital-specific information prevents a perfect score.
2025-04-01 19:25:17,453 - src.pipeline.orchestrator - INFO - Downloading file from https://www.dchsystem.com/patients-visitors/billing-financial-assistance/list-of-charges/non-pharmacy-charges
2025-04-01 19:25:17,761 - src.searchers.web_crawler - ERROR - Failed to download file from https://www.dchsystem.com/patients-visitors/billing-financial-assistance/list-of-charges/non-pharmacy-charges, status: 404
2025-04-01 19:25:17,762 - src.pipeline.orchestrator - WARNING - Failed to download file from https://www.dchsystem.com/patients-visitors/billing-financial-assistance/list-of-charges/non-pharmacy-charges
2025-04-01 19:25:17,762 - src.pipeline.orchestrator - INFO - Crawling https://www.dchsystem.com/patient-visitor/understanding-the-cost-of-your-care/chargemaster/ for DCH REGIONAL MEDICAL CENTER (#2 of top 3)
2025-04-01 19:25:17,762 - src.searchers.web_crawler - INFO - Crawling URL: https://www.dchsystem.com/patient-visitor/understanding-the-cost-of-your-care/chargemaster/
2025-04-01 19:25:18,672 - src.searchers.web_crawler - ERROR - Error fetching https://www.dchsystem.com/patient-visitor/understanding-the-cost-of-your-care/chargemaster/ with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:25:18,692 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:25:20,538 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:25:20,539 - src.pipeline.orchestrator - INFO - Found 3 potential price file links for DCH REGIONAL MEDICAL CENTER
2025-04-01 19:25:20,539 - src.pipeline.orchestrator - INFO - Downloading file from https://www.dchsystem.com/patient-visitor/understanding-the-cost-of-your-care/chargemaster/list-of-charges/
2025-04-01 19:25:20,849 - src.searchers.web_crawler - INFO - Downloaded file from https://www.dchsystem.com/patient-visitor/understanding-the-cost-of-your-care/chargemaster/list-of-charges/ to downloads/download_20250401_192520.dat
2025-04-01 19:25:20,849 - src.validators.file_validator - INFO - Invalid file extension: .dat
2025-04-01 19:25:20,849 - src.pipeline.orchestrator - INFO - File from https://www.dchsystem.com/patient-visitor/understanding-the-cost-of-your-care/chargemaster/list-of-charges/ is not a valid price transparency file format
2025-04-01 19:25:20,849 - src.pipeline.orchestrator - INFO - Downloading file from https://www.dchsystem.com/patient-visitor/understanding-the-cost-of-your-care/chargemaster/#SiteTop
2025-04-01 19:25:21,211 - src.searchers.web_crawler - INFO - Downloaded file from https://www.dchsystem.com/patient-visitor/understanding-the-cost-of-your-care/chargemaster/#SiteTop to downloads/download_20250401_192521.dat
2025-04-01 19:25:21,212 - src.validators.file_validator - INFO - Invalid file extension: .dat
2025-04-01 19:25:21,212 - src.pipeline.orchestrator - INFO - File from https://www.dchsystem.com/patient-visitor/understanding-the-cost-of-your-care/chargemaster/#SiteTop is not a valid price transparency file format
2025-04-01 19:25:21,215 - scripts.custom_status_tracker - INFO - Successfully updated hospital e015f96f-7524-4664-bb82-1920ded4b369 with not_found status
2025-04-01 19:25:21,216 - src.pipeline.orchestrator - INFO - Failed search for DCH REGIONAL MEDICAL CENTER completed in 40.93 seconds
2025-04-01 19:25:21,216 - scripts.run_price_finder - WARNING - Price finder returned None
2025-04-01 19:25:21,219 - scripts.run_price_finder - INFO - Successfully updated database for hospital DCH REGIONAL MEDICAL CENTER
2025-04-01 19:25:21,219 - scripts.run_price_finder - INFO - Successfully processed hospital DCH REGIONAL MEDICAL CENTER
2025-04-01 19:25:21,220 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x114ed17f0>, 'zip_code': '36427', 'price_transparency_url': None, 'helipad': True, 'price_file_found': False, 'health_sys_id': 'sys_independent', 'hospital_type': 'GENERAL ACUTE CARE', 'health_sys_name': 'Independent', 'name': 'D. W. MCMILLAN MEMORIAL HOSPITAL', 'status': 'OPEN', 'address': '1301 BELLEVILLE AVENUE, PO DRAWER 908', 'search_status': 'pending', 'population': 91, 'health_sys_city': None, 'search_attempts': 0, 'county': 'ESCAMBIA', 'city': 'BREWTON', 'health_sys_state': None, 'latitude': 31.1270339100001, 'last_search_date': None, 'longitude': -87.0734993, 'state': 'AL', 'corp_parent_name': None, 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579872), 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579872), 'id': '3a117e1a-ff30-4942-80b9-d521076b7169', 'website': None, 'owner': 'GOVERNMENT - DISTRICT/AUTHORITY'}
2025-04-01 19:25:21,220 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': '3a117e1a-ff30-4942-80b9-d521076b7169', 'name': 'D. W. MCMILLAN MEMORIAL HOSPITAL', 'website': 'https://www.d.w.mcmillanmemorialhospital.org', 'city': 'BREWTON', 'state': 'AL', 'health_system_name': 'Independent'}
2025-04-01 19:25:21,220 - scripts.run_price_finder - INFO - Processing hospital: D. W. MCMILLAN MEMORIAL HOSPITAL (ID: 3a117e1a-ff30-4942-80b9-d521076b7169)
2025-04-01 19:25:21,221 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='3a117e1a-ff30-4942-80b9-d521076b7169', name='D. W. MCMILLAN MEMORIAL HOSPITAL', state='AL', city='BREWTON', address=None, website='https://www.d.w.mcmillanmemorialhospital.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:25:21,221 - src.pipeline.orchestrator - INFO - Starting price file search for D. W. MCMILLAN MEMORIAL HOSPITAL (AL)
2025-04-01 19:25:21,222 - src.pipeline.orchestrator - INFO - Searching for price transparency files for D. W. MCMILLAN MEMORIAL HOSPITAL
2025-04-01 19:25:21,223 - src.searchers.serpapi_search - INFO - Searching for: D. W. MCMILLAN MEMORIAL HOSPITAL BREWTON, AL price transparency standard charges
2025-04-01 19:25:21,223 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:25:21,928 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=D.+W.+MCMILLAN+MEMORIAL+HOSPITAL+BREWTON%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:25:21,929 - src.searchers.serpapi_search - INFO - Found 14 results for query: D. W. MCMILLAN MEMORIAL HOSPITAL BREWTON, AL price transparency standard charges
2025-04-01 19:25:21,929 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for D. W. MCMILLAN MEMORIAL HOSPITAL
2025-04-01 19:25:21,930 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:25:38,896 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:25:38,898 - src.pipeline.orchestrator - INFO - Crawling https://www.dwmmh.org/getpage.php?name=Price_Transparency for D. W. MCMILLAN MEMORIAL HOSPITAL (#1 of top 3)
2025-04-01 19:25:38,898 - src.searchers.web_crawler - INFO - Crawling URL: https://www.dwmmh.org/getpage.php?name=Price_Transparency
2025-04-01 19:25:39,961 - src.searchers.web_crawler - ERROR - Error fetching https://www.dwmmh.org/getpage.php?name=Price_Transparency with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:25:39,962 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:25:39,972 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:25:42,001 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:25:42,014 - src.pipeline.orchestrator - INFO - Found 4 potential price file links for D. W. MCMILLAN MEMORIAL HOSPITAL
2025-04-01 19:25:42,014 - src.pipeline.orchestrator - INFO - Downloading file from https://example.com/Machine-Readable-File
2025-04-01 19:25:42,521 - src.searchers.web_crawler - ERROR - Failed to download file from https://example.com/Machine-Readable-File, status: 404
2025-04-01 19:25:42,522 - src.pipeline.orchestrator - WARNING - Failed to download file from https://example.com/Machine-Readable-File
2025-04-01 19:25:42,522 - src.pipeline.orchestrator - INFO - Downloading file from https://www.dwmmh.org/getpage.php?name=Price_Transparency#main_content_area
2025-04-01 19:25:42,965 - src.searchers.web_crawler - INFO - Downloaded file from https://www.dwmmh.org/getpage.php?name=Price_Transparency#main_content_area to downloads/getpage.php
2025-04-01 19:25:42,965 - src.validators.file_validator - INFO - Invalid file extension: .php
2025-04-01 19:25:42,965 - src.pipeline.orchestrator - INFO - File from https://www.dwmmh.org/getpage.php?name=Price_Transparency#main_content_area is not a valid price transparency file format
2025-04-01 19:25:42,968 - scripts.custom_status_tracker - INFO - Successfully updated hospital 3a117e1a-ff30-4942-80b9-d521076b7169 with not_found status
2025-04-01 19:25:42,969 - src.pipeline.orchestrator - INFO - Failed search for D. W. MCMILLAN MEMORIAL HOSPITAL completed in 21.75 seconds
2025-04-01 19:25:42,969 - scripts.run_price_finder - WARNING - Price finder returned None
2025-04-01 19:25:42,972 - scripts.run_price_finder - INFO - Successfully updated database for hospital D. W. MCMILLAN MEMORIAL HOSPITAL
2025-04-01 19:25:42,972 - scripts.run_price_finder - INFO - Successfully processed hospital D. W. MCMILLAN MEMORIAL HOSPITAL
2025-04-01 19:25:42,973 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x114ed1850>, 'zip_code': '35261', 'price_transparency_url': None, 'helipad': False, 'price_file_found': False, 'health_sys_id': 'sys_independent', 'hospital_type': 'LONG TERM CARE', 'health_sys_name': 'Independent', 'name': 'NOLAND HOSPITAL BIRMINGHAM II, LLC', 'status': 'OPEN', 'address': '50 MEDICAL PARK EAST DRIVE, 8TH FLOOR, PO BOX 610306', 'search_status': 'pending', 'population': 45, 'health_sys_city': None, 'search_attempts': 0, 'county': 'SHELBY', 'city': 'BIRMINGHAM', 'health_sys_state': None, 'latitude': 33.4149192100001, 'last_search_date': None, 'longitude': -86.68602206, 'state': 'AL', 'corp_parent_name': None, 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579894), 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579895), 'id': '1221a7d6-bc43-4611-aaa4-9bf6cc3fb1db', 'website': None, 'owner': 'PROPRIETARY'}
2025-04-01 19:25:42,973 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': '1221a7d6-bc43-4611-aaa4-9bf6cc3fb1db', 'name': 'NOLAND HOSPITAL BIRMINGHAM II, LLC', 'website': 'https://www.nolandhospitalbirminghamii,llc.org', 'city': 'BIRMINGHAM', 'state': 'AL', 'health_system_name': 'Independent'}
2025-04-01 19:25:42,973 - scripts.run_price_finder - INFO - Processing hospital: NOLAND HOSPITAL BIRMINGHAM II, LLC (ID: 1221a7d6-bc43-4611-aaa4-9bf6cc3fb1db)
2025-04-01 19:25:42,974 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='1221a7d6-bc43-4611-aaa4-9bf6cc3fb1db', name='NOLAND HOSPITAL BIRMINGHAM II, LLC', state='AL', city='BIRMINGHAM', address=None, website='https://www.nolandhospitalbirminghamii,llc.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:25:42,974 - src.pipeline.orchestrator - INFO - Starting price file search for NOLAND HOSPITAL BIRMINGHAM II, LLC (AL)
2025-04-01 19:25:42,976 - src.pipeline.orchestrator - INFO - Searching for price transparency files for NOLAND HOSPITAL BIRMINGHAM II, LLC
2025-04-01 19:25:42,976 - src.searchers.serpapi_search - INFO - Searching for: NOLAND HOSPITAL BIRMINGHAM II, LLC BIRMINGHAM, AL price transparency standard charges
2025-04-01 19:25:42,976 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:25:45,051 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=NOLAND+HOSPITAL+BIRMINGHAM+II%2C+LLC+BIRMINGHAM%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:25:45,053 - src.searchers.serpapi_search - INFO - Found 14 results for query: NOLAND HOSPITAL BIRMINGHAM II, LLC BIRMINGHAM, AL price transparency standard charges
2025-04-01 19:25:45,053 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for NOLAND HOSPITAL BIRMINGHAM II, LLC
2025-04-01 19:25:45,054 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:26:02,938 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:26:02,941 - src.pipeline.orchestrator - INFO - Crawling https://nolandhospitals.com/price-transparency/ for NOLAND HOSPITAL BIRMINGHAM II, LLC (#1 of top 3)
2025-04-01 19:26:02,941 - src.searchers.web_crawler - INFO - Crawling URL: https://nolandhospitals.com/price-transparency/
2025-04-01 19:26:04,881 - src.searchers.web_crawler - ERROR - Error fetching https://nolandhospitals.com/price-transparency/ with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:26:04,890 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:26:10,993 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:26:10,995 - src.pipeline.orchestrator - INFO - Found 7 potential price file links for NOLAND HOSPITAL BIRMINGHAM II, LLC
2025-04-01 19:26:10,995 - src.pipeline.orchestrator - INFO - Downloading file from https://nolandhospitals.com/wp-content/uploads/price-transparency/472491675_Noland_Hospital_Dothan_standardcharges__1_.csv
2025-04-01 19:26:13,258 - src.searchers.web_crawler - INFO - Downloaded file from https://nolandhospitals.com/wp-content/uploads/price-transparency/472491675_Noland_Hospital_Dothan_standardcharges__1_.csv to downloads/472491675_Noland_Hospital_Dothan_standardcharges__1_.csv
2025-04-01 19:26:13,265 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:26:25,447 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:26:25,449 - src.pipeline.orchestrator - INFO - File from https://nolandhospitals.com/wp-content/uploads/price-transparency/472491675_Noland_Hospital_Dothan_standardcharges__1_.csv is not a match for NOLAND HOSPITAL BIRMINGHAM II, LLC: Rule-based: Found location matches: state: AL, but no hospital name match. LLM: The file contains pricing information with MS-DRG codes and detailed payer-specific negotiated charges, which is characteristic of hospital price transparency data. However, the hospital name mentioned in the file is 'NOLAND HOSPITAL DOTHAN II, LLC' located in Dothan, AL, not 'NOLAND HOSPITAL BIRMINGHAM II, LLC' in Birmingham, AL. Therefore, it does not belong to the specified hospital.
2025-04-01 19:26:25,449 - src.pipeline.orchestrator - INFO - Downloading file from https://www.nolandhealth.com/price-transparency-tuscaloosa
2025-04-01 19:26:27,233 - src.searchers.web_crawler - INFO - Downloaded file from https://www.nolandhealth.com/price-transparency-tuscaloosa to downloads/price-transparency-tuscaloosa
2025-04-01 19:26:27,234 - src.validators.file_validator - INFO - Invalid file extension: 
2025-04-01 19:26:27,234 - src.pipeline.orchestrator - INFO - File from https://www.nolandhealth.com/price-transparency-tuscaloosa is not a valid price transparency file format
2025-04-01 19:26:27,234 - src.pipeline.orchestrator - INFO - Crawling https://www.nolandhealth.com/about/price-transparency/ for NOLAND HOSPITAL BIRMINGHAM II, LLC (#2 of top 3)
2025-04-01 19:26:27,234 - src.searchers.web_crawler - INFO - Crawling URL: https://www.nolandhealth.com/about/price-transparency/
2025-04-01 19:26:28,777 - src.searchers.web_crawler - ERROR - Error fetching https://www.nolandhealth.com/about/price-transparency/ with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:26:28,788 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:26:28,807 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:26:36,490 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:26:36,492 - src.pipeline.orchestrator - INFO - Found 8 potential price file links for NOLAND HOSPITAL BIRMINGHAM II, LLC
2025-04-01 19:26:36,492 - src.pipeline.orchestrator - INFO - Downloading file from https://www.nolandhealth.com/hospital-anniston-machine-readable
2025-04-01 19:26:37,339 - src.searchers.web_crawler - INFO - Downloaded file from https://www.nolandhealth.com/hospital-anniston-machine-readable to downloads/hospital-anniston-machine-readable
2025-04-01 19:26:37,339 - src.validators.file_validator - INFO - Invalid file extension: 
2025-04-01 19:26:37,339 - src.pipeline.orchestrator - INFO - File from https://www.nolandhealth.com/hospital-anniston-machine-readable is not a valid price transparency file format
2025-04-01 19:26:37,339 - src.pipeline.orchestrator - INFO - Downloading file from https://www.nolandhealth.com/hospital-birmingham-machine-readable
2025-04-01 19:26:38,057 - src.searchers.web_crawler - INFO - Downloaded file from https://www.nolandhealth.com/hospital-birmingham-machine-readable to downloads/hospital-birmingham-machine-readable
2025-04-01 19:26:38,057 - src.validators.file_validator - INFO - Invalid file extension: 
2025-04-01 19:26:38,057 - src.pipeline.orchestrator - INFO - File from https://www.nolandhealth.com/hospital-birmingham-machine-readable is not a valid price transparency file format
2025-04-01 19:26:38,057 - src.pipeline.orchestrator - INFO - Crawling https://www.nolandhealth.com/page/3/?s for NOLAND HOSPITAL BIRMINGHAM II, LLC (#3 of top 3)
2025-04-01 19:26:38,057 - src.searchers.web_crawler - INFO - Crawling URL: https://www.nolandhealth.com/page/3/?s
2025-04-01 19:26:39,714 - src.searchers.web_crawler - ERROR - Error fetching https://www.nolandhealth.com/page/3/?s with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:26:39,725 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:26:42,095 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:26:42,096 - src.pipeline.orchestrator - INFO - Found 3 potential price file links for NOLAND HOSPITAL BIRMINGHAM II, LLC
2025-04-01 19:26:42,096 - src.pipeline.orchestrator - INFO - Downloading file from https://example.com/Noland Hospital Birmingham Machine Readable Shoppable Services
2025-04-01 19:26:43,175 - src.searchers.web_crawler - ERROR - Failed to download file from https://example.com/Noland Hospital Birmingham Machine Readable Shoppable Services, status: 404
2025-04-01 19:26:43,175 - src.pipeline.orchestrator - WARNING - Failed to download file from https://example.com/Noland Hospital Birmingham Machine Readable Shoppable Services
2025-04-01 19:26:43,176 - src.pipeline.orchestrator - INFO - Downloading file from https://www.nolandhealth.com/about/price-transparency/
2025-04-01 19:26:43,286 - src.searchers.web_crawler - INFO - Downloaded file from https://www.nolandhealth.com/about/price-transparency/ to downloads/download_20250401_192643.dat
2025-04-01 19:26:43,286 - src.validators.file_validator - INFO - Invalid file extension: .dat
2025-04-01 19:26:43,286 - src.pipeline.orchestrator - INFO - File from https://www.nolandhealth.com/about/price-transparency/ is not a valid price transparency file format
2025-04-01 19:26:43,291 - scripts.custom_status_tracker - INFO - Successfully updated hospital 1221a7d6-bc43-4611-aaa4-9bf6cc3fb1db with not_found status
2025-04-01 19:26:43,292 - src.pipeline.orchestrator - INFO - Failed search for NOLAND HOSPITAL BIRMINGHAM II, LLC completed in 1.01 minutes
2025-04-01 19:26:43,292 - scripts.run_price_finder - WARNING - Price finder returned None
2025-04-01 19:26:43,294 - scripts.run_price_finder - INFO - Successfully updated database for hospital NOLAND HOSPITAL BIRMINGHAM II, LLC
2025-04-01 19:26:43,295 - scripts.run_price_finder - INFO - Successfully processed hospital NOLAND HOSPITAL BIRMINGHAM II, LLC
2025-04-01 19:26:43,295 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x114ed18b0>, 'zip_code': '35601', 'price_transparency_url': None, 'helipad': False, 'price_file_found': False, 'health_sys_id': 'sys_huntsville_hospital_health_system_huntsville_a', 'hospital_type': 'PSYCHIATRIC', 'health_sys_name': 'Huntsville Hospital Health System', 'name': 'DECATUR MORGAN WEST', 'status': 'OPEN', 'address': '2205 BELTLINE ROAD SW, PO BOX 2240', 'search_status': 'pending', 'population': 64, 'health_sys_city': 'Huntsville', 'search_attempts': 0, 'county': 'MORGAN', 'city': 'DECATUR', 'health_sys_state': 'AL', 'latitude': 34.58368232, 'last_search_date': None, 'longitude': -87.02541659, 'state': 'AL', 'corp_parent_name': 'HEALTHGROUP OF ALABAMA', 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579874), 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579874), 'id': 'c6724fd0-cd44-40a1-889f-d1fb5f0b32e9', 'website': None, 'owner': 'PROPRIETARY'}
2025-04-01 19:26:43,295 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': 'c6724fd0-cd44-40a1-889f-d1fb5f0b32e9', 'name': 'DECATUR MORGAN WEST', 'website': 'https://www.decaturmorganwest.org', 'city': 'DECATUR', 'state': 'AL', 'health_system_name': 'Huntsville Hospital Health System'}
2025-04-01 19:26:43,295 - scripts.run_price_finder - INFO - Processing hospital: DECATUR MORGAN WEST (ID: c6724fd0-cd44-40a1-889f-d1fb5f0b32e9)
2025-04-01 19:26:43,296 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='c6724fd0-cd44-40a1-889f-d1fb5f0b32e9', name='DECATUR MORGAN WEST', state='AL', city='DECATUR', address=None, website='https://www.decaturmorganwest.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:26:43,296 - src.pipeline.orchestrator - INFO - Starting price file search for DECATUR MORGAN WEST (AL)
2025-04-01 19:26:43,297 - src.pipeline.orchestrator - INFO - Searching for price transparency files for DECATUR MORGAN WEST
2025-04-01 19:26:43,297 - src.searchers.serpapi_search - INFO - Searching for: DECATUR MORGAN WEST DECATUR, AL price transparency standard charges
2025-04-01 19:26:43,298 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:26:45,326 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=DECATUR+MORGAN+WEST+DECATUR%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:26:45,328 - src.searchers.serpapi_search - INFO - Found 14 results for query: DECATUR MORGAN WEST DECATUR, AL price transparency standard charges
2025-04-01 19:26:45,328 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for DECATUR MORGAN WEST
2025-04-01 19:26:45,329 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:27:04,016 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:27:04,021 - src.pipeline.orchestrator - INFO - Crawling https://decaturmorganhospital.net/patients-visitors/price-transparency for DECATUR MORGAN WEST (#1 of top 3)
2025-04-01 19:27:04,021 - src.searchers.web_crawler - INFO - Crawling URL: https://decaturmorganhospital.net/patients-visitors/price-transparency
2025-04-01 19:27:05,822 - src.searchers.web_crawler - ERROR - Error fetching https://decaturmorganhospital.net/patients-visitors/price-transparency with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:27:05,825 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:27:05,831 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:27:11,030 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:27:11,053 - src.pipeline.orchestrator - INFO - Found 6 potential price file links for DECATUR MORGAN WEST
2025-04-01 19:27:11,053 - src.pipeline.orchestrator - INFO - Downloading file from https://www.decaturmorganhospital.com/decatur-morgan-hospital-standard-charge-file
2025-04-01 19:27:41,110 - src.searchers.web_crawler - ERROR - Error downloading file from https://www.decaturmorganhospital.com/decatur-morgan-hospital-standard-charge-file: Cannot connect to host www.decaturmorganhospital.com:443 ssl:default [nodename nor servname provided, or not known]
2025-04-01 19:27:41,112 - src.pipeline.orchestrator - WARNING - Failed to download file from https://www.decaturmorganhospital.com/decatur-morgan-hospital-standard-charge-file
2025-04-01 19:27:41,112 - src.pipeline.orchestrator - INFO - Downloading file from https://www.decaturmorganhospital.com/standard-charges
2025-04-01 19:28:11,116 - src.searchers.web_crawler - ERROR - Error downloading file from https://www.decaturmorganhospital.com/standard-charges: Cannot connect to host www.decaturmorganhospital.com:443 ssl:default [nodename nor servname provided, or not known]
2025-04-01 19:28:11,118 - src.pipeline.orchestrator - WARNING - Failed to download file from https://www.decaturmorganhospital.com/standard-charges
2025-04-01 19:28:11,118 - src.pipeline.orchestrator - INFO - Crawling https://www.huntsvillehospital.org/component/content/category/12-patients-visitors for DECATUR MORGAN WEST (#2 of top 3)
2025-04-01 19:28:11,118 - src.searchers.web_crawler - INFO - Crawling URL: https://www.huntsvillehospital.org/component/content/category/12-patients-visitors
2025-04-01 19:28:12,914 - src.searchers.web_crawler - ERROR - Error fetching https://www.huntsvillehospital.org/component/content/category/12-patients-visitors with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:28:12,929 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:28:21,274 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:28:21,279 - src.pipeline.orchestrator - INFO - Found 7 potential price file links for DECATUR MORGAN WEST
2025-04-01 19:28:21,279 - src.pipeline.orchestrator - INFO - Downloading file from https://www.huntsvillehospital.org/patients-visitors/price-transparency/decatur-morgan-hospital-west-inpatient-average-of-charges-by-drg
2025-04-01 19:28:21,523 - src.searchers.web_crawler - ERROR - Failed to download file from https://www.huntsvillehospital.org/patients-visitors/price-transparency/decatur-morgan-hospital-west-inpatient-average-of-charges-by-drg, status: 404
2025-04-01 19:28:21,524 - src.pipeline.orchestrator - WARNING - Failed to download file from https://www.huntsvillehospital.org/patients-visitors/price-transparency/decatur-morgan-hospital-west-inpatient-average-of-charges-by-drg
2025-04-01 19:28:21,524 - src.pipeline.orchestrator - INFO - Downloading file from https://www.huntsvillehospital.org/images/pricetransparency/Huntsville-Inpatient-Average-of-Charges-by-DRG.csv
2025-04-01 19:28:21,777 - src.searchers.web_crawler - INFO - Downloaded file from https://www.huntsvillehospital.org/images/pricetransparency/Huntsville-Inpatient-Average-of-Charges-by-DRG.csv to downloads/Huntsville-Inpatient-Average-of-Charges-by-DRG.csv
2025-04-01 19:28:21,781 - src.validators.file_validator - INFO - Headers don't suggest price data: ['MS-DRG Service Line', 'DRG', 'DRG Description', 'Average Case']
2025-04-01 19:28:21,781 - src.pipeline.orchestrator - INFO - File from https://www.huntsvillehospital.org/images/pricetransparency/Huntsville-Inpatient-Average-of-Charges-by-DRG.csv is not a valid price transparency file format
2025-04-01 19:28:21,781 - src.pipeline.orchestrator - INFO - Crawling https://decaturmorganhospital.net/patients-visitors/patient-cost-estimator for DECATUR MORGAN WEST (#3 of top 3)
2025-04-01 19:28:21,782 - src.searchers.web_crawler - INFO - Crawling URL: https://decaturmorganhospital.net/patients-visitors/patient-cost-estimator
2025-04-01 19:28:23,347 - src.searchers.web_crawler - ERROR - Error fetching https://decaturmorganhospital.net/patients-visitors/patient-cost-estimator with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:28:23,348 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:28:23,362 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:28:25,530 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:28:25,532 - src.pipeline.orchestrator - INFO - Found 2 potential price file links for DECATUR MORGAN WEST
2025-04-01 19:28:25,532 - src.pipeline.orchestrator - INFO - Downloading file from https://decaturmorganhospital.net/patients-visitors/price-transparency
2025-04-01 19:28:25,875 - src.searchers.web_crawler - INFO - Downloaded file from https://decaturmorganhospital.net/patients-visitors/price-transparency to downloads/price-transparency
2025-04-01 19:28:25,875 - src.validators.file_validator - INFO - Invalid file extension: 
2025-04-01 19:28:25,875 - src.pipeline.orchestrator - INFO - File from https://decaturmorganhospital.net/patients-visitors/price-transparency is not a valid price transparency file format
2025-04-01 19:28:25,875 - src.pipeline.orchestrator - INFO - Downloading file from https://decaturmorganhospital.net/patients-visitors/financial-assistance
2025-04-01 19:28:26,258 - src.searchers.web_crawler - INFO - Downloaded file from https://decaturmorganhospital.net/patients-visitors/financial-assistance to downloads/financial-assistance
2025-04-01 19:28:26,258 - src.validators.file_validator - INFO - Invalid file extension: 
2025-04-01 19:28:26,258 - src.pipeline.orchestrator - INFO - File from https://decaturmorganhospital.net/patients-visitors/financial-assistance is not a valid price transparency file format
2025-04-01 19:28:26,263 - scripts.custom_status_tracker - INFO - Successfully updated hospital c6724fd0-cd44-40a1-889f-d1fb5f0b32e9 with not_found status
2025-04-01 19:28:26,265 - src.pipeline.orchestrator - INFO - Failed search for DECATUR MORGAN WEST completed in 1.72 minutes
2025-04-01 19:28:26,265 - scripts.run_price_finder - WARNING - Price finder returned None
2025-04-01 19:28:26,269 - scripts.run_price_finder - INFO - Successfully updated database for hospital DECATUR MORGAN WEST
2025-04-01 19:28:26,269 - scripts.run_price_finder - INFO - Successfully processed hospital DECATUR MORGAN WEST
2025-04-01 19:28:26,269 - __main__ - INFO - Completed run: processed 10 hospitals, found 1 files, validated 1 files, errors: 1
2025-04-01 19:28:26,269 - __main__ - INFO - Waiting for 164 seconds until next run
2025-04-01 19:31:10,279 - __main__ - INFO - [2025-04-01 19:31:10] Running scheduled price finder with batch size 8
2025-04-01 19:31:10,346 - scripts.run_price_finder - INFO - Starting price finder integration - batch size: 8, state: None
2025-04-01 19:31:10,347 - scripts.run_price_finder - DEBUG - Config loaded: {'serpapi_key': '6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a', 'openai_key': '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', 'mistral_key': '87QKmlS8vjw0woFXpLnUKVIqLkcMa8Lz', 'llm_provider': 'mistral', 'download_dir': 'downloads'}
2025-04-01 19:31:10,377 - scripts.custom_status_tracker - INFO - Initialized MainDBStatusTracker with main application database
2025-04-01 19:31:10,378 - scripts.run_price_finder - INFO - Status tracker initialized with main application database
2025-04-01 19:31:10,378 - src.pipeline.orchestrator - INFO - Initializing pipeline components...
2025-04-01 19:31:10,378 - src.llm.link_analyzer - INFO - Initialized LLMLinkAnalyzer with provider=mistral, model=mistral-large-latest
2025-04-01 19:31:10,379 - src.llm.link_analyzer - INFO - Initialized LLMLinkAnalyzer with provider=mistral, model=mistral-large-latest
2025-04-01 19:31:10,379 - src.pipeline.orchestrator - INFO - Pipeline initialization complete
2025-04-01 19:31:10,379 - scripts.run_price_finder - INFO - PriceFinderPipeline initialized successfully with custom status tracker
2025-04-01 19:31:10,386 - scripts.run_price_finder - INFO - Found 8 hospitals to process
2025-04-01 19:31:10,387 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x115a58650>, 'zip_code': '35209', 'helipad': False, 'price_transparency_url': None, 'name': 'ENCOMPASS HEALTH LAKESHORE REHABILITATION HOSPITAL', 'hospital_type': 'REHABILITATION', 'health_sys_id': 'sys_independent', 'health_sys_name': 'Independent', 'price_file_found': False, 'address': '3800 RIDGEWAY DRIVE', 'status': 'OPEN', 'search_status': 'pending', 'population': 100, 'county': 'JEFFERSON', 'health_sys_city': None, 'search_attempts': 0, 'city': 'BIRMINGHAM', 'latitude': 33.46911585, 'health_sys_state': None, 'last_search_date': None, 'state': 'AL', 'longitude': -86.78833499, 'corp_parent_name': 'ENCOMPASS HEALTH', 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579877), 'id': '20f88691-3c6d-44e6-9988-d8ecaca5e549', 'owner': 'PROPRIETARY', 'website': None, 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579877)}
2025-04-01 19:31:10,387 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': '20f88691-3c6d-44e6-9988-d8ecaca5e549', 'name': 'ENCOMPASS HEALTH LAKESHORE REHABILITATION HOSPITAL', 'website': 'https://www.encompasshealthlakeshorerehabilitationhospital.org', 'city': 'BIRMINGHAM', 'state': 'AL', 'health_system_name': 'Independent'}
2025-04-01 19:31:10,387 - scripts.run_price_finder - INFO - Processing hospital: ENCOMPASS HEALTH LAKESHORE REHABILITATION HOSPITAL (ID: 20f88691-3c6d-44e6-9988-d8ecaca5e549)
2025-04-01 19:31:10,390 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='20f88691-3c6d-44e6-9988-d8ecaca5e549', name='ENCOMPASS HEALTH LAKESHORE REHABILITATION HOSPITAL', state='AL', city='BIRMINGHAM', address=None, website='https://www.encompasshealthlakeshorerehabilitationhospital.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:31:10,390 - src.pipeline.orchestrator - INFO - Starting price file search for ENCOMPASS HEALTH LAKESHORE REHABILITATION HOSPITAL (AL)
2025-04-01 19:31:10,394 - src.pipeline.orchestrator - INFO - Searching for price transparency files for ENCOMPASS HEALTH LAKESHORE REHABILITATION HOSPITAL
2025-04-01 19:31:10,394 - src.searchers.serpapi_search - INFO - Searching for: ENCOMPASS HEALTH LAKESHORE REHABILITATION HOSPITAL BIRMINGHAM, AL price transparency standard charges
2025-04-01 19:31:10,397 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:31:12,902 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=ENCOMPASS+HEALTH+LAKESHORE+REHABILITATION+HOSPITAL+BIRMINGHAM%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:31:12,905 - src.searchers.serpapi_search - INFO - Found 14 results for query: ENCOMPASS HEALTH LAKESHORE REHABILITATION HOSPITAL BIRMINGHAM, AL price transparency standard charges
2025-04-01 19:31:12,905 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for ENCOMPASS HEALTH LAKESHORE REHABILITATION HOSPITAL
2025-04-01 19:31:12,912 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:31:30,752 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:31:30,770 - src.pipeline.orchestrator - INFO - Crawling https://encompasshealth.com/locations/lakeshorerehab/transparency-healthcare for ENCOMPASS HEALTH LAKESHORE REHABILITATION HOSPITAL (#1 of top 3)
2025-04-01 19:31:30,770 - src.searchers.web_crawler - INFO - Crawling URL: https://encompasshealth.com/locations/lakeshorerehab/transparency-healthcare
2025-04-01 19:31:32,540 - src.searchers.web_crawler - ERROR - Error fetching https://encompasshealth.com/locations/lakeshorerehab/transparency-healthcare with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:31:32,548 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:31:35,986 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:31:35,989 - src.pipeline.orchestrator - INFO - Found 4 potential price file links for ENCOMPASS HEALTH LAKESHORE REHABILITATION HOSPITAL
2025-04-01 19:31:35,989 - src.pipeline.orchestrator - INFO - Downloading file from https://encompasshealth.com/-/media/healthsouth/project/healthsouth/files/1-price-transparency/62-1178229_encompass-health-lakeshore-rehabilitation-hospital_standardcharges.csv
2025-04-01 19:31:36,579 - src.searchers.web_crawler - INFO - Downloaded file from https://encompasshealth.com/-/media/healthsouth/project/healthsouth/files/1-price-transparency/62-1178229_encompass-health-lakeshore-rehabilitation-hospital_standardcharges.csv to downloads/62-1178229_Encompass Health Lakeshore Rehabilitation Hospital_standardcharges.csv
2025-04-01 19:31:36,583 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:31:39,895 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:31:39,897 - src.pipeline.orchestrator - INFO - Found valid price file for ENCOMPASS HEALTH LAKESHORE REHABILITATION HOSPITAL: https://encompasshealth.com/-/media/healthsouth/project/healthsouth/files/1-price-transparency/62-1178229_encompass-health-lakeshore-rehabilitation-hospital_standardcharges.csv, confidence: 1.0
2025-04-01 19:31:39,903 - scripts.custom_status_tracker - INFO - Successfully updated hospital 20f88691-3c6d-44e6-9988-d8ecaca5e549 status
2025-04-01 19:31:39,904 - scripts.custom_status_tracker - ERROR - Error updating price file for hospital 20f88691-3c6d-44e6-9988-d8ecaca5e549: 'validation_score' is an invalid keyword argument for HospitalPriceFile
2025-04-01 19:31:39,904 - src.pipeline.orchestrator - INFO - Successful search for ENCOMPASS HEALTH LAKESHORE REHABILITATION HOSPITAL completed in 29.51 seconds
2025-04-01 19:31:39,904 - scripts.run_price_finder - INFO - Price finder result: {'hospital_id': '20f88691-3c6d-44e6-9988-d8ecaca5e549', 'url': 'https://encompasshealth.com/-/media/healthsouth/project/healthsouth/files/1-price-transparency/62-1178229_encompass-health-lakeshore-rehabilitation-hospital_standardcharges.csv', 'file_type': 'csv', 'validated': True, 'validation_date': None, 'validation_score': 0.95, 'validation_notes': "The file contains detailed service descriptions, procedure codes, and various pricing information including gross charges, discounted cash prices, and payer-specific negotiated charges. The hospital name 'Encompass Health Lakeshore Rehabilitation Hospital' is clearly mentioned, matching the specified hospital. The data includes different payer rates, min/max prices, and methodologies, which are all indicative of a valid hospital price transparency file.", 'file_size': 11911192, 'last_modified': None, 'download_date': None, 'contains_prices': True, 'contains_hospital_name': True, 'coverage_period': None, 'processed': False, 'processing_date': None, 'processing_errors': []}
2025-04-01 19:31:39,905 - scripts.run_price_finder - ERROR - Error processing hospital 20f88691-3c6d-44e6-9988-d8ecaca5e549: 'validation_score' is an invalid keyword argument for HospitalPriceFile
2025-04-01 19:31:39,906 - scripts.run_price_finder - ERROR - Traceback (most recent call last):
  File "/Users/bentenner/OmegaReal/backend/scripts/run_price_finder.py", line 228, in update_database_from_price_finder
    price_file = HospitalPriceFile(
                 ^^^^^^^^^^^^^^^^^^
  File "<string>", line 4, in __init__
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/sqlalchemy/orm/state.py", line 571, in _initialize_instance
    with util.safe_reraise():
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/sqlalchemy/orm/state.py", line 569, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/sqlalchemy/orm/decl_base.py", line 2175, in _declarative_constructor
    raise TypeError(
TypeError: 'validation_score' is an invalid keyword argument for HospitalPriceFile

2025-04-01 19:31:39,909 - scripts.run_price_finder - INFO - Successfully processed hospital ENCOMPASS HEALTH LAKESHORE REHABILITATION HOSPITAL
2025-04-01 19:31:39,910 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x115a59df0>, 'zip_code': '36301', 'price_transparency_url': None, 'helipad': True, 'price_file_found': False, 'health_sys_id': 'sys_independent', 'hospital_type': 'REHABILITATION', 'health_sys_name': 'Independent', 'name': 'ENCOMPASS HEALTH REHABILITATION HOSPITAL OF DOTHAN', 'status': 'OPEN', 'address': '1736 EAST MAIN STREET', 'search_status': 'pending', 'population': 51, 'health_sys_city': None, 'search_attempts': 0, 'county': 'HOUSTON', 'city': 'DOTHAN', 'health_sys_state': None, 'latitude': 31.2179119100001, 'last_search_date': None, 'longitude': -85.3658126299999, 'state': 'AL', 'corp_parent_name': 'ENCOMPASS HEALTH', 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579877), 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579877), 'id': '487f0a56-7f78-4e9e-b27d-63df1dcddcde', 'website': None, 'owner': 'PROPRIETARY'}
2025-04-01 19:31:39,910 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': '487f0a56-7f78-4e9e-b27d-63df1dcddcde', 'name': 'ENCOMPASS HEALTH REHABILITATION HOSPITAL OF DOTHAN', 'website': 'https://www.encompasshealthrehabilitationhospitalofdothan.org', 'city': 'DOTHAN', 'state': 'AL', 'health_system_name': 'Independent'}
2025-04-01 19:31:39,910 - scripts.run_price_finder - INFO - Processing hospital: ENCOMPASS HEALTH REHABILITATION HOSPITAL OF DOTHAN (ID: 487f0a56-7f78-4e9e-b27d-63df1dcddcde)
2025-04-01 19:31:39,911 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='487f0a56-7f78-4e9e-b27d-63df1dcddcde', name='ENCOMPASS HEALTH REHABILITATION HOSPITAL OF DOTHAN', state='AL', city='DOTHAN', address=None, website='https://www.encompasshealthrehabilitationhospitalofdothan.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:31:39,911 - src.pipeline.orchestrator - INFO - Starting price file search for ENCOMPASS HEALTH REHABILITATION HOSPITAL OF DOTHAN (AL)
2025-04-01 19:31:39,913 - src.pipeline.orchestrator - INFO - Searching for price transparency files for ENCOMPASS HEALTH REHABILITATION HOSPITAL OF DOTHAN
2025-04-01 19:31:39,913 - src.searchers.serpapi_search - INFO - Searching for: ENCOMPASS HEALTH REHABILITATION HOSPITAL OF DOTHAN DOTHAN, AL price transparency standard charges
2025-04-01 19:31:39,914 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:31:41,984 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=ENCOMPASS+HEALTH+REHABILITATION+HOSPITAL+OF+DOTHAN+DOTHAN%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:31:41,987 - src.searchers.serpapi_search - INFO - Found 13 results for query: ENCOMPASS HEALTH REHABILITATION HOSPITAL OF DOTHAN DOTHAN, AL price transparency standard charges
2025-04-01 19:31:41,987 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for ENCOMPASS HEALTH REHABILITATION HOSPITAL OF DOTHAN
2025-04-01 19:31:41,994 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:32:05,064 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:32:05,069 - src.pipeline.orchestrator - INFO - Crawling https://turquoise.health/health_systems/encompass-health/ for ENCOMPASS HEALTH REHABILITATION HOSPITAL OF DOTHAN (#1 of top 3)
2025-04-01 19:32:05,070 - src.searchers.web_crawler - INFO - Crawling URL: https://turquoise.health/health_systems/encompass-health/
2025-04-01 19:32:08,545 - src.searchers.web_crawler - ERROR - Error fetching https://turquoise.health/health_systems/encompass-health/ with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:32:08,548 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:32:08,564 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:32:10,449 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:32:10,450 - src.pipeline.orchestrator - INFO - Found 0 potential price file links for ENCOMPASS HEALTH REHABILITATION HOSPITAL OF DOTHAN
2025-04-01 19:32:10,450 - src.pipeline.orchestrator - INFO - Crawling https://encompasshealth.com/locations/dothanrehab/transparency-healthcare for ENCOMPASS HEALTH REHABILITATION HOSPITAL OF DOTHAN (#2 of top 3)
2025-04-01 19:32:10,450 - src.searchers.web_crawler - INFO - Crawling URL: https://encompasshealth.com/locations/dothanrehab/transparency-healthcare
2025-04-01 19:32:11,016 - src.searchers.web_crawler - ERROR - Error fetching https://encompasshealth.com/locations/dothanrehab/transparency-healthcare with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:32:11,025 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:32:16,101 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:32:16,104 - src.pipeline.orchestrator - INFO - Found 5 potential price file links for ENCOMPASS HEALTH REHABILITATION HOSPITAL OF DOTHAN
2025-04-01 19:32:16,104 - src.pipeline.orchestrator - INFO - Downloading file from https://example.com/csv
2025-04-01 19:32:16,472 - src.searchers.web_crawler - ERROR - Failed to download file from https://example.com/csv, status: 404
2025-04-01 19:32:16,472 - src.pipeline.orchestrator - WARNING - Failed to download file from https://example.com/csv
2025-04-01 19:32:16,472 - src.pipeline.orchestrator - INFO - Downloading file from https://encompasshealth.com/-/media/healthsouth/project/healthsouth/files/1-price-transparency/63-1097851_encompass-health-rehabilitation-hospital-of-dothan_shoppableservices.csv
2025-04-01 19:32:16,636 - src.searchers.web_crawler - INFO - Downloaded file from https://encompasshealth.com/-/media/healthsouth/project/healthsouth/files/1-price-transparency/63-1097851_encompass-health-rehabilitation-hospital-of-dothan_shoppableservices.csv to downloads/63-1097851_Encompass Health Rehabilitation Hospital of Dothan_shoppableservices.csv
2025-04-01 19:32:16,636 - src.validators.file_validator - INFO - Headers don't suggest price data: ['Encompass Health Rehabilitation Hospital of Dothan', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '']
2025-04-01 19:32:16,636 - src.pipeline.orchestrator - INFO - File from https://encompasshealth.com/-/media/healthsouth/project/healthsouth/files/1-price-transparency/63-1097851_encompass-health-rehabilitation-hospital-of-dothan_shoppableservices.csv is not a valid price transparency file format
2025-04-01 19:32:16,636 - src.pipeline.orchestrator - INFO - Crawling https://encompasshealth.com/locations/dothanrehab for ENCOMPASS HEALTH REHABILITATION HOSPITAL OF DOTHAN (#3 of top 3)
2025-04-01 19:32:16,636 - src.searchers.web_crawler - INFO - Crawling URL: https://encompasshealth.com/locations/dothanrehab
2025-04-01 19:32:17,219 - src.searchers.web_crawler - ERROR - Error fetching https://encompasshealth.com/locations/dothanrehab with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:32:17,235 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:32:19,155 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:32:19,156 - src.pipeline.orchestrator - INFO - Found 1 potential price file links for ENCOMPASS HEALTH REHABILITATION HOSPITAL OF DOTHAN
2025-04-01 19:32:19,156 - src.pipeline.orchestrator - INFO - Downloading file from https://encompasshealth.com/locations/dothanrehab/financial-assistance
2025-04-01 19:32:19,345 - src.searchers.web_crawler - INFO - Downloaded file from https://encompasshealth.com/locations/dothanrehab/financial-assistance to downloads/financial-assistance
2025-04-01 19:32:19,345 - src.validators.file_validator - INFO - Invalid file extension: 
2025-04-01 19:32:19,345 - src.pipeline.orchestrator - INFO - File from https://encompasshealth.com/locations/dothanrehab/financial-assistance is not a valid price transparency file format
2025-04-01 19:32:19,350 - scripts.custom_status_tracker - INFO - Successfully updated hospital 487f0a56-7f78-4e9e-b27d-63df1dcddcde with not_found status
2025-04-01 19:32:19,351 - src.pipeline.orchestrator - INFO - Failed search for ENCOMPASS HEALTH REHABILITATION HOSPITAL OF DOTHAN completed in 39.44 seconds
2025-04-01 19:32:19,351 - scripts.run_price_finder - WARNING - Price finder returned None
2025-04-01 19:32:19,353 - scripts.run_price_finder - INFO - Successfully updated database for hospital ENCOMPASS HEALTH REHABILITATION HOSPITAL OF DOTHAN
2025-04-01 19:32:19,353 - scripts.run_price_finder - INFO - Successfully processed hospital ENCOMPASS HEALTH REHABILITATION HOSPITAL OF DOTHAN
2025-04-01 19:32:19,354 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x115a59190>, 'zip_code': '36092', 'price_transparency_url': None, 'helipad': True, 'price_file_found': False, 'health_sys_id': 'sys_independent', 'hospital_type': 'GENERAL ACUTE CARE', 'health_sys_name': 'Independent', 'name': 'ELMORE COMMUNITY HOSPITAL', 'status': 'OPEN', 'address': '500 HOSPITAL DRIVE, PO BOX 130', 'search_status': 'pending', 'population': 69, 'health_sys_city': None, 'search_attempts': 0, 'county': 'ELMORE', 'city': 'WETUMPKA', 'health_sys_state': None, 'latitude': 32.5522669700001, 'last_search_date': None, 'longitude': -86.18639645, 'state': 'AL', 'corp_parent_name': 'IVY CREEK HEALTHCARE', 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579876), 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579877), 'id': '7054a6d7-5c7e-4fdd-816b-4f1015f526ba', 'website': None, 'owner': 'PROPRIETARY'}
2025-04-01 19:32:19,354 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': '7054a6d7-5c7e-4fdd-816b-4f1015f526ba', 'name': 'ELMORE COMMUNITY HOSPITAL', 'website': 'https://www.elmorecommunityhospital.org', 'city': 'WETUMPKA', 'state': 'AL', 'health_system_name': 'Independent'}
2025-04-01 19:32:19,354 - scripts.run_price_finder - INFO - Processing hospital: ELMORE COMMUNITY HOSPITAL (ID: 7054a6d7-5c7e-4fdd-816b-4f1015f526ba)
2025-04-01 19:32:19,354 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='7054a6d7-5c7e-4fdd-816b-4f1015f526ba', name='ELMORE COMMUNITY HOSPITAL', state='AL', city='WETUMPKA', address=None, website='https://www.elmorecommunityhospital.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:32:19,355 - src.pipeline.orchestrator - INFO - Starting price file search for ELMORE COMMUNITY HOSPITAL (AL)
2025-04-01 19:32:19,357 - src.pipeline.orchestrator - INFO - Searching for price transparency files for ELMORE COMMUNITY HOSPITAL
2025-04-01 19:32:19,357 - src.searchers.serpapi_search - INFO - Searching for: ELMORE COMMUNITY HOSPITAL WETUMPKA, AL price transparency standard charges
2025-04-01 19:32:19,358 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:32:21,430 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=ELMORE+COMMUNITY+HOSPITAL+WETUMPKA%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:32:21,447 - src.searchers.serpapi_search - INFO - Found 14 results for query: ELMORE COMMUNITY HOSPITAL WETUMPKA, AL price transparency standard charges
2025-04-01 19:32:21,447 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for ELMORE COMMUNITY HOSPITAL
2025-04-01 19:32:21,447 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:32:40,793 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:32:40,799 - src.pipeline.orchestrator - INFO - Crawling https://ivycreekhealth.com/price-transparency/ for ELMORE COMMUNITY HOSPITAL (#1 of top 3)
2025-04-01 19:32:40,799 - src.searchers.web_crawler - INFO - Crawling URL: https://ivycreekhealth.com/price-transparency/
2025-04-01 19:32:44,801 - src.searchers.web_crawler - ERROR - Error fetching https://ivycreekhealth.com/price-transparency/ with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:32:44,804 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:32:44,827 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:32:48,129 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:32:48,131 - src.pipeline.orchestrator - INFO - Found 4 potential price file links for ELMORE COMMUNITY HOSPITAL
2025-04-01 19:32:48,131 - src.pipeline.orchestrator - INFO - Downloading file from https://ivycreekhealth.com/wp-content/uploads/2025/01/631282722_lake-martin-community-hospital_standardcharges.csv
2025-04-01 19:32:48,421 - src.searchers.web_crawler - INFO - Downloaded file from https://ivycreekhealth.com/wp-content/uploads/2025/01/631282722_lake-martin-community-hospital_standardcharges.csv to downloads/631282722_lake-martin-community-hospital_standardcharges.csv
2025-04-01 19:32:48,422 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:32:52,026 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:32:52,027 - src.pipeline.orchestrator - INFO - File from https://ivycreekhealth.com/wp-content/uploads/2025/01/631282722_lake-martin-community-hospital_standardcharges.csv is not a match for ELMORE COMMUNITY HOSPITAL: Rule-based: Found location matches: state: AL, but no hospital name match. LLM: File contains CPT codes with corresponding prices and detailed payer-specific pricing. However, the hospital name mentioned is 'Lake Martin Community Hospital,' not 'ELMORE COMMUNITY HOSPITAL'. Additionally, the location is listed as Dadeville, AL, not Wetumpka, AL. Therefore, it does not belong to the specified hospital.
2025-04-01 19:32:52,027 - src.pipeline.orchestrator - INFO - Downloading file from https://ivycreekhealth.com/price-transparency/#content
2025-04-01 19:32:52,157 - src.searchers.web_crawler - INFO - Downloaded file from https://ivycreekhealth.com/price-transparency/#content to downloads/download_20250401_193252.dat
2025-04-01 19:32:52,157 - src.validators.file_validator - INFO - Invalid file extension: .dat
2025-04-01 19:32:52,157 - src.pipeline.orchestrator - INFO - File from https://ivycreekhealth.com/price-transparency/#content is not a valid price transparency file format
2025-04-01 19:32:52,157 - src.pipeline.orchestrator - INFO - Crawling https://ivycreekhealth.com/locations/elmore-community-hospital/ for ELMORE COMMUNITY HOSPITAL (#2 of top 3)
2025-04-01 19:32:52,157 - src.searchers.web_crawler - INFO - Crawling URL: https://ivycreekhealth.com/locations/elmore-community-hospital/
2025-04-01 19:32:52,730 - src.searchers.web_crawler - ERROR - Error fetching https://ivycreekhealth.com/locations/elmore-community-hospital/ with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:32:52,793 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:32:56,030 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:32:56,032 - src.pipeline.orchestrator - INFO - Found 3 potential price file links for ELMORE COMMUNITY HOSPITAL
2025-04-01 19:32:56,032 - src.pipeline.orchestrator - INFO - Downloading file from https://ivycreekhealthcare.com/price-transparency/
2025-04-01 19:33:26,040 - src.searchers.web_crawler - ERROR - Error downloading file from https://ivycreekhealthcare.com/price-transparency/: Cannot connect to host ivycreekhealthcare.com:443 ssl:default [nodename nor servname provided, or not known]
2025-04-01 19:33:26,045 - src.pipeline.orchestrator - WARNING - Failed to download file from https://ivycreekhealthcare.com/price-transparency/
2025-04-01 19:33:26,045 - src.pipeline.orchestrator - INFO - Downloading file from https://ivycreekhealthcare.com/bill-pay/
2025-04-01 19:33:56,056 - src.searchers.web_crawler - ERROR - Error downloading file from https://ivycreekhealthcare.com/bill-pay/: Cannot connect to host ivycreekhealthcare.com:443 ssl:default [nodename nor servname provided, or not known]
2025-04-01 19:33:56,057 - src.pipeline.orchestrator - WARNING - Failed to download file from https://ivycreekhealthcare.com/bill-pay/
2025-04-01 19:33:56,057 - src.pipeline.orchestrator - INFO - Crawling https://hospitalpricingspecialists.com/national-hospital-price-list-of-cpt-45380-colon-examination-and-biopsy-with-endoscope/ for ELMORE COMMUNITY HOSPITAL (#3 of top 3)
2025-04-01 19:33:56,057 - src.searchers.web_crawler - INFO - Crawling URL: https://hospitalpricingspecialists.com/national-hospital-price-list-of-cpt-45380-colon-examination-and-biopsy-with-endoscope/
2025-04-01 19:33:58,944 - src.searchers.web_crawler - ERROR - Error fetching https://hospitalpricingspecialists.com/national-hospital-price-list-of-cpt-45380-colon-examination-and-biopsy-with-endoscope/ with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:33:59,028 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:33:59,028 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:33:59,029 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:33:59,029 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:33:59,029 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:33:59,029 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:33:59,029 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:33:59,029 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:33:59,079 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:34:02,410 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:34:02,412 - src.pipeline.orchestrator - INFO - Found 1 potential price file links for ELMORE COMMUNITY HOSPITAL
2025-04-01 19:34:02,412 - src.pipeline.orchestrator - INFO - Downloading file from https://hospitalpricingspecialists.com/navigating-the-complexity-of-cms-price-transparency-audits-whats-next/
2025-04-01 19:34:02,785 - src.searchers.web_crawler - INFO - Downloaded file from https://hospitalpricingspecialists.com/navigating-the-complexity-of-cms-price-transparency-audits-whats-next/ to downloads/download_20250401_193402.dat
2025-04-01 19:34:02,786 - src.validators.file_validator - INFO - Invalid file extension: .dat
2025-04-01 19:34:02,786 - src.pipeline.orchestrator - INFO - File from https://hospitalpricingspecialists.com/navigating-the-complexity-of-cms-price-transparency-audits-whats-next/ is not a valid price transparency file format
2025-04-01 19:34:02,789 - scripts.custom_status_tracker - INFO - Successfully updated hospital 7054a6d7-5c7e-4fdd-816b-4f1015f526ba with not_found status
2025-04-01 19:34:02,790 - src.pipeline.orchestrator - INFO - Failed search for ELMORE COMMUNITY HOSPITAL completed in 1.72 minutes
2025-04-01 19:34:02,790 - scripts.run_price_finder - WARNING - Price finder returned None
2025-04-01 19:34:02,793 - scripts.run_price_finder - INFO - Successfully updated database for hospital ELMORE COMMUNITY HOSPITAL
2025-04-01 19:34:02,793 - scripts.run_price_finder - INFO - Successfully processed hospital ELMORE COMMUNITY HOSPITAL
2025-04-01 19:34:02,794 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x115a5a330>, 'zip_code': '36854', 'price_transparency_url': None, 'helipad': True, 'price_file_found': False, 'health_sys_id': 'sys_east_alabama_medical_center_opelika_al', 'hospital_type': 'GENERAL ACUTE CARE', 'health_sys_name': 'East Alabama Medical Center', 'name': 'EAMC - LANIER', 'status': 'OPEN', 'address': '4800 48TH STREET', 'search_status': 'pending', 'population': 115, 'health_sys_city': 'Opelika', 'search_attempts': 0, 'county': 'CHAMBERS', 'city': 'VALLEY', 'health_sys_state': 'AL', 'latitude': 32.8245981100001, 'last_search_date': None, 'longitude': -85.16870267, 'state': 'AL', 'corp_parent_name': 'EAST ALABAMA MEDICAL CENTER', 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579875), 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579875), 'id': 'b4a151b3-89d1-4847-8245-b72c6a3d2d8b', 'website': None, 'owner': 'GOVERNMENT - DISTRICT/AUTHORITY'}
2025-04-01 19:34:02,794 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': 'b4a151b3-89d1-4847-8245-b72c6a3d2d8b', 'name': 'EAMC - LANIER', 'website': 'https://www.eamc-lanier.org', 'city': 'VALLEY', 'state': 'AL', 'health_system_name': 'East Alabama Medical Center'}
2025-04-01 19:34:02,794 - scripts.run_price_finder - INFO - Processing hospital: EAMC - LANIER (ID: b4a151b3-89d1-4847-8245-b72c6a3d2d8b)
2025-04-01 19:34:02,795 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='b4a151b3-89d1-4847-8245-b72c6a3d2d8b', name='EAMC - LANIER', state='AL', city='VALLEY', address=None, website='https://www.eamc-lanier.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:34:02,795 - src.pipeline.orchestrator - INFO - Starting price file search for EAMC - LANIER (AL)
2025-04-01 19:34:02,796 - src.pipeline.orchestrator - INFO - Searching for price transparency files for EAMC - LANIER
2025-04-01 19:34:02,796 - src.searchers.serpapi_search - INFO - Searching for: EAMC - LANIER VALLEY, AL price transparency standard charges
2025-04-01 19:34:02,797 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:34:04,044 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=EAMC+-+LANIER+VALLEY%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:34:04,045 - src.searchers.serpapi_search - INFO - Found 12 results for query: EAMC - LANIER VALLEY, AL price transparency standard charges
2025-04-01 19:34:04,045 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for EAMC - LANIER
2025-04-01 19:34:04,046 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:34:26,337 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:34:26,342 - src.pipeline.orchestrator - INFO - Crawling https://www.eastalabamahealth.org/patient-and-guests/billing-and-financial-information/estimate-my-cost for EAMC - LANIER (#1 of top 3)
2025-04-01 19:34:26,342 - src.searchers.web_crawler - INFO - Crawling URL: https://www.eastalabamahealth.org/patient-and-guests/billing-and-financial-information/estimate-my-cost
2025-04-01 19:34:28,363 - src.searchers.web_crawler - ERROR - Error fetching https://www.eastalabamahealth.org/patient-and-guests/billing-and-financial-information/estimate-my-cost with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:34:28,372 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:34:31,583 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:34:31,634 - src.pipeline.orchestrator - INFO - Found 2 potential price file links for EAMC - LANIER
2025-04-01 19:34:31,644 - src.pipeline.orchestrator - INFO - Downloading file from https://www.eastalabamahealth.org/sites/default/files/financial-service/636000526_EastAlabama_standardcharges.csv
2025-04-01 19:34:34,386 - src.searchers.web_crawler - INFO - Downloaded file from https://www.eastalabamahealth.org/sites/default/files/financial-service/636000526_EastAlabama_standardcharges.csv to downloads/636000526_EastAlabama_standardcharges.csv
2025-04-01 19:34:34,392 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:34:38,519 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:34:38,520 - src.pipeline.orchestrator - INFO - File from https://www.eastalabamahealth.org/sites/default/files/financial-service/636000526_EastAlabama_standardcharges.csv is not a match for EAMC - LANIER: Rule-based: Found location matches: state: AL, but no hospital name match. LLM: The file contains detailed pricing information with CPT codes, descriptions, and various payer rates, which is indicative of hospital price transparency data. However, the hospital name mentioned is 'East Alabama Medical Center' located in Opelika, AL, not 'EAMC - LANIER' in Valley, AL. Therefore, it does not belong to the specified hospital.
2025-04-01 19:34:38,520 - src.pipeline.orchestrator - INFO - Downloading file from https://www.eastalabamahealth.org/patient-and-guests/billing-and-financial-information/estimate-my-cost
2025-04-01 19:34:39,072 - src.searchers.web_crawler - INFO - Downloaded file from https://www.eastalabamahealth.org/patient-and-guests/billing-and-financial-information/estimate-my-cost to downloads/estimate-my-cost
2025-04-01 19:34:39,073 - src.validators.file_validator - INFO - Invalid file extension: 
2025-04-01 19:34:39,073 - src.pipeline.orchestrator - INFO - File from https://www.eastalabamahealth.org/patient-and-guests/billing-and-financial-information/estimate-my-cost is not a valid price transparency file format
2025-04-01 19:34:39,073 - src.pipeline.orchestrator - INFO - Crawling https://turquoise.health/providers/eamc-lanier for EAMC - LANIER (#2 of top 3)
2025-04-01 19:34:39,073 - src.searchers.web_crawler - INFO - Crawling URL: https://turquoise.health/providers/eamc-lanier
2025-04-01 19:34:40,147 - src.searchers.web_crawler - ERROR - Error fetching https://turquoise.health/providers/eamc-lanier with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:34:40,153 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:34:40,167 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:34:42,326 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:34:42,327 - src.pipeline.orchestrator - INFO - Found 0 potential price file links for EAMC - LANIER
2025-04-01 19:34:42,328 - src.pipeline.orchestrator - INFO - Crawling https://www.eastalabamahealth.org/auburnasc/billing-and-financial-information for EAMC - LANIER (#3 of top 3)
2025-04-01 19:34:42,328 - src.searchers.web_crawler - INFO - Crawling URL: https://www.eastalabamahealth.org/auburnasc/billing-and-financial-information
2025-04-01 19:34:43,433 - src.searchers.web_crawler - ERROR - Error fetching https://www.eastalabamahealth.org/auburnasc/billing-and-financial-information with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:34:43,439 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:34:52,452 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:34:52,455 - src.pipeline.orchestrator - INFO - Found 1 potential price file links for EAMC - LANIER
2025-04-01 19:34:52,456 - src.pipeline.orchestrator - INFO - Downloading file from https://www.eastalabamahealth.org/auburnasc/billing-and-financial-information
2025-04-01 19:34:52,861 - src.searchers.web_crawler - INFO - Downloaded file from https://www.eastalabamahealth.org/auburnasc/billing-and-financial-information to downloads/billing-and-financial-information
2025-04-01 19:34:52,862 - src.validators.file_validator - INFO - Invalid file extension: 
2025-04-01 19:34:52,862 - src.pipeline.orchestrator - INFO - File from https://www.eastalabamahealth.org/auburnasc/billing-and-financial-information is not a valid price transparency file format
2025-04-01 19:34:52,866 - scripts.custom_status_tracker - INFO - Successfully updated hospital b4a151b3-89d1-4847-8245-b72c6a3d2d8b with not_found status
2025-04-01 19:34:52,867 - src.pipeline.orchestrator - INFO - Failed search for EAMC - LANIER completed in 50.07 seconds
2025-04-01 19:34:52,867 - scripts.run_price_finder - WARNING - Price finder returned None
2025-04-01 19:34:52,870 - scripts.run_price_finder - INFO - Successfully updated database for hospital EAMC - LANIER
2025-04-01 19:34:52,870 - scripts.run_price_finder - INFO - Successfully processed hospital EAMC - LANIER
2025-04-01 19:34:52,870 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x114e6ca70>, 'zip_code': '36526', 'price_transparency_url': None, 'helipad': False, 'price_file_found': False, 'health_sys_id': 'sys_independent', 'hospital_type': 'PSYCHIATRIC', 'health_sys_name': 'Independent', 'name': 'EASTPOINTE HOSPITAL', 'status': 'OPEN', 'address': '7400 ROPER LANE', 'search_status': 'pending', 'population': 66, 'health_sys_city': None, 'search_attempts': 0, 'county': 'BALDWIN', 'city': 'DAPHNE', 'health_sys_state': None, 'latitude': 30.6352891500001, 'last_search_date': None, 'longitude': -87.8951390999999, 'state': 'AL', 'corp_parent_name': 'ALTAPOINTE HEALTH SYSTEMS INC', 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579876), 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579876), 'id': '85a87fb9-3053-440d-9608-acbc7bf7fb97', 'website': None, 'owner': 'PROPRIETARY'}
2025-04-01 19:34:52,870 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': '85a87fb9-3053-440d-9608-acbc7bf7fb97', 'name': 'EASTPOINTE HOSPITAL', 'website': 'https://www.eastpointehospital.org', 'city': 'DAPHNE', 'state': 'AL', 'health_system_name': 'Independent'}
2025-04-01 19:34:52,870 - scripts.run_price_finder - INFO - Processing hospital: EASTPOINTE HOSPITAL (ID: 85a87fb9-3053-440d-9608-acbc7bf7fb97)
2025-04-01 19:34:52,871 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='85a87fb9-3053-440d-9608-acbc7bf7fb97', name='EASTPOINTE HOSPITAL', state='AL', city='DAPHNE', address=None, website='https://www.eastpointehospital.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:34:52,871 - src.pipeline.orchestrator - INFO - Starting price file search for EASTPOINTE HOSPITAL (AL)
2025-04-01 19:34:52,875 - src.pipeline.orchestrator - INFO - Searching for price transparency files for EASTPOINTE HOSPITAL
2025-04-01 19:34:52,875 - src.searchers.serpapi_search - INFO - Searching for: EASTPOINTE HOSPITAL DAPHNE, AL price transparency standard charges
2025-04-01 19:34:52,876 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:34:54,599 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=EASTPOINTE+HOSPITAL+DAPHNE%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:34:54,600 - src.searchers.serpapi_search - INFO - Found 12 results for query: EASTPOINTE HOSPITAL DAPHNE, AL price transparency standard charges
2025-04-01 19:34:54,600 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for EASTPOINTE HOSPITAL
2025-04-01 19:34:54,601 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:35:15,592 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:35:15,595 - src.pipeline.orchestrator - INFO - Crawling https://altapointe.org/resources/patient-pricing-2/ for EASTPOINTE HOSPITAL (#1 of top 3)
2025-04-01 19:35:15,595 - src.searchers.web_crawler - INFO - Crawling URL: https://altapointe.org/resources/patient-pricing-2/
2025-04-01 19:35:18,498 - src.searchers.web_crawler - ERROR - Error fetching https://altapointe.org/resources/patient-pricing-2/ with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:35:18,500 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:35:18,509 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:35:23,345 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:35:23,346 - src.pipeline.orchestrator - INFO - Found 6 potential price file links for EASTPOINTE HOSPITAL
2025-04-01 19:35:23,346 - src.pipeline.orchestrator - INFO - Downloading file from https://www.altapointe.org/hospital-charges-document-download
2025-04-01 19:35:24,214 - src.searchers.web_crawler - ERROR - Failed to download file from https://www.altapointe.org/hospital-charges-document-download, status: 404
2025-04-01 19:35:24,214 - src.pipeline.orchestrator - WARNING - Failed to download file from https://www.altapointe.org/hospital-charges-document-download
2025-04-01 19:35:24,214 - src.pipeline.orchestrator - INFO - Downloading file from https://www.altapointe.org/patient-pricing
2025-04-01 19:35:24,672 - src.searchers.web_crawler - INFO - Downloaded file from https://www.altapointe.org/patient-pricing to downloads/patient-pricing
2025-04-01 19:35:24,672 - src.validators.file_validator - INFO - Invalid file extension: 
2025-04-01 19:35:24,672 - src.pipeline.orchestrator - INFO - File from https://www.altapointe.org/patient-pricing is not a valid price transparency file format
2025-04-01 19:35:24,672 - src.pipeline.orchestrator - INFO - Crawling https://altapointe.org/eastpointe-patient-family-visitor-information/ for EASTPOINTE HOSPITAL (#2 of top 3)
2025-04-01 19:35:24,672 - src.searchers.web_crawler - INFO - Crawling URL: https://altapointe.org/eastpointe-patient-family-visitor-information/
2025-04-01 19:35:25,269 - src.searchers.web_crawler - ERROR - Error fetching https://altapointe.org/eastpointe-patient-family-visitor-information/ with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:35:25,276 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:35:27,647 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:35:27,648 - src.pipeline.orchestrator - INFO - Found 3 potential price file links for EASTPOINTE HOSPITAL
2025-04-01 19:35:27,649 - src.pipeline.orchestrator - INFO - Downloading file from https://www.altapointe.org/patient-pricing
2025-04-01 19:35:28,017 - src.searchers.web_crawler - INFO - Downloaded file from https://www.altapointe.org/patient-pricing to downloads/patient-pricing
2025-04-01 19:35:28,017 - src.validators.file_validator - INFO - Invalid file extension: 
2025-04-01 19:35:28,017 - src.pipeline.orchestrator - INFO - File from https://www.altapointe.org/patient-pricing is not a valid price transparency file format
2025-04-01 19:35:28,017 - src.pipeline.orchestrator - INFO - Downloading file from https://altapointe.org/cms-price-transparency/
2025-04-01 19:35:28,140 - src.searchers.web_crawler - INFO - Downloaded file from https://altapointe.org/cms-price-transparency/ to downloads/download_20250401_193528.dat
2025-04-01 19:35:28,140 - src.validators.file_validator - INFO - Invalid file extension: .dat
2025-04-01 19:35:28,140 - src.pipeline.orchestrator - INFO - File from https://altapointe.org/cms-price-transparency/ is not a valid price transparency file format
2025-04-01 19:35:28,145 - scripts.custom_status_tracker - INFO - Successfully updated hospital 85a87fb9-3053-440d-9608-acbc7bf7fb97 with not_found status
2025-04-01 19:35:28,146 - src.pipeline.orchestrator - INFO - Failed search for EASTPOINTE HOSPITAL completed in 35.27 seconds
2025-04-01 19:35:28,146 - scripts.run_price_finder - WARNING - Price finder returned None
2025-04-01 19:35:28,148 - scripts.run_price_finder - INFO - Successfully updated database for hospital EASTPOINTE HOSPITAL
2025-04-01 19:35:28,148 - scripts.run_price_finder - INFO - Successfully processed hospital EASTPOINTE HOSPITAL
2025-04-01 19:35:28,149 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x114e6ce90>, 'zip_code': '36801', 'price_transparency_url': None, 'helipad': True, 'price_file_found': False, 'health_sys_id': 'sys_east_alabama_medical_center_opelika_al', 'hospital_type': 'GENERAL ACUTE CARE', 'health_sys_name': 'East Alabama Medical Center', 'name': 'EAST ALABAMA MEDICAL CENTER', 'status': 'OPEN', 'address': '2000 PEPPERELL PARKWAY', 'search_status': 'pending', 'population': 314, 'health_sys_city': 'Opelika', 'search_attempts': 0, 'county': 'LEE', 'city': 'OPELIKA', 'health_sys_state': 'AL', 'latitude': 32.63852487, 'last_search_date': None, 'longitude': -85.4044747899999, 'state': 'AL', 'corp_parent_name': 'EAST ALABAMA MEDICAL CENTER', 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579875), 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579876), 'id': 'aff60f17-5a51-4ea6-a1bb-a8eeb5cb7f20', 'website': None, 'owner': 'GOVERNMENT - DISTRICT/AUTHORITY'}
2025-04-01 19:35:28,149 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': 'aff60f17-5a51-4ea6-a1bb-a8eeb5cb7f20', 'name': 'EAST ALABAMA MEDICAL CENTER', 'website': 'https://www.eastalabamamedicalcenter.org', 'city': 'OPELIKA', 'state': 'AL', 'health_system_name': 'East Alabama Medical Center'}
2025-04-01 19:35:28,149 - scripts.run_price_finder - INFO - Processing hospital: EAST ALABAMA MEDICAL CENTER (ID: aff60f17-5a51-4ea6-a1bb-a8eeb5cb7f20)
2025-04-01 19:35:28,150 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='aff60f17-5a51-4ea6-a1bb-a8eeb5cb7f20', name='EAST ALABAMA MEDICAL CENTER', state='AL', city='OPELIKA', address=None, website='https://www.eastalabamamedicalcenter.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:35:28,150 - src.pipeline.orchestrator - INFO - Starting price file search for EAST ALABAMA MEDICAL CENTER (AL)
2025-04-01 19:35:28,152 - src.pipeline.orchestrator - INFO - Searching for price transparency files for EAST ALABAMA MEDICAL CENTER
2025-04-01 19:35:28,152 - src.searchers.serpapi_search - INFO - Searching for: EAST ALABAMA MEDICAL CENTER OPELIKA, AL price transparency standard charges
2025-04-01 19:35:28,153 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:35:29,732 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=EAST+ALABAMA+MEDICAL+CENTER+OPELIKA%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:35:29,741 - src.searchers.serpapi_search - INFO - Found 14 results for query: EAST ALABAMA MEDICAL CENTER OPELIKA, AL price transparency standard charges
2025-04-01 19:35:29,756 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for EAST ALABAMA MEDICAL CENTER
2025-04-01 19:35:29,880 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:35:50,838 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:35:50,843 - src.pipeline.orchestrator - INFO - Crawling https://www.eastalabamahealth.org/patient-and-guests/billing-and-financial-information/estimate-my-cost for EAST ALABAMA MEDICAL CENTER (#1 of top 3)
2025-04-01 19:35:50,843 - src.searchers.web_crawler - INFO - Crawling URL: https://www.eastalabamahealth.org/patient-and-guests/billing-and-financial-information/estimate-my-cost
2025-04-01 19:35:52,398 - src.searchers.web_crawler - ERROR - Error fetching https://www.eastalabamahealth.org/patient-and-guests/billing-and-financial-information/estimate-my-cost with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:35:52,402 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:35:52,407 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:35:54,398 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:35:54,399 - src.pipeline.orchestrator - INFO - Found 2 potential price file links for EAST ALABAMA MEDICAL CENTER
2025-04-01 19:35:54,399 - src.pipeline.orchestrator - INFO - Downloading file from https://www.eastalabamahealth.org/sites/default/files/financial-service/636000526_EastAlabama_standardcharges.csv
2025-04-01 19:35:56,765 - src.searchers.web_crawler - INFO - Downloaded file from https://www.eastalabamahealth.org/sites/default/files/financial-service/636000526_EastAlabama_standardcharges.csv to downloads/636000526_EastAlabama_standardcharges.csv
2025-04-01 19:35:56,769 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:36:01,463 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:36:01,465 - src.pipeline.orchestrator - INFO - Found valid price file for EAST ALABAMA MEDICAL CENTER: https://www.eastalabamahealth.org/sites/default/files/financial-service/636000526_EastAlabama_standardcharges.csv, confidence: 1.0
2025-04-01 19:36:01,470 - scripts.custom_status_tracker - INFO - Successfully updated hospital aff60f17-5a51-4ea6-a1bb-a8eeb5cb7f20 status
2025-04-01 19:36:01,471 - scripts.custom_status_tracker - ERROR - Error updating price file for hospital aff60f17-5a51-4ea6-a1bb-a8eeb5cb7f20: 'validation_score' is an invalid keyword argument for HospitalPriceFile
2025-04-01 19:36:01,471 - src.pipeline.orchestrator - INFO - Successful search for EAST ALABAMA MEDICAL CENTER completed in 33.32 seconds
2025-04-01 19:36:01,471 - scripts.run_price_finder - INFO - Price finder result: {'hospital_id': 'aff60f17-5a51-4ea6-a1bb-a8eeb5cb7f20', 'url': 'https://www.eastalabamahealth.org/sites/default/files/financial-service/636000526_EastAlabama_standardcharges.csv', 'file_type': 'csv', 'validated': True, 'validation_date': None, 'validation_score': 0.95, 'validation_notes': "The file contains detailed service descriptions, CPT codes, and various pricing information including gross charges, discounted cash prices, min/max prices, and payer-specific negotiated charges. The hospital name 'East Alabama Medical Center' and its location '2000 PEPPERELL PKWY OPELIKA, AL 36801' are clearly mentioned, matching the specified hospital. The data structure aligns well with expected price transparency file formats.", 'file_size': 50590794, 'last_modified': None, 'download_date': None, 'contains_prices': True, 'contains_hospital_name': True, 'coverage_period': None, 'processed': False, 'processing_date': None, 'processing_errors': []}
2025-04-01 19:36:01,473 - scripts.run_price_finder - ERROR - Error processing hospital aff60f17-5a51-4ea6-a1bb-a8eeb5cb7f20: 'validation_score' is an invalid keyword argument for HospitalPriceFile
2025-04-01 19:36:01,473 - scripts.run_price_finder - ERROR - Traceback (most recent call last):
  File "/Users/bentenner/OmegaReal/backend/scripts/run_price_finder.py", line 228, in update_database_from_price_finder
    price_file = HospitalPriceFile(
                 ^^^^^^^^^^^^^^^^^^
  File "<string>", line 4, in __init__
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/sqlalchemy/orm/state.py", line 571, in _initialize_instance
    with util.safe_reraise():
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/sqlalchemy/orm/state.py", line 569, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/sqlalchemy/orm/decl_base.py", line 2175, in _declarative_constructor
    raise TypeError(
TypeError: 'validation_score' is an invalid keyword argument for HospitalPriceFile

2025-04-01 19:36:01,476 - scripts.run_price_finder - INFO - Successfully processed hospital EAST ALABAMA MEDICAL CENTER
2025-04-01 19:36:01,477 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x114e6fbf0>, 'zip_code': '35968', 'price_transparency_url': None, 'helipad': True, 'price_file_found': False, 'health_sys_id': 'sys_quorum_health_corporation_brentwood_tn', 'hospital_type': 'GENERAL ACUTE CARE', 'health_sys_name': 'Quorum Health Corporation', 'name': 'DEKALB REGIONAL MEDICAL CENTER', 'status': 'OPEN', 'address': '200 MEDICAL CENTER DRIVE, PO BOX 680778', 'search_status': 'pending', 'population': 134, 'health_sys_city': 'Brentwood', 'search_attempts': 0, 'county': 'DEKALB', 'city': 'FORT PAYNE', 'health_sys_state': 'TN', 'latitude': 34.44127984, 'last_search_date': None, 'longitude': -85.7562183699999, 'state': 'AL', 'corp_parent_name': 'QUORUM HEALTH CORP', 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579875), 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579875), 'id': '15f31129-3a45-4346-b41d-94010a29721a', 'website': None, 'owner': 'PROPRIETARY'}
2025-04-01 19:36:01,477 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': '15f31129-3a45-4346-b41d-94010a29721a', 'name': 'DEKALB REGIONAL MEDICAL CENTER', 'website': 'https://www.dekalbregionalmedicalcenter.org', 'city': 'FORT PAYNE', 'state': 'AL', 'health_system_name': 'Quorum Health Corporation'}
2025-04-01 19:36:01,477 - scripts.run_price_finder - INFO - Processing hospital: DEKALB REGIONAL MEDICAL CENTER (ID: 15f31129-3a45-4346-b41d-94010a29721a)
2025-04-01 19:36:01,478 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='15f31129-3a45-4346-b41d-94010a29721a', name='DEKALB REGIONAL MEDICAL CENTER', state='AL', city='FORT PAYNE', address=None, website='https://www.dekalbregionalmedicalcenter.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:36:01,478 - src.pipeline.orchestrator - INFO - Starting price file search for DEKALB REGIONAL MEDICAL CENTER (AL)
2025-04-01 19:36:01,480 - src.pipeline.orchestrator - INFO - Searching for price transparency files for DEKALB REGIONAL MEDICAL CENTER
2025-04-01 19:36:01,480 - src.searchers.serpapi_search - INFO - Searching for: DEKALB REGIONAL MEDICAL CENTER FORT PAYNE, AL price transparency standard charges
2025-04-01 19:36:01,481 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:36:06,480 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=DEKALB+REGIONAL+MEDICAL+CENTER+FORT+PAYNE%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:36:06,482 - src.searchers.serpapi_search - INFO - Found 14 results for query: DEKALB REGIONAL MEDICAL CENTER FORT PAYNE, AL price transparency standard charges
2025-04-01 19:36:06,482 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for DEKALB REGIONAL MEDICAL CENTER
2025-04-01 19:36:06,483 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:36:22,514 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:36:22,517 - src.pipeline.orchestrator - INFO - Crawling https://dekalbregional.org/patients-visitors/financial-information/price-transparency/ for DEKALB REGIONAL MEDICAL CENTER (#1 of top 3)
2025-04-01 19:36:22,517 - src.searchers.web_crawler - INFO - Crawling URL: https://dekalbregional.org/patients-visitors/financial-information/price-transparency/
2025-04-01 19:36:23,894 - src.searchers.web_crawler - ERROR - Error fetching https://dekalbregional.org/patients-visitors/financial-information/price-transparency/ with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:36:23,909 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:36:25,946 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:36:25,947 - src.pipeline.orchestrator - INFO - Found 4 potential price file links for DEKALB REGIONAL MEDICAL CENTER
2025-04-01 19:36:25,947 - src.pipeline.orchestrator - INFO - Downloading file from https://dekalbregional.org/wp-content/uploads/934333907_Dekalb-Regional-Medical-Center_standardcharges.csv
2025-04-01 19:36:26,536 - src.searchers.web_crawler - INFO - Downloaded file from https://dekalbregional.org/wp-content/uploads/934333907_Dekalb-Regional-Medical-Center_standardcharges.csv to downloads/934333907_Dekalb-Regional-Medical-Center_standardcharges.csv
2025-04-01 19:36:26,538 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:36:31,844 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:36:31,846 - src.pipeline.orchestrator - INFO - Found valid price file for DEKALB REGIONAL MEDICAL CENTER: https://dekalbregional.org/wp-content/uploads/934333907_Dekalb-Regional-Medical-Center_standardcharges.csv, confidence: 1.0
2025-04-01 19:36:31,851 - scripts.custom_status_tracker - INFO - Successfully updated hospital 15f31129-3a45-4346-b41d-94010a29721a status
2025-04-01 19:36:31,852 - scripts.custom_status_tracker - ERROR - Error updating price file for hospital 15f31129-3a45-4346-b41d-94010a29721a: 'validation_score' is an invalid keyword argument for HospitalPriceFile
2025-04-01 19:36:31,853 - src.pipeline.orchestrator - INFO - Successful search for DEKALB REGIONAL MEDICAL CENTER completed in 30.38 seconds
2025-04-01 19:36:31,853 - scripts.run_price_finder - INFO - Price finder result: {'hospital_id': '15f31129-3a45-4346-b41d-94010a29721a', 'url': 'https://dekalbregional.org/wp-content/uploads/934333907_Dekalb-Regional-Medical-Center_standardcharges.csv', 'file_type': 'csv', 'validated': True, 'validation_date': None, 'validation_score': 0.95, 'validation_notes': "The file contains detailed pricing information with service descriptions, codes, and various charge types (gross, discounted cash, negotiated). It also clearly specifies 'Dekalb Regional Medical Center' as the hospital name, matching the specified hospital. The data includes payer-specific negotiated charges, which are typical of hospital price transparency files.", 'file_size': 4017921, 'last_modified': None, 'download_date': None, 'contains_prices': True, 'contains_hospital_name': True, 'coverage_period': None, 'processed': False, 'processing_date': None, 'processing_errors': []}
2025-04-01 19:36:31,855 - scripts.run_price_finder - ERROR - Error processing hospital 15f31129-3a45-4346-b41d-94010a29721a: 'validation_score' is an invalid keyword argument for HospitalPriceFile
2025-04-01 19:36:31,855 - scripts.run_price_finder - ERROR - Traceback (most recent call last):
  File "/Users/bentenner/OmegaReal/backend/scripts/run_price_finder.py", line 228, in update_database_from_price_finder
    price_file = HospitalPriceFile(
                 ^^^^^^^^^^^^^^^^^^
  File "<string>", line 4, in __init__
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/sqlalchemy/orm/state.py", line 571, in _initialize_instance
    with util.safe_reraise():
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/sqlalchemy/orm/state.py", line 569, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/sqlalchemy/orm/decl_base.py", line 2175, in _declarative_constructor
    raise TypeError(
TypeError: 'validation_score' is an invalid keyword argument for HospitalPriceFile

2025-04-01 19:36:31,858 - scripts.run_price_finder - INFO - Successfully processed hospital DEKALB REGIONAL MEDICAL CENTER
2025-04-01 19:36:31,859 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x114e6edb0>, 'zip_code': '35903', 'price_transparency_url': None, 'helipad': True, 'price_file_found': False, 'health_sys_id': 'sys_independent', 'hospital_type': 'REHABILITATION', 'health_sys_name': 'Independent', 'name': 'ENCOMPASS HEALTH REHABILITATION HOSPITAL OF GADSDEN', 'status': 'OPEN', 'address': '801 GOODYEAR AVENUE', 'search_status': 'pending', 'population': 48, 'health_sys_city': None, 'search_attempts': 0, 'county': 'ETOWAH', 'city': 'GADSDEN', 'health_sys_state': None, 'latitude': 34.00674122, 'last_search_date': None, 'longitude': -85.96848844, 'state': 'AL', 'corp_parent_name': 'ENCOMPASS HEALTH', 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579878), 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579878), 'id': '9b531a53-c109-40ab-bf2e-841c90f75b4f', 'website': None, 'owner': 'PROPRIETARY'}
2025-04-01 19:36:31,859 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': '9b531a53-c109-40ab-bf2e-841c90f75b4f', 'name': 'ENCOMPASS HEALTH REHABILITATION HOSPITAL OF GADSDEN', 'website': 'https://www.encompasshealthrehabilitationhospitalofgadsden.org', 'city': 'GADSDEN', 'state': 'AL', 'health_system_name': 'Independent'}
2025-04-01 19:36:31,859 - scripts.run_price_finder - INFO - Processing hospital: ENCOMPASS HEALTH REHABILITATION HOSPITAL OF GADSDEN (ID: 9b531a53-c109-40ab-bf2e-841c90f75b4f)
2025-04-01 19:36:31,860 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='9b531a53-c109-40ab-bf2e-841c90f75b4f', name='ENCOMPASS HEALTH REHABILITATION HOSPITAL OF GADSDEN', state='AL', city='GADSDEN', address=None, website='https://www.encompasshealthrehabilitationhospitalofgadsden.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:36:31,860 - src.pipeline.orchestrator - INFO - Starting price file search for ENCOMPASS HEALTH REHABILITATION HOSPITAL OF GADSDEN (AL)
2025-04-01 19:36:31,863 - src.pipeline.orchestrator - INFO - Searching for price transparency files for ENCOMPASS HEALTH REHABILITATION HOSPITAL OF GADSDEN
2025-04-01 19:36:31,863 - src.searchers.serpapi_search - INFO - Searching for: ENCOMPASS HEALTH REHABILITATION HOSPITAL OF GADSDEN GADSDEN, AL price transparency standard charges
2025-04-01 19:36:31,864 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:36:34,256 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=ENCOMPASS+HEALTH+REHABILITATION+HOSPITAL+OF+GADSDEN+GADSDEN%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:36:34,257 - src.searchers.serpapi_search - INFO - Found 13 results for query: ENCOMPASS HEALTH REHABILITATION HOSPITAL OF GADSDEN GADSDEN, AL price transparency standard charges
2025-04-01 19:36:34,257 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for ENCOMPASS HEALTH REHABILITATION HOSPITAL OF GADSDEN
2025-04-01 19:36:34,258 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:36:57,582 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:36:57,586 - src.pipeline.orchestrator - INFO - Crawling https://encompasshealth.com/locations/gadsdenrehab/transparency-healthcare for ENCOMPASS HEALTH REHABILITATION HOSPITAL OF GADSDEN (#1 of top 3)
2025-04-01 19:36:57,586 - src.searchers.web_crawler - INFO - Crawling URL: https://encompasshealth.com/locations/gadsdenrehab/transparency-healthcare
2025-04-01 19:36:58,845 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:36:58,876 - src.searchers.web_crawler - ERROR - Error fetching https://encompasshealth.com/locations/gadsdenrehab/transparency-healthcare with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:36:58,884 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:37:04,371 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:37:04,373 - src.pipeline.orchestrator - INFO - Found 5 potential price file links for ENCOMPASS HEALTH REHABILITATION HOSPITAL OF GADSDEN
2025-04-01 19:37:04,373 - src.pipeline.orchestrator - INFO - Downloading file from https://example.com/csv
2025-04-01 19:37:05,464 - src.searchers.web_crawler - ERROR - Failed to download file from https://example.com/csv, status: 404
2025-04-01 19:37:05,464 - src.pipeline.orchestrator - WARNING - Failed to download file from https://example.com/csv
2025-04-01 19:37:05,464 - src.pipeline.orchestrator - INFO - Downloading file from https://encompasshealth.com/-/media/healthsouth/project/healthsouth/files/1-price-transparency/27-4000610_encompass-health-rehabilitation-hospital-of-gadsden_shoppableservices.csv
2025-04-01 19:37:05,616 - src.searchers.web_crawler - INFO - Downloaded file from https://encompasshealth.com/-/media/healthsouth/project/healthsouth/files/1-price-transparency/27-4000610_encompass-health-rehabilitation-hospital-of-gadsden_shoppableservices.csv to downloads/27-4000610_Encompass Health Rehabilitation Hospital of Gadsden_shoppableservices.csv
2025-04-01 19:37:05,616 - src.validators.file_validator - INFO - Headers don't suggest price data: ['Encompass Health Rehabilitation Hospital of Gadsden', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '']
2025-04-01 19:37:05,616 - src.pipeline.orchestrator - INFO - File from https://encompasshealth.com/-/media/healthsouth/project/healthsouth/files/1-price-transparency/27-4000610_encompass-health-rehabilitation-hospital-of-gadsden_shoppableservices.csv is not a valid price transparency file format
2025-04-01 19:37:05,616 - src.pipeline.orchestrator - INFO - Crawling https://encompasshealth.com/locations/gadsdenrehab for ENCOMPASS HEALTH REHABILITATION HOSPITAL OF GADSDEN (#2 of top 3)
2025-04-01 19:37:05,616 - src.searchers.web_crawler - INFO - Crawling URL: https://encompasshealth.com/locations/gadsdenrehab
2025-04-01 19:37:06,194 - src.searchers.web_crawler - ERROR - Error fetching https://encompasshealth.com/locations/gadsdenrehab with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:37:06,203 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:37:06,209 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:37:06,897 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:37:06,898 - src.pipeline.orchestrator - INFO - Found 1 potential price file links for ENCOMPASS HEALTH REHABILITATION HOSPITAL OF GADSDEN
2025-04-01 19:37:06,898 - src.pipeline.orchestrator - INFO - Downloading file from https://encompasshealth.com/locations/gadsdenrehab/financial-assistance
2025-04-01 19:37:07,079 - src.searchers.web_crawler - INFO - Downloaded file from https://encompasshealth.com/locations/gadsdenrehab/financial-assistance to downloads/financial-assistance
2025-04-01 19:37:07,079 - src.validators.file_validator - INFO - Invalid file extension: 
2025-04-01 19:37:07,079 - src.pipeline.orchestrator - INFO - File from https://encompasshealth.com/locations/gadsdenrehab/financial-assistance is not a valid price transparency file format
2025-04-01 19:37:07,079 - src.pipeline.orchestrator - INFO - Crawling https://encompasshealth.com/locations/gadsdenrehab/for-patients for ENCOMPASS HEALTH REHABILITATION HOSPITAL OF GADSDEN (#3 of top 3)
2025-04-01 19:37:07,079 - src.searchers.web_crawler - INFO - Crawling URL: https://encompasshealth.com/locations/gadsdenrehab/for-patients
2025-04-01 19:37:07,611 - src.searchers.web_crawler - ERROR - Error fetching https://encompasshealth.com/locations/gadsdenrehab/for-patients with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:37:07,621 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:37:11,608 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:37:11,610 - src.pipeline.orchestrator - INFO - Found 2 potential price file links for ENCOMPASS HEALTH REHABILITATION HOSPITAL OF GADSDEN
2025-04-01 19:37:11,610 - src.pipeline.orchestrator - INFO - Downloading file from https://encompasshealth.com/locations/gadsdenrehab/financial-assistance
2025-04-01 19:37:11,797 - src.searchers.web_crawler - INFO - Downloaded file from https://encompasshealth.com/locations/gadsdenrehab/financial-assistance to downloads/financial-assistance
2025-04-01 19:37:11,797 - src.validators.file_validator - INFO - Invalid file extension: 
2025-04-01 19:37:11,797 - src.pipeline.orchestrator - INFO - File from https://encompasshealth.com/locations/gadsdenrehab/financial-assistance is not a valid price transparency file format
2025-04-01 19:37:11,797 - src.pipeline.orchestrator - INFO - Downloading file from https://example.com/price-transparency
2025-04-01 19:37:12,529 - src.searchers.web_crawler - ERROR - Failed to download file from https://example.com/price-transparency, status: 404
2025-04-01 19:37:12,530 - src.pipeline.orchestrator - WARNING - Failed to download file from https://example.com/price-transparency
2025-04-01 19:37:12,535 - scripts.custom_status_tracker - INFO - Successfully updated hospital 9b531a53-c109-40ab-bf2e-841c90f75b4f with not_found status
2025-04-01 19:37:12,537 - src.pipeline.orchestrator - INFO - Failed search for ENCOMPASS HEALTH REHABILITATION HOSPITAL OF GADSDEN completed in 40.68 seconds
2025-04-01 19:37:12,537 - scripts.run_price_finder - WARNING - Price finder returned None
2025-04-01 19:37:12,540 - scripts.run_price_finder - INFO - Successfully updated database for hospital ENCOMPASS HEALTH REHABILITATION HOSPITAL OF GADSDEN
2025-04-01 19:37:12,540 - scripts.run_price_finder - INFO - Successfully processed hospital ENCOMPASS HEALTH REHABILITATION HOSPITAL OF GADSDEN
2025-04-01 19:37:12,540 - __main__ - INFO - Completed run: processed 8 hospitals, found 3 files, validated 3 files, errors: 3
2025-04-01 19:37:12,540 - __main__ - INFO - Waiting for 284 seconds until next run
2025-04-01 19:41:56,540 - __main__ - INFO - [2025-04-01 19:41:56] Running scheduled price finder with batch size 13
2025-04-01 19:41:56,541 - scripts.run_price_finder - INFO - Starting price finder integration - batch size: 13, state: None
2025-04-01 19:41:56,541 - scripts.run_price_finder - DEBUG - Config loaded: {'serpapi_key': '6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a', 'openai_key': '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', 'mistral_key': '87QKmlS8vjw0woFXpLnUKVIqLkcMa8Lz', 'llm_provider': 'mistral', 'download_dir': 'downloads'}
2025-04-01 19:41:56,547 - scripts.custom_status_tracker - INFO - Initialized MainDBStatusTracker with main application database
2025-04-01 19:41:56,547 - scripts.run_price_finder - INFO - Status tracker initialized with main application database
2025-04-01 19:41:56,547 - src.pipeline.orchestrator - INFO - Initializing pipeline components...
2025-04-01 19:41:56,548 - src.llm.link_analyzer - INFO - Initialized LLMLinkAnalyzer with provider=mistral, model=mistral-large-latest
2025-04-01 19:41:56,548 - src.llm.link_analyzer - INFO - Initialized LLMLinkAnalyzer with provider=mistral, model=mistral-large-latest
2025-04-01 19:41:56,548 - src.pipeline.orchestrator - INFO - Pipeline initialization complete
2025-04-01 19:41:56,548 - scripts.run_price_finder - INFO - PriceFinderPipeline initialized successfully with custom status tracker
2025-04-01 19:41:56,555 - scripts.run_price_finder - INFO - Found 13 hospitals to process
2025-04-01 19:41:56,555 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x11606c9b0>, 'zip_code': '36451', 'helipad': True, 'price_transparency_url': None, 'name': 'GROVE HILL MEMORIAL HOSPITAL', 'hospital_type': 'GENERAL ACUTE CARE', 'health_sys_id': 'sys_independent', 'health_sys_name': 'Independent', 'price_file_found': False, 'address': '295 JACKSON HIGHWAY S, PO BOX 935', 'status': 'OPEN', 'search_status': 'pending', 'population': 50, 'county': 'CLARKE', 'health_sys_city': None, 'search_attempts': 0, 'city': 'GROVE HILL', 'latitude': 31.6943023000001, 'health_sys_state': None, 'last_search_date': None, 'state': 'AL', 'longitude': -87.7760246299999, 'corp_parent_name': None, 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579882), 'id': '2a6ac469-d5b8-49ff-b894-4c6e91a6d1b7', 'owner': 'GOVERNMENT - DISTRICT/AUTHORITY', 'website': None, 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579883)}
2025-04-01 19:41:56,555 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': '2a6ac469-d5b8-49ff-b894-4c6e91a6d1b7', 'name': 'GROVE HILL MEMORIAL HOSPITAL', 'website': 'https://www.grovehillmemorialhospital.org', 'city': 'GROVE HILL', 'state': 'AL', 'health_system_name': 'Independent'}
2025-04-01 19:41:56,555 - scripts.run_price_finder - INFO - Processing hospital: GROVE HILL MEMORIAL HOSPITAL (ID: 2a6ac469-d5b8-49ff-b894-4c6e91a6d1b7)
2025-04-01 19:41:56,558 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='2a6ac469-d5b8-49ff-b894-4c6e91a6d1b7', name='GROVE HILL MEMORIAL HOSPITAL', state='AL', city='GROVE HILL', address=None, website='https://www.grovehillmemorialhospital.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:41:56,558 - src.pipeline.orchestrator - INFO - Starting price file search for GROVE HILL MEMORIAL HOSPITAL (AL)
2025-04-01 19:41:56,561 - src.pipeline.orchestrator - INFO - Searching for price transparency files for GROVE HILL MEMORIAL HOSPITAL
2025-04-01 19:41:56,561 - src.searchers.serpapi_search - INFO - Searching for: GROVE HILL MEMORIAL HOSPITAL GROVE HILL, AL price transparency standard charges
2025-04-01 19:41:56,563 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:41:59,097 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=GROVE+HILL+MEMORIAL+HOSPITAL+GROVE+HILL%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:41:59,098 - src.searchers.serpapi_search - INFO - Found 14 results for query: GROVE HILL MEMORIAL HOSPITAL GROVE HILL, AL price transparency standard charges
2025-04-01 19:41:59,098 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for GROVE HILL MEMORIAL HOSPITAL
2025-04-01 19:41:59,100 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:42:16,209 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:42:16,248 - src.pipeline.orchestrator - INFO - Crawling https://gh-health.org/price-transparency/ for GROVE HILL MEMORIAL HOSPITAL (#1 of top 3)
2025-04-01 19:42:16,248 - src.searchers.web_crawler - INFO - Crawling URL: https://gh-health.org/price-transparency/
2025-04-01 19:42:18,001 - src.searchers.web_crawler - ERROR - Error fetching https://gh-health.org/price-transparency/ with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:42:18,009 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:42:21,393 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:42:21,394 - src.pipeline.orchestrator - INFO - Found 2 potential price file links for GROVE HILL MEMORIAL HOSPITAL
2025-04-01 19:42:21,394 - src.pipeline.orchestrator - INFO - Downloading file from https://www.grovehillmemorialhospital.com/Chargemaster/Machine Readable File
2025-04-01 19:42:21,424 - src.searchers.web_crawler - ERROR - Error downloading file from https://www.grovehillmemorialhospital.com/Chargemaster/Machine Readable File: Cannot connect to host www.grovehillmemorialhospital.com:443 ssl:default [nodename nor servname provided, or not known]
2025-04-01 19:42:21,424 - src.pipeline.orchestrator - WARNING - Failed to download file from https://www.grovehillmemorialhospital.com/Chargemaster/Machine Readable File
2025-04-01 19:42:21,424 - src.pipeline.orchestrator - INFO - Downloading file from https://gh-health.org/wp-content/uploads/2024/12/630436871_grove-hill-memorial-hospital_standardcharges.csv
2025-04-01 19:42:21,504 - src.searchers.web_crawler - INFO - Downloaded file from https://gh-health.org/wp-content/uploads/2024/12/630436871_grove-hill-memorial-hospital_standardcharges.csv to downloads/630436871_grove-hill-memorial-hospital_standardcharges.csv
2025-04-01 19:42:21,507 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:42:21,507 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:42:21,508 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:42:25,067 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:42:25,069 - src.pipeline.orchestrator - INFO - Found valid price file for GROVE HILL MEMORIAL HOSPITAL: https://gh-health.org/wp-content/uploads/2024/12/630436871_grove-hill-memorial-hospital_standardcharges.csv, confidence: 1.0
2025-04-01 19:42:25,074 - scripts.custom_status_tracker - INFO - Successfully updated hospital 2a6ac469-d5b8-49ff-b894-4c6e91a6d1b7 status
2025-04-01 19:42:25,074 - scripts.custom_status_tracker - ERROR - Error updating price file for hospital 2a6ac469-d5b8-49ff-b894-4c6e91a6d1b7: 'validation_score' is an invalid keyword argument for HospitalPriceFile
2025-04-01 19:42:25,075 - src.pipeline.orchestrator - INFO - Successful search for GROVE HILL MEMORIAL HOSPITAL completed in 28.52 seconds
2025-04-01 19:42:25,075 - scripts.run_price_finder - INFO - Price finder result: {'hospital_id': '2a6ac469-d5b8-49ff-b894-4c6e91a6d1b7', 'url': 'https://gh-health.org/wp-content/uploads/2024/12/630436871_grove-hill-memorial-hospital_standardcharges.csv', 'file_type': 'csv', 'validated': True, 'validation_date': None, 'validation_score': 0.95, 'validation_notes': "The file contains detailed hospital pricing data with CPT codes, descriptions, and various pricing information including gross charges, discounted cash prices, and payer-specific negotiated charges. The hospital name 'Grove Hill Memorial Hospital' is clearly mentioned, matching the specified hospital. The data also includes different payer rates, cash prices, and min/max prices, which are all indicators of a valid hospital price transparency file.", 'file_size': 184300, 'last_modified': None, 'download_date': None, 'contains_prices': True, 'contains_hospital_name': True, 'coverage_period': None, 'processed': False, 'processing_date': None, 'processing_errors': []}
2025-04-01 19:42:25,076 - scripts.run_price_finder - ERROR - Error processing hospital 2a6ac469-d5b8-49ff-b894-4c6e91a6d1b7: 'validation_score' is an invalid keyword argument for HospitalPriceFile
2025-04-01 19:42:25,077 - scripts.run_price_finder - ERROR - Traceback (most recent call last):
  File "/Users/bentenner/OmegaReal/backend/scripts/run_price_finder.py", line 228, in update_database_from_price_finder
    "notes": result_dict.get("validation_notes", "")
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 4, in __init__
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/sqlalchemy/orm/state.py", line 571, in _initialize_instance
    with util.safe_reraise():
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/sqlalchemy/orm/state.py", line 569, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/sqlalchemy/orm/decl_base.py", line 2175, in _declarative_constructor
    raise TypeError(
TypeError: 'validation_score' is an invalid keyword argument for HospitalPriceFile

2025-04-01 19:42:25,079 - scripts.run_price_finder - INFO - Successfully processed hospital GROVE HILL MEMORIAL HOSPITAL
2025-04-01 19:42:25,079 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x11606d970>, 'zip_code': '36744', 'price_transparency_url': None, 'helipad': False, 'price_file_found': False, 'health_sys_id': 'sys_independent', 'hospital_type': 'GENERAL ACUTE CARE', 'health_sys_name': 'Independent', 'name': 'HALE COUNTY HOSPITAL', 'status': 'OPEN', 'address': '508 GREENE STREET', 'search_status': 'pending', 'population': 39, 'health_sys_city': None, 'search_attempts': 0, 'county': 'HALE', 'city': 'GREENSBORO', 'health_sys_state': None, 'latitude': 32.69537224, 'last_search_date': None, 'longitude': -87.58693419, 'state': 'AL', 'corp_parent_name': None, 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579883), 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579883), 'id': '46e2132b-fb70-43d8-891f-35fea87d8354', 'website': None, 'owner': 'GOVERNMENT - LOCAL'}
2025-04-01 19:42:25,079 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': '46e2132b-fb70-43d8-891f-35fea87d8354', 'name': 'HALE COUNTY HOSPITAL', 'website': 'https://www.halecountyhospital.org', 'city': 'GREENSBORO', 'state': 'AL', 'health_system_name': 'Independent'}
2025-04-01 19:42:25,080 - scripts.run_price_finder - INFO - Processing hospital: HALE COUNTY HOSPITAL (ID: 46e2132b-fb70-43d8-891f-35fea87d8354)
2025-04-01 19:42:25,080 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='46e2132b-fb70-43d8-891f-35fea87d8354', name='HALE COUNTY HOSPITAL', state='AL', city='GREENSBORO', address=None, website='https://www.halecountyhospital.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:42:25,080 - src.pipeline.orchestrator - INFO - Starting price file search for HALE COUNTY HOSPITAL (AL)
2025-04-01 19:42:25,083 - src.pipeline.orchestrator - INFO - Searching for price transparency files for HALE COUNTY HOSPITAL
2025-04-01 19:42:25,083 - src.searchers.serpapi_search - INFO - Searching for: HALE COUNTY HOSPITAL GREENSBORO, AL price transparency standard charges
2025-04-01 19:42:25,084 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:42:27,417 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=HALE+COUNTY+HOSPITAL+GREENSBORO%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:42:27,419 - src.searchers.serpapi_search - INFO - Found 12 results for query: HALE COUNTY HOSPITAL GREENSBORO, AL price transparency standard charges
2025-04-01 19:42:27,419 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for HALE COUNTY HOSPITAL
2025-04-01 19:42:27,419 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:42:43,701 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:42:43,708 - src.pipeline.orchestrator - INFO - Crawling https://www.halecountyhospital.com/ for HALE COUNTY HOSPITAL (#1 of top 3)
2025-04-01 19:42:43,708 - src.searchers.web_crawler - INFO - Crawling URL: https://www.halecountyhospital.com/
2025-04-01 19:42:45,127 - src.searchers.web_crawler - ERROR - Error fetching https://www.halecountyhospital.com/ with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:42:45,146 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:42:45,850 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:42:45,851 - src.pipeline.orchestrator - INFO - Found 0 potential price file links for HALE COUNTY HOSPITAL
2025-04-01 19:42:45,856 - scripts.custom_status_tracker - INFO - Successfully updated hospital 46e2132b-fb70-43d8-891f-35fea87d8354 with not_found status
2025-04-01 19:42:45,858 - src.pipeline.orchestrator - INFO - Failed search for HALE COUNTY HOSPITAL completed in 20.78 seconds
2025-04-01 19:42:45,858 - scripts.run_price_finder - WARNING - Price finder returned None
2025-04-01 19:42:45,860 - scripts.run_price_finder - INFO - Successfully updated database for hospital HALE COUNTY HOSPITAL
2025-04-01 19:42:45,861 - scripts.run_price_finder - INFO - Successfully processed hospital HALE COUNTY HOSPITAL
2025-04-01 19:42:45,861 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x11606d130>, 'zip_code': '35462', 'price_transparency_url': None, 'helipad': True, 'price_file_found': False, 'health_sys_id': 'sys_independent', 'hospital_type': 'GENERAL ACUTE CARE', 'health_sys_name': 'Independent', 'name': 'GREENE COUNTY HEALTH SYSTEM', 'status': 'OPEN', 'address': '509 WILSON AVENUE', 'search_status': 'pending', 'population': 20, 'health_sys_city': None, 'search_attempts': 0, 'county': 'GREENE', 'city': 'EUTAW', 'health_sys_state': None, 'latitude': 32.84324894, 'last_search_date': None, 'longitude': -87.8904834799999, 'state': 'AL', 'corp_parent_name': None, 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579882), 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579882), 'id': '0655735c-d79e-44c8-935d-df3cb4c041db', 'website': None, 'owner': 'GOVERNMENT - LOCAL'}
2025-04-01 19:42:45,861 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': '0655735c-d79e-44c8-935d-df3cb4c041db', 'name': 'GREENE COUNTY HEALTH SYSTEM', 'website': 'https://www.greenecountyhealthsystem.org', 'city': 'EUTAW', 'state': 'AL', 'health_system_name': 'Independent'}
2025-04-01 19:42:45,861 - scripts.run_price_finder - INFO - Processing hospital: GREENE COUNTY HEALTH SYSTEM (ID: 0655735c-d79e-44c8-935d-df3cb4c041db)
2025-04-01 19:42:45,862 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='0655735c-d79e-44c8-935d-df3cb4c041db', name='GREENE COUNTY HEALTH SYSTEM', state='AL', city='EUTAW', address=None, website='https://www.greenecountyhealthsystem.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:42:45,862 - src.pipeline.orchestrator - INFO - Starting price file search for GREENE COUNTY HEALTH SYSTEM (AL)
2025-04-01 19:42:45,863 - src.pipeline.orchestrator - INFO - Searching for price transparency files for GREENE COUNTY HEALTH SYSTEM
2025-04-01 19:42:45,863 - src.searchers.serpapi_search - INFO - Searching for: GREENE COUNTY HEALTH SYSTEM EUTAW, AL price transparency standard charges
2025-04-01 19:42:45,864 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:42:47,068 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=GREENE+COUNTY+HEALTH+SYSTEM+EUTAW%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:42:47,069 - src.searchers.serpapi_search - INFO - Found 14 results for query: GREENE COUNTY HEALTH SYSTEM EUTAW, AL price transparency standard charges
2025-04-01 19:42:47,069 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for GREENE COUNTY HEALTH SYSTEM
2025-04-01 19:42:47,070 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:43:08,585 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:43:08,590 - src.pipeline.orchestrator - INFO - Crawling http://www.gcheutaw.com/PriceListing for GREENE COUNTY HEALTH SYSTEM (#1 of top 3)
2025-04-01 19:43:08,590 - src.searchers.web_crawler - INFO - Crawling URL: http://www.gcheutaw.com/PriceListing
2025-04-01 19:43:10,018 - src.searchers.web_crawler - ERROR - Error fetching http://www.gcheutaw.com/PriceListing with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:43:10,020 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 19:43:10,027 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:43:18,695 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:43:18,696 - src.pipeline.orchestrator - INFO - Found 7 potential price file links for GREENE COUNTY HEALTH SYSTEM
2025-04-01 19:43:18,696 - src.pipeline.orchestrator - INFO - Downloading file from https://www.greenecountyhospital.org/attachments/article/200/GCHS%20Chargemaster.csv
2025-04-01 19:43:18,974 - src.searchers.web_crawler - INFO - Downloaded file from https://www.greenecountyhospital.org/attachments/article/200/GCHS%20Chargemaster.csv to downloads/GCHS%20Chargemaster.csv
2025-04-01 19:43:18,974 - src.validators.file_validator - INFO - Headers don't suggest price data: ['<!DOCTYPE html><html><head><script>window.onload=function(){window.location.href="/lander"}</script></head></html>']
2025-04-01 19:43:18,974 - src.pipeline.orchestrator - INFO - File from https://www.greenecountyhospital.org/attachments/article/200/GCHS%20Chargemaster.csv is not a valid price transparency file format
2025-04-01 19:43:18,974 - src.pipeline.orchestrator - INFO - Downloading file from https://www.greenecountyhospital.org/attachments/article/200/GCHS%20Machine-Readable%20File.json
2025-04-01 19:43:19,053 - src.searchers.web_crawler - INFO - Downloaded file from https://www.greenecountyhospital.org/attachments/article/200/GCHS%20Machine-Readable%20File.json to downloads/GCHS%20Machine-Readable%20File.json
2025-04-01 19:43:19,053 - src.validators.file_validator - ERROR - Error reading JSON downloads/GCHS%20Machine-Readable%20File.json: Expecting value: line 1 column 1 (char 0)
2025-04-01 19:43:19,053 - src.pipeline.orchestrator - INFO - File from https://www.greenecountyhospital.org/attachments/article/200/GCHS%20Machine-Readable%20File.json is not a valid price transparency file format
2025-04-01 19:43:19,053 - src.pipeline.orchestrator - INFO - Crawling https://www.greenecountyhospital.com/pricing-transparency for GREENE COUNTY HEALTH SYSTEM (#2 of top 3)
2025-04-01 19:43:19,053 - src.searchers.web_crawler - INFO - Crawling URL: https://www.greenecountyhospital.com/pricing-transparency
2025-04-01 19:43:19,821 - src.searchers.web_crawler - ERROR - Error fetching https://www.greenecountyhospital.com/pricing-transparency with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:43:19,849 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:43:23,533 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:43:23,535 - src.pipeline.orchestrator - INFO - Found 3 potential price file links for GREENE COUNTY HEALTH SYSTEM
2025-04-01 19:43:23,535 - src.pipeline.orchestrator - INFO - Downloading file from https://greenecountyhospital.com/wp-content/uploads/2022/06/GCGH-Financial-Assistance-Application.pdf
2025-04-01 19:43:23,789 - src.searchers.web_crawler - ERROR - Failed to download file from https://greenecountyhospital.com/wp-content/uploads/2022/06/GCGH-Financial-Assistance-Application.pdf, status: 404
2025-04-01 19:43:23,789 - src.pipeline.orchestrator - WARNING - Failed to download file from https://greenecountyhospital.com/wp-content/uploads/2022/06/GCGH-Financial-Assistance-Application.pdf
2025-04-01 19:43:23,789 - src.pipeline.orchestrator - INFO - Downloading file from https://greenecountyhospital.com/wp-content/uploads/2022/06/GCGH-Financial-Assistance-Policy.pdf
2025-04-01 19:43:24,012 - src.searchers.web_crawler - ERROR - Failed to download file from https://greenecountyhospital.com/wp-content/uploads/2022/06/GCGH-Financial-Assistance-Policy.pdf, status: 404
2025-04-01 19:43:24,012 - src.pipeline.orchestrator - WARNING - Failed to download file from https://greenecountyhospital.com/wp-content/uploads/2022/06/GCGH-Financial-Assistance-Policy.pdf
2025-04-01 19:43:24,018 - scripts.custom_status_tracker - INFO - Successfully updated hospital 0655735c-d79e-44c8-935d-df3cb4c041db with not_found status
2025-04-01 19:43:24,020 - src.pipeline.orchestrator - INFO - Failed search for GREENE COUNTY HEALTH SYSTEM completed in 38.16 seconds
2025-04-01 19:43:24,020 - scripts.run_price_finder - WARNING - Price finder returned None
2025-04-01 19:43:24,025 - scripts.run_price_finder - INFO - Successfully updated database for hospital GREENE COUNTY HEALTH SYSTEM
2025-04-01 19:43:24,026 - scripts.run_price_finder - INFO - Successfully processed hospital GREENE COUNTY HEALTH SYSTEM
2025-04-01 19:43:24,026 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x11606ec90>, 'zip_code': '35960', 'price_transparency_url': None, 'helipad': True, 'price_file_found': False, 'health_sys_id': 'sys_advocate_health_charlotte_nc', 'hospital_type': 'GENERAL ACUTE CARE', 'health_sys_name': 'Advocate Health', 'name': 'FLOYD CHEROKEE MEDICAL CENTER', 'status': 'OPEN', 'address': '400 NORTHWOOD DRIVE', 'search_status': 'pending', 'population': 60, 'health_sys_city': 'Charlotte', 'search_attempts': 0, 'county': 'CHEROKEE', 'city': 'CENTRE', 'health_sys_state': 'NC', 'latitude': 34.1614583, 'last_search_date': None, 'longitude': -85.65108878, 'state': 'AL', 'corp_parent_name': 'ADVOCATE HEALTH INC', 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579881), 'updated_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 579881), 'id': '42b4335c-8dc8-4249-867f-035101c37ad0', 'website': None, 'owner': 'PROPRIETARY'}
2025-04-01 19:43:24,026 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': '42b4335c-8dc8-4249-867f-035101c37ad0', 'name': 'FLOYD CHEROKEE MEDICAL CENTER', 'website': 'https://www.floydcherokeemedicalcenter.org', 'city': 'CENTRE', 'state': 'AL', 'health_system_name': 'Advocate Health'}
2025-04-01 19:43:24,026 - scripts.run_price_finder - INFO - Processing hospital: FLOYD CHEROKEE MEDICAL CENTER (ID: 42b4335c-8dc8-4249-867f-035101c37ad0)
2025-04-01 19:43:24,027 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='42b4335c-8dc8-4249-867f-035101c37ad0', name='FLOYD CHEROKEE MEDICAL CENTER', state='AL', city='CENTRE', address=None, website='https://www.floydcherokeemedicalcenter.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 19:43:24,027 - src.pipeline.orchestrator - INFO - Starting price file search for FLOYD CHEROKEE MEDICAL CENTER (AL)
2025-04-01 19:43:24,029 - src.pipeline.orchestrator - INFO - Searching for price transparency files for FLOYD CHEROKEE MEDICAL CENTER
2025-04-01 19:43:24,029 - src.searchers.serpapi_search - INFO - Searching for: FLOYD CHEROKEE MEDICAL CENTER CENTRE, AL price transparency standard charges
2025-04-01 19:43:24,030 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 19:43:25,754 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=FLOYD+CHEROKEE+MEDICAL+CENTER+CENTRE%2C+AL+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 19:43:25,755 - src.searchers.serpapi_search - INFO - Found 10 results for query: FLOYD CHEROKEE MEDICAL CENTER CENTRE, AL price transparency standard charges
2025-04-01 19:43:25,755 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for FLOYD CHEROKEE MEDICAL CENTER
2025-04-01 19:43:25,757 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:44:04,985 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:44:04,991 - src.pipeline.orchestrator - INFO - Crawling https://www.floyd.org/patients-visitors/billing/Pages/price-estimates.aspx for FLOYD CHEROKEE MEDICAL CENTER (#1 of top 3)
2025-04-01 19:44:04,991 - src.searchers.web_crawler - INFO - Crawling URL: https://www.floyd.org/patients-visitors/billing/Pages/price-estimates.aspx
2025-04-01 19:44:06,499 - src.searchers.web_crawler - ERROR - Error fetching https://www.floyd.org/patients-visitors/billing/Pages/price-estimates.aspx with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 19:44:06,515 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 19:44:09,102 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 19:44:09,103 - src.pipeline.orchestrator - INFO - Found 4 potential price file links for FLOYD CHEROKEE MEDICAL CENTER
2025-04-01 19:44:09,103 - src.pipeline.orchestrator - INFO - Downloading file from https://sthpiprd.blob.core.windows.net/machine-readable-files/11221/581973570_floyd-healthcare-management-inc_standardcharges.csv
2025-04-01 20:01:16,468 - asyncio - DEBUG - Using selector: KqueueSelector
2025-04-01 20:01:16,469 - scripts.run_price_finder - INFO - Starting price finder integration - batch size: 3, state: DE
2025-04-01 20:01:16,469 - scripts.run_price_finder - DEBUG - Config loaded: {'serpapi_key': '6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a', 'openai_key': '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', 'mistral_key': '87QKmlS8vjw0woFXpLnUKVIqLkcMa8Lz', 'llm_provider': 'mistral', 'download_dir': 'downloads'}
2025-04-01 20:01:16,470 - scripts.custom_status_tracker - INFO - Initialized MainDBStatusTracker with main application database
2025-04-01 20:01:16,470 - scripts.run_price_finder - INFO - Status tracker initialized with main application database
2025-04-01 20:01:16,470 - src.pipeline.orchestrator - INFO - Initializing pipeline components...
2025-04-01 20:01:16,470 - src.llm.link_analyzer - INFO - Initialized LLMLinkAnalyzer with provider=mistral, model=mistral-large-latest
2025-04-01 20:01:16,470 - src.llm.link_analyzer - INFO - Initialized LLMLinkAnalyzer with provider=mistral, model=mistral-large-latest
2025-04-01 20:01:16,470 - src.pipeline.orchestrator - INFO - Pipeline initialization complete
2025-04-01 20:01:16,470 - scripts.run_price_finder - INFO - PriceFinderPipeline initialized successfully with custom status tracker
2025-04-01 20:01:16,500 - scripts.run_price_finder - INFO - Found 3 hospitals to process
2025-04-01 20:01:16,500 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x130f807d0>, 'county': 'KENT', 'health_sys_city': None, 'search_attempts': 0, 'latitude': 38.9124017600001, 'health_sys_state': None, 'last_search_date': None, 'city': 'MILFORD', 'longitude': -75.4310756199999, 'corp_parent_name': None, 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 9, 386877), 'state': 'DE', 'owner': 'NON-PROFIT', 'website': None, 'updated_at': datetime.datetime(2025, 4, 1, 20, 10, 27, 494902), 'id': 'e9288e50-5999-4509-91a3-d4edd827dfc4', 'zip_code': '19963', 'helipad': True, 'price_transparency_url': None, 'hospital_type': 'GENERAL ACUTE CARE', 'health_sys_id': 'sys_independent', 'price_file_found': False, 'name': 'BAYHEALTH MILFORD MEMORIAL HOSPITAL', 'status': 'CLOSED', 'health_sys_name': 'Independent', 'search_status': 'pending', 'address': '21 W CLARK AVE', 'population': 127}
2025-04-01 20:01:16,500 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': 'e9288e50-5999-4509-91a3-d4edd827dfc4', 'name': 'BAYHEALTH MILFORD MEMORIAL HOSPITAL', 'website': 'https://www.bayhealthmilfordmemorialhospital.org', 'city': 'MILFORD', 'state': 'DE', 'health_system_name': 'Independent'}
2025-04-01 20:01:16,500 - scripts.run_price_finder - INFO - Processing hospital: BAYHEALTH MILFORD MEMORIAL HOSPITAL (ID: e9288e50-5999-4509-91a3-d4edd827dfc4)
2025-04-01 20:01:16,504 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='e9288e50-5999-4509-91a3-d4edd827dfc4', name='BAYHEALTH MILFORD MEMORIAL HOSPITAL', state='DE', city='MILFORD', address=None, website='https://www.bayhealthmilfordmemorialhospital.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 20:01:16,504 - src.pipeline.orchestrator - INFO - Starting price file search for BAYHEALTH MILFORD MEMORIAL HOSPITAL (DE)
2025-04-01 20:01:16,509 - src.pipeline.orchestrator - INFO - Searching for price transparency files for BAYHEALTH MILFORD MEMORIAL HOSPITAL
2025-04-01 20:01:16,509 - src.searchers.serpapi_search - INFO - Searching for: BAYHEALTH MILFORD MEMORIAL HOSPITAL MILFORD, DE price transparency standard charges
2025-04-01 20:01:16,511 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 20:01:18,247 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=BAYHEALTH+MILFORD+MEMORIAL+HOSPITAL+MILFORD%2C+DE+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 20:01:18,249 - src.searchers.serpapi_search - INFO - Found 14 results for query: BAYHEALTH MILFORD MEMORIAL HOSPITAL MILFORD, DE price transparency standard charges
2025-04-01 20:01:18,249 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for BAYHEALTH MILFORD MEMORIAL HOSPITAL
2025-04-01 20:01:18,250 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 20:01:36,676 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 20:01:36,678 - src.pipeline.orchestrator - INFO - Crawling https://www.bayhealth.org/patients/billing/price-transparency for BAYHEALTH MILFORD MEMORIAL HOSPITAL (#1 of top 3)
2025-04-01 20:01:36,679 - src.searchers.web_crawler - INFO - Crawling URL: https://www.bayhealth.org/patients/billing/price-transparency
2025-04-01 20:01:38,043 - src.searchers.web_crawler - ERROR - Error fetching https://www.bayhealth.org/patients/billing/price-transparency with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 20:01:38,060 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 20:01:44,537 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 20:01:44,539 - src.pipeline.orchestrator - INFO - Found 6 potential price file links for BAYHEALTH MILFORD MEMORIAL HOSPITAL
2025-04-01 20:01:44,539 - src.pipeline.orchestrator - INFO - Downloading file from https://www.bayhealth.org/-/media/files/patients-and-visitors/billing-financial-aid/price-transparency/dec-2024/510064318-bayhealthmedicalcenter-kent-standardcharges.txt
2025-04-01 20:01:51,658 - src.searchers.web_crawler - INFO - Downloaded file from https://www.bayhealth.org/-/media/files/patients-and-visitors/billing-financial-aid/price-transparency/dec-2024/510064318-bayhealthmedicalcenter-kent-standardcharges.txt to downloads/510064318_BayhealthMedicalCenter_Kent_StandardCharges.txt
2025-04-01 20:01:51,661 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 20:01:57,130 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 20:01:57,132 - src.pipeline.orchestrator - INFO - File from https://www.bayhealth.org/-/media/files/patients-and-visitors/billing-financial-aid/price-transparency/dec-2024/510064318-bayhealthmedicalcenter-kent-standardcharges.txt is not a match for BAYHEALTH MILFORD MEMORIAL HOSPITAL: Rule-based: Found location matches: state: DE, but no hospital name match. LLM: The file contains pricing information and procedure descriptions, which is consistent with valid price transparency data. However, the hospital name mentioned in the file is 'Bayhealth Medical Center Inc' and its various locations, not specifically 'BAYHEALTH MILFORD MEMORIAL HOSPITAL'. Therefore, it does not match the specified hospital name exactly.
2025-04-01 20:01:57,132 - src.pipeline.orchestrator - INFO - Downloading file from https://www.bayhealth.org/-/media/files/patients-and-visitors/billing-financial-aid/price-transparency/dec-2024/823462523-bayhealthemergencyphysicians-standardcharges.txt
2025-04-01 20:01:57,329 - src.searchers.web_crawler - INFO - Downloaded file from https://www.bayhealth.org/-/media/files/patients-and-visitors/billing-financial-aid/price-transparency/dec-2024/823462523-bayhealthemergencyphysicians-standardcharges.txt to downloads/823462523_BayhealthEmergencyPhysicians_StandardCharges.txt
2025-04-01 20:01:57,331 - src.validators.file_validator - INFO - Not enough data rows: 8 < 10
2025-04-01 20:01:57,332 - src.validators.file_validator - ERROR - Error reading text file downloads/823462523_BayhealthEmergencyPhysicians_StandardCharges.txt: 
2025-04-01 20:01:57,332 - src.pipeline.orchestrator - INFO - File from https://www.bayhealth.org/-/media/files/patients-and-visitors/billing-financial-aid/price-transparency/dec-2024/823462523-bayhealthemergencyphysicians-standardcharges.txt is not a valid price transparency file format
2025-04-01 20:01:57,332 - src.pipeline.orchestrator - INFO - Crawling https://prod-sitecore-cd.bayhealth.org/patients/billing/price-transparency for BAYHEALTH MILFORD MEMORIAL HOSPITAL (#2 of top 3)
2025-04-01 20:01:57,332 - src.searchers.web_crawler - INFO - Crawling URL: https://prod-sitecore-cd.bayhealth.org/patients/billing/price-transparency
2025-04-01 20:01:58,708 - src.searchers.web_crawler - ERROR - Error fetching https://prod-sitecore-cd.bayhealth.org/patients/billing/price-transparency with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 20:01:58,723 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 20:02:08,905 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 20:02:08,907 - src.pipeline.orchestrator - INFO - Found 6 potential price file links for BAYHEALTH MILFORD MEMORIAL HOSPITAL
2025-04-01 20:02:08,907 - src.pipeline.orchestrator - INFO - Downloading file from 510064318_BayhealthMedicalCenter_Kent_StandardCharges.txt
2025-04-01 20:02:08,907 - src.searchers.web_crawler - ERROR - Error downloading file from 510064318_BayhealthMedicalCenter_Kent_StandardCharges.txt: 510064318_BayhealthMedicalCenter_Kent_StandardCharges.txt
2025-04-01 20:02:08,907 - src.pipeline.orchestrator - WARNING - Failed to download file from 510064318_BayhealthMedicalCenter_Kent_StandardCharges.txt
2025-04-01 20:02:08,907 - src.pipeline.orchestrator - INFO - Downloading file from 823462523_BayhealthEmergencyPhysicians_StandardCharges.txt
2025-04-01 20:02:08,907 - src.searchers.web_crawler - ERROR - Error downloading file from 823462523_BayhealthEmergencyPhysicians_StandardCharges.txt: 823462523_BayhealthEmergencyPhysicians_StandardCharges.txt
2025-04-01 20:02:08,907 - src.pipeline.orchestrator - WARNING - Failed to download file from 823462523_BayhealthEmergencyPhysicians_StandardCharges.txt
2025-04-01 20:02:08,907 - src.pipeline.orchestrator - INFO - Crawling https://www.bayhealth.org/-/media/files/patients-and-visitors/healthcare-prices-guide/priceestimates-bro-100621-single-page.pdf for BAYHEALTH MILFORD MEMORIAL HOSPITAL (#3 of top 3)
2025-04-01 20:02:08,907 - src.searchers.web_crawler - INFO - Crawling URL: https://www.bayhealth.org/-/media/files/patients-and-visitors/healthcare-prices-guide/priceestimates-bro-100621-single-page.pdf
2025-04-01 20:02:09,265 - src.searchers.web_crawler - ERROR - Error fetching https://www.bayhealth.org/-/media/files/patients-and-visitors/healthcare-prices-guide/priceestimates-bro-100621-single-page.pdf with aiohttp: 'utf-8' codec can't decode byte 0xe2 in position 10: invalid continuation byte
2025-04-01 20:02:09,628 - src.searchers.web_crawler - ERROR - Error fetching https://www.bayhealth.org/-/media/files/patients-and-visitors/healthcare-prices-guide/priceestimates-bro-100621-single-page.pdf with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 20:02:09,629 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 20:02:10,543 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 20:02:10,545 - src.pipeline.orchestrator - INFO - Found 0 potential price file links for BAYHEALTH MILFORD MEMORIAL HOSPITAL
2025-04-01 20:02:10,548 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 20:02:10,549 - scripts.custom_status_tracker - INFO - Successfully updated hospital e9288e50-5999-4509-91a3-d4edd827dfc4 with not_found status
2025-04-01 20:02:10,551 - src.pipeline.orchestrator - INFO - Failed search for BAYHEALTH MILFORD MEMORIAL HOSPITAL completed in 54.05 seconds
2025-04-01 20:02:10,551 - scripts.run_price_finder - WARNING - Price finder returned None
2025-04-01 20:02:10,555 - scripts.run_price_finder - INFO - Successfully updated database for hospital BAYHEALTH MILFORD MEMORIAL HOSPITAL
2025-04-01 20:02:10,556 - scripts.run_price_finder - INFO - Successfully processed hospital BAYHEALTH MILFORD MEMORIAL HOSPITAL
2025-04-01 20:02:10,556 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x130f822d0>, 'search_attempts': 0, 'health_sys_city': 'Lewes', 'county': 'SUSSEX', 'last_search_date': None, 'latitude': 38.7717604700001, 'health_sys_state': 'DE', 'city': 'LEWES', 'corp_parent_name': 'BEEBE HEALTHCARE', 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 851601), 'longitude': -75.1432676699999, 'owner': 'NON-PROFIT', 'state': 'DE', 'website': None, 'updated_at': datetime.datetime(2025, 4, 1, 20, 10, 27, 494666), 'id': '9c071e45-01e9-4088-a9f4-dd5734ddb19c', 'price_transparency_url': None, 'helipad': True, 'zip_code': '19958', 'price_file_found': False, 'hospital_type': 'GENERAL ACUTE CARE', 'health_sys_id': 'sys_beebe_healthcare_lewes_de', 'search_status': 'pending', 'health_sys_name': 'Beebe Healthcare', 'status': 'OPEN', 'name': 'BEEBE MEDICAL CENTER', 'address': '424 SAVANNAH RD', 'population': 210}
2025-04-01 20:02:10,556 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': '9c071e45-01e9-4088-a9f4-dd5734ddb19c', 'name': 'BEEBE MEDICAL CENTER', 'website': 'https://www.beebemedicalcenter.org', 'city': 'LEWES', 'state': 'DE', 'health_system_name': 'Beebe Healthcare'}
2025-04-01 20:02:10,556 - scripts.run_price_finder - INFO - Processing hospital: BEEBE MEDICAL CENTER (ID: 9c071e45-01e9-4088-a9f4-dd5734ddb19c)
2025-04-01 20:02:10,557 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='9c071e45-01e9-4088-a9f4-dd5734ddb19c', name='BEEBE MEDICAL CENTER', state='DE', city='LEWES', address=None, website='https://www.beebemedicalcenter.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 20:02:10,557 - src.pipeline.orchestrator - INFO - Starting price file search for BEEBE MEDICAL CENTER (DE)
2025-04-01 20:02:10,558 - src.pipeline.orchestrator - INFO - Searching for price transparency files for BEEBE MEDICAL CENTER
2025-04-01 20:02:10,559 - src.searchers.serpapi_search - INFO - Searching for: BEEBE MEDICAL CENTER LEWES, DE price transparency standard charges
2025-04-01 20:02:10,559 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 20:02:11,875 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=BEEBE+MEDICAL+CENTER+LEWES%2C+DE+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 20:02:11,876 - src.searchers.serpapi_search - INFO - Found 14 results for query: BEEBE MEDICAL CENTER LEWES, DE price transparency standard charges
2025-04-01 20:02:11,876 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for BEEBE MEDICAL CENTER
2025-04-01 20:02:11,877 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 20:02:30,309 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 20:02:30,312 - src.pipeline.orchestrator - INFO - Crawling https://www.beebehealthcare.org/patients-visitors/understanding-medical-costs for BEEBE MEDICAL CENTER (#1 of top 3)
2025-04-01 20:02:30,312 - src.searchers.web_crawler - INFO - Crawling URL: https://www.beebehealthcare.org/patients-visitors/understanding-medical-costs
2025-04-01 20:02:32,330 - src.searchers.web_crawler - ERROR - Error fetching https://www.beebehealthcare.org/patients-visitors/understanding-medical-costs with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 20:02:32,352 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 20:02:41,164 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 20:02:41,170 - src.pipeline.orchestrator - INFO - Found 4 potential price file links for BEEBE MEDICAL CENTER
2025-04-01 20:02:41,170 - src.pipeline.orchestrator - INFO - Downloading file from https://www.beebehealthcare.org/standard-charges-machine-readable-file
2025-04-01 20:02:41,670 - src.searchers.web_crawler - ERROR - Failed to download file from https://www.beebehealthcare.org/standard-charges-machine-readable-file, status: 404
2025-04-01 20:02:41,670 - src.pipeline.orchestrator - WARNING - Failed to download file from https://www.beebehealthcare.org/standard-charges-machine-readable-file
2025-04-01 20:02:41,670 - src.pipeline.orchestrator - INFO - Downloading file from https://www.beebehealthcare.org/patients-visitors/financial-assistance
2025-04-01 20:02:42,056 - src.searchers.web_crawler - INFO - Downloaded file from https://www.beebehealthcare.org/patients-visitors/financial-assistance to downloads/financial-assistance
2025-04-01 20:02:42,056 - src.validators.file_validator - INFO - Invalid file extension: 
2025-04-01 20:02:42,056 - src.pipeline.orchestrator - INFO - File from https://www.beebehealthcare.org/patients-visitors/financial-assistance is not a valid price transparency file format
2025-04-01 20:02:42,056 - src.pipeline.orchestrator - INFO - Crawling https://www.cdmpricing.com/bdfcf79238cced1fa24bc49318040614 for BEEBE MEDICAL CENTER (#2 of top 3)
2025-04-01 20:02:42,057 - src.searchers.web_crawler - INFO - Crawling URL: https://www.cdmpricing.com/bdfcf79238cced1fa24bc49318040614
2025-04-01 20:02:43,333 - src.searchers.web_crawler - ERROR - Error fetching https://www.cdmpricing.com/bdfcf79238cced1fa24bc49318040614 with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 20:02:43,335 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 20:02:43,805 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 20:02:43,806 - src.pipeline.orchestrator - INFO - Found 0 potential price file links for BEEBE MEDICAL CENTER
2025-04-01 20:02:43,812 - scripts.custom_status_tracker - INFO - Successfully updated hospital 9c071e45-01e9-4088-a9f4-dd5734ddb19c with not_found status
2025-04-01 20:02:43,813 - src.pipeline.orchestrator - INFO - Failed search for BEEBE MEDICAL CENTER completed in 33.26 seconds
2025-04-01 20:02:43,813 - scripts.run_price_finder - WARNING - Price finder returned None
2025-04-01 20:02:43,816 - scripts.run_price_finder - INFO - Successfully updated database for hospital BEEBE MEDICAL CENTER
2025-04-01 20:02:43,816 - scripts.run_price_finder - INFO - Successfully processed hospital BEEBE MEDICAL CENTER
2025-04-01 20:02:43,816 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x130f81a30>, 'search_attempts': 0, 'health_sys_city': 'Dover', 'county': 'KENT', 'last_search_date': None, 'latitude': 39.1507908, 'health_sys_state': 'DE', 'city': 'DOVER', 'corp_parent_name': 'BAYHEALTH INC', 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 851600), 'longitude': -75.52369592, 'owner': 'NON-PROFIT', 'state': 'DE', 'website': None, 'updated_at': datetime.datetime(2025, 4, 1, 20, 10, 27, 508498), 'id': 'f7ec5e5f-45c5-4212-972c-0811d12de61e', 'price_transparency_url': None, 'helipad': True, 'zip_code': '19901', 'price_file_found': False, 'hospital_type': 'GENERAL ACUTE CARE', 'health_sys_id': 'sys_bayhealth_dover_de', 'search_status': 'pending', 'health_sys_name': 'Bayhealth', 'status': 'OPEN', 'name': 'BAYHEALTH HOSPITAL KENT CAMPUS', 'address': '640 SOUTH STATE ST', 'population': 266}
2025-04-01 20:02:43,816 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': 'f7ec5e5f-45c5-4212-972c-0811d12de61e', 'name': 'BAYHEALTH HOSPITAL KENT CAMPUS', 'website': 'https://www.bayhealthhospitalkentcampus.org', 'city': 'DOVER', 'state': 'DE', 'health_system_name': 'Bayhealth'}
2025-04-01 20:02:43,816 - scripts.run_price_finder - INFO - Processing hospital: BAYHEALTH HOSPITAL KENT CAMPUS (ID: f7ec5e5f-45c5-4212-972c-0811d12de61e)
2025-04-01 20:02:43,817 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='f7ec5e5f-45c5-4212-972c-0811d12de61e', name='BAYHEALTH HOSPITAL KENT CAMPUS', state='DE', city='DOVER', address=None, website='https://www.bayhealthhospitalkentcampus.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 20:02:43,817 - src.pipeline.orchestrator - INFO - Starting price file search for BAYHEALTH HOSPITAL KENT CAMPUS (DE)
2025-04-01 20:02:43,819 - src.pipeline.orchestrator - INFO - Searching for price transparency files for BAYHEALTH HOSPITAL KENT CAMPUS
2025-04-01 20:02:43,819 - src.searchers.serpapi_search - INFO - Searching for: BAYHEALTH HOSPITAL KENT CAMPUS DOVER, DE price transparency standard charges
2025-04-01 20:02:43,820 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 20:02:45,910 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=BAYHEALTH+HOSPITAL+KENT+CAMPUS+DOVER%2C+DE+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 20:02:45,912 - src.searchers.serpapi_search - INFO - Found 14 results for query: BAYHEALTH HOSPITAL KENT CAMPUS DOVER, DE price transparency standard charges
2025-04-01 20:02:45,912 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for BAYHEALTH HOSPITAL KENT CAMPUS
2025-04-01 20:02:45,913 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 20:03:08,811 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 20:03:08,817 - src.pipeline.orchestrator - INFO - Crawling https://www.bayhealth.org/-/media/files/patients-and-visitors/billing-financial-aid/price-transparency/2024/510064138_bayhealthmedicalcenter_kent_standardcharges.ashx for BAYHEALTH HOSPITAL KENT CAMPUS (#1 of top 3)
2025-04-01 20:03:08,818 - src.searchers.web_crawler - INFO - Crawling URL: https://www.bayhealth.org/-/media/files/patients-and-visitors/billing-financial-aid/price-transparency/2024/510064138_bayhealthmedicalcenter_kent_standardcharges.ashx
2025-04-01 20:03:15,255 - src.searchers.web_crawler - ERROR - Error fetching https://www.bayhealth.org/-/media/files/patients-and-visitors/billing-financial-aid/price-transparency/2024/510064138_bayhealthmedicalcenter_kent_standardcharges.ashx with aiohttp: 'utf-8' codec can't decode byte 0xa0 in position 4146262: invalid start byte
2025-04-01 20:03:16,209 - src.searchers.web_crawler - ERROR - Error fetching https://www.bayhealth.org/-/media/files/patients-and-visitors/billing-financial-aid/price-transparency/2024/510064138_bayhealthmedicalcenter_kent_standardcharges.ashx with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 20:03:16,211 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 20:03:16,281 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 20:03:29,153 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 20:03:29,156 - src.pipeline.orchestrator - INFO - Found 4 potential price file links for BAYHEALTH HOSPITAL KENT CAMPUS
2025-04-01 20:03:29,156 - src.pipeline.orchestrator - INFO - Downloading file from https://www.bayhealth.org/patients-visitors/your-healthcare-costs/machine-readable-files
2025-04-01 20:03:29,763 - src.searchers.web_crawler - ERROR - Failed to download file from https://www.bayhealth.org/patients-visitors/your-healthcare-costs/machine-readable-files, status: 404
2025-04-01 20:03:29,763 - src.pipeline.orchestrator - WARNING - Failed to download file from https://www.bayhealth.org/patients-visitors/your-healthcare-costs/machine-readable-files
2025-04-01 20:03:29,763 - src.pipeline.orchestrator - INFO - Downloading file from https://www.bayhealth.org/sites/default/files/2023-01/Kent%20General%20Hospital%20Standard%20Charges.json
2025-04-01 20:03:30,449 - src.searchers.web_crawler - ERROR - Failed to download file from https://www.bayhealth.org/sites/default/files/2023-01/Kent%20General%20Hospital%20Standard%20Charges.json, status: 404
2025-04-01 20:03:30,449 - src.pipeline.orchestrator - WARNING - Failed to download file from https://www.bayhealth.org/sites/default/files/2023-01/Kent%20General%20Hospital%20Standard%20Charges.json
2025-04-01 20:03:30,449 - src.pipeline.orchestrator - INFO - Crawling https://www.bayhealth.org/-/media/files/patients-and-visitors/healthcare-prices-guide/priceestimates-bro-100621-single-page.pdf for BAYHEALTH HOSPITAL KENT CAMPUS (#2 of top 3)
2025-04-01 20:03:30,449 - src.searchers.web_crawler - INFO - Crawling URL: https://www.bayhealth.org/-/media/files/patients-and-visitors/healthcare-prices-guide/priceestimates-bro-100621-single-page.pdf
2025-04-01 20:03:30,922 - src.searchers.web_crawler - ERROR - Error fetching https://www.bayhealth.org/-/media/files/patients-and-visitors/healthcare-prices-guide/priceestimates-bro-100621-single-page.pdf with aiohttp: 'utf-8' codec can't decode byte 0xe2 in position 10: invalid continuation byte
2025-04-01 20:03:31,774 - src.searchers.web_crawler - ERROR - Error fetching https://www.bayhealth.org/-/media/files/patients-and-visitors/healthcare-prices-guide/priceestimates-bro-100621-single-page.pdf with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 20:03:31,775 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 20:03:31,776 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 20:03:32,378 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 20:03:32,379 - src.pipeline.orchestrator - INFO - Found 0 potential price file links for BAYHEALTH HOSPITAL KENT CAMPUS
2025-04-01 20:03:32,379 - src.pipeline.orchestrator - INFO - Crawling https://www.bayhealth.org/patients/billing/price-transparency for BAYHEALTH HOSPITAL KENT CAMPUS (#3 of top 3)
2025-04-01 20:03:32,379 - src.searchers.web_crawler - INFO - Crawling URL: https://www.bayhealth.org/patients/billing/price-transparency
2025-04-01 20:03:33,045 - src.searchers.web_crawler - ERROR - Error fetching https://www.bayhealth.org/patients/billing/price-transparency with Playwright: object NoneType can't be used in 'await' expression
2025-04-01 20:03:33,047 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 20:03:33,060 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.mistral.ai:443
2025-04-01 20:03:38,224 - urllib3.connectionpool - DEBUG - https://api.mistral.ai:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2025-04-01 20:03:38,227 - src.pipeline.orchestrator - INFO - Found 4 potential price file links for BAYHEALTH HOSPITAL KENT CAMPUS
2025-04-01 20:03:38,227 - src.pipeline.orchestrator - INFO - Downloading file from 510064318_BayhealthMedicalCenter_Kent_StandardCharges.txt
2025-04-01 20:03:38,227 - src.searchers.web_crawler - ERROR - Error downloading file from 510064318_BayhealthMedicalCenter_Kent_StandardCharges.txt: 510064318_BayhealthMedicalCenter_Kent_StandardCharges.txt
2025-04-01 20:03:38,227 - src.pipeline.orchestrator - WARNING - Failed to download file from 510064318_BayhealthMedicalCenter_Kent_StandardCharges.txt
2025-04-01 20:03:38,227 - src.pipeline.orchestrator - INFO - Downloading file from https://www.bayhealth.org/-/media/files/patients-and-visitors/billing-financial-aid/price-transparency/dec-2024/823462523-bayhealthemergencyphysicians-standardcharges.txt
2025-04-01 20:03:38,392 - src.searchers.web_crawler - INFO - Downloaded file from https://www.bayhealth.org/-/media/files/patients-and-visitors/billing-financial-aid/price-transparency/dec-2024/823462523-bayhealthemergencyphysicians-standardcharges.txt to downloads/823462523_BayhealthEmergencyPhysicians_StandardCharges.txt
2025-04-01 20:03:38,393 - src.validators.file_validator - INFO - Not enough data rows: 8 < 10
2025-04-01 20:03:38,394 - src.validators.file_validator - ERROR - Error reading text file downloads/823462523_BayhealthEmergencyPhysicians_StandardCharges.txt: 
2025-04-01 20:03:38,394 - src.pipeline.orchestrator - INFO - File from https://www.bayhealth.org/-/media/files/patients-and-visitors/billing-financial-aid/price-transparency/dec-2024/823462523-bayhealthemergencyphysicians-standardcharges.txt is not a valid price transparency file format
2025-04-01 20:03:38,398 - scripts.custom_status_tracker - INFO - Successfully updated hospital f7ec5e5f-45c5-4212-972c-0811d12de61e with not_found status
2025-04-01 20:03:38,400 - src.pipeline.orchestrator - INFO - Failed search for BAYHEALTH HOSPITAL KENT CAMPUS completed in 54.58 seconds
2025-04-01 20:03:38,400 - scripts.run_price_finder - WARNING - Price finder returned None
2025-04-01 20:03:38,403 - scripts.run_price_finder - INFO - Successfully updated database for hospital BAYHEALTH HOSPITAL KENT CAMPUS
2025-04-01 20:03:38,403 - scripts.run_price_finder - INFO - Successfully processed hospital BAYHEALTH HOSPITAL KENT CAMPUS
2025-04-01 20:03:38,458 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 20:03:38,459 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 20:03:38,459 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 20:03:38,460 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
2025-04-01 20:10:49,489 - asyncio - DEBUG - Using selector: KqueueSelector
2025-04-01 20:10:49,489 - scripts.run_price_finder - INFO - Starting price finder integration - batch size: 1, state: DE
2025-04-01 20:10:49,489 - scripts.run_price_finder - DEBUG - Config loaded: {'serpapi_key': '6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a', 'openai_key': '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', 'mistral_key': '87QKmlS8vjw0woFXpLnUKVIqLkcMa8Lz', 'llm_provider': 'mistral', 'download_dir': 'downloads'}
2025-04-01 20:10:49,490 - scripts.custom_status_tracker - INFO - Initialized MainDBStatusTracker with main application database
2025-04-01 20:10:49,490 - scripts.run_price_finder - INFO - Status tracker initialized with main application database
2025-04-01 20:10:49,490 - scripts.run_price_finder - ERROR - Failed to initialize PriceFinderPipeline: PriceFinderPipeline.__init__() got an unexpected keyword argument 'status_tracker'
2025-04-01 20:10:49,490 - src.pipeline.orchestrator - INFO - Initializing pipeline components...
2025-04-01 20:10:49,510 - src.llm.link_analyzer - INFO - Initialized LLMLinkAnalyzer with provider=openai, model=gpt-4o
2025-04-01 20:10:49,516 - src.llm.link_analyzer - INFO - Initialized LLMLinkAnalyzer with provider=openai, model=gpt-4o
2025-04-01 20:10:49,517 - src.pipeline.orchestrator - INFO - Pipeline initialization complete
2025-04-01 20:10:49,517 - scripts.run_price_finder - INFO - Using default PriceFinderPipeline
2025-04-01 20:10:49,555 - scripts.run_price_finder - INFO - Found 1 hospitals to process
2025-04-01 20:10:49,555 - scripts.run_price_finder - DEBUG - Hospital object fields: {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x1177233b0>, 'address': '725 HORSEPOND RD', 'population': 104, 'county': 'KENT', 'health_sys_city': 'Norristown', 'search_attempts': 1, 'latitude': 39.15367085, 'health_sys_state': 'PA', 'last_search_date': datetime.datetime(2025, 4, 1, 17, 1, 6, 237243), 'city': 'DOVER', 'longitude': -75.4842601399999, 'corp_parent_name': 'UNIVERSAL HEALTH SERVICES INC', 'created_at': datetime.datetime(2025, 4, 1, 16, 59, 7, 851603), 'state': 'DE', 'owner': 'PROPRIETARY', 'website': None, 'updated_at': datetime.datetime(2025, 4, 2, 0, 10, 7, 370951), 'id': '52b51be3-6aa7-43c8-8525-d8ebf77b3be6', 'zip_code': '19901', 'helipad': False, 'price_transparency_url': None, 'hospital_type': 'PSYCHIATRIC', 'health_sys_id': 'sys_universal_health_services_norristown_pa', 'price_file_found': False, 'name': 'DOVER BEHAVIORAL HEALTH SYSTEM', 'status': 'OPEN', 'health_sys_name': 'Universal Health Services', 'search_status': 'pending'}
2025-04-01 20:10:49,555 - scripts.run_price_finder - INFO - Searching for price file for hospital: {'id': '52b51be3-6aa7-43c8-8525-d8ebf77b3be6', 'name': 'DOVER BEHAVIORAL HEALTH SYSTEM', 'website': 'https://www.doverbehavioralhealthsystem.org', 'city': 'DOVER', 'state': 'DE', 'health_system_name': 'Universal Health Services'}
2025-04-01 20:10:49,556 - scripts.run_price_finder - INFO - Processing hospital: DOVER BEHAVIORAL HEALTH SYSTEM (ID: 52b51be3-6aa7-43c8-8525-d8ebf77b3be6)
2025-04-01 20:10:49,556 - scripts.run_price_finder - DEBUG - Created pipeline hospital object: Hospital(id='52b51be3-6aa7-43c8-8525-d8ebf77b3be6', name='DOVER BEHAVIORAL HEALTH SYSTEM', state='DE', city='DOVER', address=None, website='https://www.doverbehavioralhealthsystem.org', health_system_name=None, price_transparency_url=None, url_validated=False, validation_date=None, last_search_date=None, search_status='pending', search_attempts=0)
2025-04-01 20:10:49,556 - src.pipeline.orchestrator - INFO - Starting price file search for DOVER BEHAVIORAL HEALTH SYSTEM (DE)
2025-04-01 20:10:49,556 - src.pipeline.status_tracker - ERROR - Error starting search for hospital 52b51be3-6aa7-43c8-8525-d8ebf77b3be6: FOREIGN KEY constraint failed
2025-04-01 20:10:49,556 - src.pipeline.orchestrator - INFO - Searching for price transparency files for DOVER BEHAVIORAL HEALTH SYSTEM
2025-04-01 20:10:49,556 - src.searchers.serpapi_search - INFO - Searching for: DOVER BEHAVIORAL HEALTH SYSTEM DOVER, DE price transparency standard charges
2025-04-01 20:10:49,557 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): serpapi.com:443
2025-04-01 20:10:51,045 - urllib3.connectionpool - DEBUG - https://serpapi.com:443 "GET /search?engine=google&q=DOVER+BEHAVIORAL+HEALTH+SYSTEM+DOVER%2C+DE+price+transparency+standard+charges&api_key=6d57e14bdf08c364978a63ccc98df618c8c033e2c9d572db667be74ad50c188a&num=10&gl=us&hl=en&output=json&source=python HTTP/1.1" 200 None
2025-04-01 20:10:51,047 - src.searchers.serpapi_search - INFO - Found 12 results for query: DOVER BEHAVIORAL HEALTH SYSTEM DOVER, DE price transparency standard charges
2025-04-01 20:10:51,047 - src.pipeline.orchestrator - INFO - Analyzing 10 search results for DOVER BEHAVIORAL HEALTH SYSTEM
2025-04-01 20:10:51,067 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': "\n        You are an expert at finding hospital price transparency information online.\n        \n        Your task is to analyze search results and determine which links are most likely to contain \n        price transparency information for a specific hospital.\n        \n        Hospital: DOVER BEHAVIORAL HEALTH SYSTEM\n        Location: DOVER, DE (if city available, otherwise just state)\n        \n        A good price transparency link should:\n        1. Lead directly to a hospital's official price list, chargemaster, or standard charges\n        2. Be from the hospital's official website (preferred) or a trusted healthcare portal\n        3. Contain machine-readable pricing data (CSVs, spreadsheets, or structured data)\n        4. Be specific to the exact hospital, not just the parent health system\n        5. Contain recent (within last 12 months) pricing information\n        \n        Bad links include:\n        1. News articles about price transparency\n        2. General information pages without actual pricing data\n        3. Links for different hospitals or healthcare systems\n        4. Academic or research papers about price transparency\n        5. Government policy pages without hospital-specific data\n        \n        For each link, provide a relevance score from 0.0 to 1.0, where:\n        - 0.0-0.2: Definitely not relevant\n        - 0.3-0.5: Possibly relevant but unclear\n        - 0.6-0.8: Likely relevant\n        - 0.9-1.0: Almost certainly relevant\n        \n        Also provide a brief reasoning for your score.\n        "}, {'role': 'user', 'content': 'Analyze these search results and determine which are most likely to contain price transparency data:\n\nResult 1:\nTitle: Standard Services | Dover Behavioral ...\nURL: https://doverbehavioral.com/standard-services/\nSnippet: View patient standard services pricing information for the inpatient, partial and outpatient treatment programs at Dover Behavioral Health in Dover, DE.\n\nResult 2:\nTitle: Dover Behavioral Health | Dover, DE | DoverBehavioral.com\nURL: https://doverbehavioral.com/\nSnippet: Dover Behavioral Health System offers acute psychiatric inpatient services ... Price Transparency · Language Assistance · Privacy Policy · Code of Conduct Policy ...\n\nResult 3:\nTitle: Price Transparency\nURL: https://www.bayhealth.org/patients/billing/price-transparency\nSnippet: Estimate the Cost of Your Care. Use our price estimate tool to calculate healthcare costs. Get an Estimate.\n\nResult 4:\nTitle: Contact Us | Mental Hospital Dover, DE\nURL: https://doverbehavioral.com/contact-us/\nSnippet: Call us at 302-741-0140. Licensed mental health professionals are available 24 hours a day, 7 days a week to assist you or your loved one.\n\nResult 5:\nTitle: Report: Delaware hospitals failed follow price transparency ...\nURL: https://www.delawareonline.com/story/news/health/2021/07/23/delaware-hospital-price-transparency-regulation-failed/8040517002/\nSnippet: No Delaware hospitals are complying with federal regulations to post its prices to its website, according to a recent report.\n\nResult 6:\nTitle: Provider Report for Dover Behavioral Health System\nURL: https://turquoise.health/providers/dover-behavioral-health-system/information\nSnippet: Detailed provider report for Dover Behavioral Health System in Dover, DE ... Price transparency compliance. Solutions. Providers. Hospitals and health ...\n\nResult 7:\nTitle: Semi-Annual Hospital Price Transparency Compliance ...\nURL: https://static1.squarespace.com/static/60065b8fc8cd610112ab89a7/t/60f1c225e1a54c0e42272fbf/1626456614723/PatientRightsAdvocate.org+Semi-Annual+Hospital+Compliance+Report.pdf\nSnippet: Standard charges file missing data for de identified min/max values that have negotiated rate prices. IP tab lists average, not gross, charge. 6 ...\n\nResult 8:\nTitle: PAM Health Rehabilitation Hospital of Dover\nURL: https://pamhealth.com/hospitals/pam-health-rehabilitation-hospital-of-dover/\nSnippet: The button below displays our standard hospital pricing and the prices paid by many insurance companies. It also allows you to comparison-shop among ...\n\nResult 9:\nTitle: Georgetown Delaware Psychiatric Hospital and Drug Rehab ...\nURL: https://sundelaware.com/\nSnippet: Meeting your current and future behavioral health and substance use treatment needs here in Delaware. Call today 302-604-5600.\n\nResult 10:\nTitle: Feb 2022 Compliance Report | PDF\nURL: https://www.scribd.com/document/558081562/PatientRightsAdvocate-org-Feb-2022-Compliance-Report\nSnippet: The document analyzes the compliance of 1,000 U.S. hospitals with federal price transparency regulations requiring the disclosure of negotiated prices.\n\n\n        Respond in JSON format with an array of objects, each containing:\n        - result_index: index of the result (1-based)\n        - url: the URL\n        - relevance_score: float between 0 and 1\n        - reasoning: brief explanation for the score\n        \n        Example:\n        ```json\n        [\n          {\n            "result_index": 1,\n            "url": "https://example.com/prices",\n            "relevance_score": 0.9,\n            "reasoning": "Official hospital website with direct link to machine-readable files"\n          },\n          ...\n        ]\n        ```\n        '}], 'model': 'gpt-4o', 'max_tokens': 2000, 'temperature': 0.1}}
2025-04-01 20:10:51,071 - httpcore.connection - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-04-01 20:10:51,133 - httpcore.connection - DEBUG - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x120248850>
2025-04-01 20:10:51,133 - httpcore.connection - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x1177fdac0> server_hostname='api.openai.com' timeout=5.0
2025-04-01 20:10:51,157 - httpcore.connection - DEBUG - start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x120d213d0>
2025-04-01 20:10:51,158 - httpcore.http11 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-04-01 20:10:51,158 - httpcore.http11 - DEBUG - send_request_headers.complete
2025-04-01 20:10:51,158 - httpcore.http11 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-04-01 20:10:51,158 - httpcore.http11 - DEBUG - send_request_body.complete
2025-04-01 20:10:51,158 - httpcore.http11 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-04-01 20:10:51,299 - httpcore.http11 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 429, b'Too Many Requests', [(b'Date', b'Wed, 02 Apr 2025 00:10:51 GMT'), (b'Content-Type', b'application/json; charset=utf-8'), (b'Content-Length', b'337'), (b'Connection', b'keep-alive'), (b'vary', b'Origin'), (b'x-request-id', b'req_d56e6cad710d642772b08abd76b7a811'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=1D1kDzE_sClXYKMXz8MkdlqwnmYdCTNRC1JYRUP62kM-1743552651-1.0.1.1-EdTIsfgRRpHjZTS1w80x55rzYmuq03Vx.yHyfwuI5siQTr8Z9ax5aYjJTP0lQ.iyFEokom_z84cFnzTqVZ5TDY4FtafLwIDPjsInvU0Khz0; path=/; expires=Wed, 02-Apr-25 00:40:51 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=9yBMfmTY8Z0WgiUaSc39oNjyh6pKof8e.0iEe3.0IV4-1743552651391-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'929c1b067e092dae-EWR'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-04-01 20:10:51,299 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-04-01 20:10:51,299 - httpcore.http11 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-04-01 20:10:51,300 - httpcore.http11 - DEBUG - receive_response_body.complete
2025-04-01 20:10:51,300 - httpcore.http11 - DEBUG - response_closed.started
2025-04-01 20:10:51,300 - httpcore.http11 - DEBUG - response_closed.complete
2025-04-01 20:10:51,300 - openai._base_client - DEBUG - HTTP Request: POST https://api.openai.com/v1/chat/completions "429 Too Many Requests"
2025-04-01 20:10:51,300 - openai._base_client - DEBUG - Encountered httpx.HTTPStatusError
Traceback (most recent call last):
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/openai/_base_client.py", line 1541, in _request
    response.raise_for_status()
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2025-04-01 20:10:51,302 - openai._base_client - DEBUG - Retrying due to status code 429
2025-04-01 20:10:51,303 - openai._base_client - DEBUG - 2 retries left
2025-04-01 20:10:51,303 - openai._base_client - INFO - Retrying request to /chat/completions in 0.428173 seconds
2025-04-01 20:10:51,732 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': "\n        You are an expert at finding hospital price transparency information online.\n        \n        Your task is to analyze search results and determine which links are most likely to contain \n        price transparency information for a specific hospital.\n        \n        Hospital: DOVER BEHAVIORAL HEALTH SYSTEM\n        Location: DOVER, DE (if city available, otherwise just state)\n        \n        A good price transparency link should:\n        1. Lead directly to a hospital's official price list, chargemaster, or standard charges\n        2. Be from the hospital's official website (preferred) or a trusted healthcare portal\n        3. Contain machine-readable pricing data (CSVs, spreadsheets, or structured data)\n        4. Be specific to the exact hospital, not just the parent health system\n        5. Contain recent (within last 12 months) pricing information\n        \n        Bad links include:\n        1. News articles about price transparency\n        2. General information pages without actual pricing data\n        3. Links for different hospitals or healthcare systems\n        4. Academic or research papers about price transparency\n        5. Government policy pages without hospital-specific data\n        \n        For each link, provide a relevance score from 0.0 to 1.0, where:\n        - 0.0-0.2: Definitely not relevant\n        - 0.3-0.5: Possibly relevant but unclear\n        - 0.6-0.8: Likely relevant\n        - 0.9-1.0: Almost certainly relevant\n        \n        Also provide a brief reasoning for your score.\n        "}, {'role': 'user', 'content': 'Analyze these search results and determine which are most likely to contain price transparency data:\n\nResult 1:\nTitle: Standard Services | Dover Behavioral ...\nURL: https://doverbehavioral.com/standard-services/\nSnippet: View patient standard services pricing information for the inpatient, partial and outpatient treatment programs at Dover Behavioral Health in Dover, DE.\n\nResult 2:\nTitle: Dover Behavioral Health | Dover, DE | DoverBehavioral.com\nURL: https://doverbehavioral.com/\nSnippet: Dover Behavioral Health System offers acute psychiatric inpatient services ... Price Transparency · Language Assistance · Privacy Policy · Code of Conduct Policy ...\n\nResult 3:\nTitle: Price Transparency\nURL: https://www.bayhealth.org/patients/billing/price-transparency\nSnippet: Estimate the Cost of Your Care. Use our price estimate tool to calculate healthcare costs. Get an Estimate.\n\nResult 4:\nTitle: Contact Us | Mental Hospital Dover, DE\nURL: https://doverbehavioral.com/contact-us/\nSnippet: Call us at 302-741-0140. Licensed mental health professionals are available 24 hours a day, 7 days a week to assist you or your loved one.\n\nResult 5:\nTitle: Report: Delaware hospitals failed follow price transparency ...\nURL: https://www.delawareonline.com/story/news/health/2021/07/23/delaware-hospital-price-transparency-regulation-failed/8040517002/\nSnippet: No Delaware hospitals are complying with federal regulations to post its prices to its website, according to a recent report.\n\nResult 6:\nTitle: Provider Report for Dover Behavioral Health System\nURL: https://turquoise.health/providers/dover-behavioral-health-system/information\nSnippet: Detailed provider report for Dover Behavioral Health System in Dover, DE ... Price transparency compliance. Solutions. Providers. Hospitals and health ...\n\nResult 7:\nTitle: Semi-Annual Hospital Price Transparency Compliance ...\nURL: https://static1.squarespace.com/static/60065b8fc8cd610112ab89a7/t/60f1c225e1a54c0e42272fbf/1626456614723/PatientRightsAdvocate.org+Semi-Annual+Hospital+Compliance+Report.pdf\nSnippet: Standard charges file missing data for de identified min/max values that have negotiated rate prices. IP tab lists average, not gross, charge. 6 ...\n\nResult 8:\nTitle: PAM Health Rehabilitation Hospital of Dover\nURL: https://pamhealth.com/hospitals/pam-health-rehabilitation-hospital-of-dover/\nSnippet: The button below displays our standard hospital pricing and the prices paid by many insurance companies. It also allows you to comparison-shop among ...\n\nResult 9:\nTitle: Georgetown Delaware Psychiatric Hospital and Drug Rehab ...\nURL: https://sundelaware.com/\nSnippet: Meeting your current and future behavioral health and substance use treatment needs here in Delaware. Call today 302-604-5600.\n\nResult 10:\nTitle: Feb 2022 Compliance Report | PDF\nURL: https://www.scribd.com/document/558081562/PatientRightsAdvocate-org-Feb-2022-Compliance-Report\nSnippet: The document analyzes the compliance of 1,000 U.S. hospitals with federal price transparency regulations requiring the disclosure of negotiated prices.\n\n\n        Respond in JSON format with an array of objects, each containing:\n        - result_index: index of the result (1-based)\n        - url: the URL\n        - relevance_score: float between 0 and 1\n        - reasoning: brief explanation for the score\n        \n        Example:\n        ```json\n        [\n          {\n            "result_index": 1,\n            "url": "https://example.com/prices",\n            "relevance_score": 0.9,\n            "reasoning": "Official hospital website with direct link to machine-readable files"\n          },\n          ...\n        ]\n        ```\n        '}], 'model': 'gpt-4o', 'max_tokens': 2000, 'temperature': 0.1}}
2025-04-01 20:10:51,733 - httpcore.http11 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-04-01 20:10:51,733 - httpcore.http11 - DEBUG - send_request_headers.complete
2025-04-01 20:10:51,733 - httpcore.http11 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-04-01 20:10:51,733 - httpcore.http11 - DEBUG - send_request_body.complete
2025-04-01 20:10:51,733 - httpcore.http11 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-04-01 20:10:51,886 - httpcore.http11 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 429, b'Too Many Requests', [(b'Date', b'Wed, 02 Apr 2025 00:10:51 GMT'), (b'Content-Type', b'application/json; charset=utf-8'), (b'Content-Length', b'337'), (b'Connection', b'keep-alive'), (b'vary', b'Origin'), (b'x-request-id', b'req_724aff5472307b3f44a9da7a778da0c1'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'929c1b0a1e6b2dae-EWR'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-04-01 20:10:51,887 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-04-01 20:10:51,887 - httpcore.http11 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-04-01 20:10:51,887 - httpcore.http11 - DEBUG - receive_response_body.complete
2025-04-01 20:10:51,887 - httpcore.http11 - DEBUG - response_closed.started
2025-04-01 20:10:51,887 - httpcore.http11 - DEBUG - response_closed.complete
2025-04-01 20:10:51,887 - openai._base_client - DEBUG - HTTP Request: POST https://api.openai.com/v1/chat/completions "429 Too Many Requests"
2025-04-01 20:10:51,887 - openai._base_client - DEBUG - Encountered httpx.HTTPStatusError
Traceback (most recent call last):
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/openai/_base_client.py", line 1541, in _request
    response.raise_for_status()
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/openai/_base_client.py", line 1541, in _request
    response.raise_for_status()
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2025-04-01 20:10:51,888 - openai._base_client - DEBUG - Retrying due to status code 429
2025-04-01 20:10:51,888 - openai._base_client - DEBUG - 1 retry left
2025-04-01 20:10:51,888 - openai._base_client - INFO - Retrying request to /chat/completions in 0.975301 seconds
2025-04-01 20:10:52,864 - openai._base_client - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': "\n        You are an expert at finding hospital price transparency information online.\n        \n        Your task is to analyze search results and determine which links are most likely to contain \n        price transparency information for a specific hospital.\n        \n        Hospital: DOVER BEHAVIORAL HEALTH SYSTEM\n        Location: DOVER, DE (if city available, otherwise just state)\n        \n        A good price transparency link should:\n        1. Lead directly to a hospital's official price list, chargemaster, or standard charges\n        2. Be from the hospital's official website (preferred) or a trusted healthcare portal\n        3. Contain machine-readable pricing data (CSVs, spreadsheets, or structured data)\n        4. Be specific to the exact hospital, not just the parent health system\n        5. Contain recent (within last 12 months) pricing information\n        \n        Bad links include:\n        1. News articles about price transparency\n        2. General information pages without actual pricing data\n        3. Links for different hospitals or healthcare systems\n        4. Academic or research papers about price transparency\n        5. Government policy pages without hospital-specific data\n        \n        For each link, provide a relevance score from 0.0 to 1.0, where:\n        - 0.0-0.2: Definitely not relevant\n        - 0.3-0.5: Possibly relevant but unclear\n        - 0.6-0.8: Likely relevant\n        - 0.9-1.0: Almost certainly relevant\n        \n        Also provide a brief reasoning for your score.\n        "}, {'role': 'user', 'content': 'Analyze these search results and determine which are most likely to contain price transparency data:\n\nResult 1:\nTitle: Standard Services | Dover Behavioral ...\nURL: https://doverbehavioral.com/standard-services/\nSnippet: View patient standard services pricing information for the inpatient, partial and outpatient treatment programs at Dover Behavioral Health in Dover, DE.\n\nResult 2:\nTitle: Dover Behavioral Health | Dover, DE | DoverBehavioral.com\nURL: https://doverbehavioral.com/\nSnippet: Dover Behavioral Health System offers acute psychiatric inpatient services ... Price Transparency · Language Assistance · Privacy Policy · Code of Conduct Policy ...\n\nResult 3:\nTitle: Price Transparency\nURL: https://www.bayhealth.org/patients/billing/price-transparency\nSnippet: Estimate the Cost of Your Care. Use our price estimate tool to calculate healthcare costs. Get an Estimate.\n\nResult 4:\nTitle: Contact Us | Mental Hospital Dover, DE\nURL: https://doverbehavioral.com/contact-us/\nSnippet: Call us at 302-741-0140. Licensed mental health professionals are available 24 hours a day, 7 days a week to assist you or your loved one.\n\nResult 5:\nTitle: Report: Delaware hospitals failed follow price transparency ...\nURL: https://www.delawareonline.com/story/news/health/2021/07/23/delaware-hospital-price-transparency-regulation-failed/8040517002/\nSnippet: No Delaware hospitals are complying with federal regulations to post its prices to its website, according to a recent report.\n\nResult 6:\nTitle: Provider Report for Dover Behavioral Health System\nURL: https://turquoise.health/providers/dover-behavioral-health-system/information\nSnippet: Detailed provider report for Dover Behavioral Health System in Dover, DE ... Price transparency compliance. Solutions. Providers. Hospitals and health ...\n\nResult 7:\nTitle: Semi-Annual Hospital Price Transparency Compliance ...\nURL: https://static1.squarespace.com/static/60065b8fc8cd610112ab89a7/t/60f1c225e1a54c0e42272fbf/1626456614723/PatientRightsAdvocate.org+Semi-Annual+Hospital+Compliance+Report.pdf\nSnippet: Standard charges file missing data for de identified min/max values that have negotiated rate prices. IP tab lists average, not gross, charge. 6 ...\n\nResult 8:\nTitle: PAM Health Rehabilitation Hospital of Dover\nURL: https://pamhealth.com/hospitals/pam-health-rehabilitation-hospital-of-dover/\nSnippet: The button below displays our standard hospital pricing and the prices paid by many insurance companies. It also allows you to comparison-shop among ...\n\nResult 9:\nTitle: Georgetown Delaware Psychiatric Hospital and Drug Rehab ...\nURL: https://sundelaware.com/\nSnippet: Meeting your current and future behavioral health and substance use treatment needs here in Delaware. Call today 302-604-5600.\n\nResult 10:\nTitle: Feb 2022 Compliance Report | PDF\nURL: https://www.scribd.com/document/558081562/PatientRightsAdvocate-org-Feb-2022-Compliance-Report\nSnippet: The document analyzes the compliance of 1,000 U.S. hospitals with federal price transparency regulations requiring the disclosure of negotiated prices.\n\n\n        Respond in JSON format with an array of objects, each containing:\n        - result_index: index of the result (1-based)\n        - url: the URL\n        - relevance_score: float between 0 and 1\n        - reasoning: brief explanation for the score\n        \n        Example:\n        ```json\n        [\n          {\n            "result_index": 1,\n            "url": "https://example.com/prices",\n            "relevance_score": 0.9,\n            "reasoning": "Official hospital website with direct link to machine-readable files"\n          },\n          ...\n        ]\n        ```\n        '}], 'model': 'gpt-4o', 'max_tokens': 2000, 'temperature': 0.1}}
2025-04-01 20:10:52,865 - httpcore.http11 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-04-01 20:10:52,865 - httpcore.http11 - DEBUG - send_request_headers.complete
2025-04-01 20:10:52,865 - httpcore.http11 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-04-01 20:10:52,865 - httpcore.http11 - DEBUG - send_request_body.complete
2025-04-01 20:10:52,865 - httpcore.http11 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-04-01 20:10:52,989 - httpcore.http11 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 429, b'Too Many Requests', [(b'Date', b'Wed, 02 Apr 2025 00:10:53 GMT'), (b'Content-Type', b'application/json; charset=utf-8'), (b'Content-Length', b'337'), (b'Connection', b'keep-alive'), (b'vary', b'Origin'), (b'x-request-id', b'req_4e8fc0a8cb7a6a3919d12977cb91bf87'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'929c1b112fb72dae-EWR'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-04-01 20:10:52,990 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 429 Too Many Requests"
2025-04-01 20:10:52,990 - httpcore.http11 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-04-01 20:10:52,990 - httpcore.http11 - DEBUG - receive_response_body.complete
2025-04-01 20:10:52,990 - httpcore.http11 - DEBUG - response_closed.started
2025-04-01 20:10:52,990 - httpcore.http11 - DEBUG - response_closed.complete
2025-04-01 20:10:52,990 - openai._base_client - DEBUG - HTTP Request: POST https://api.openai.com/v1/chat/completions "429 Too Many Requests"
2025-04-01 20:10:52,990 - openai._base_client - DEBUG - Encountered httpx.HTTPStatusError
Traceback (most recent call last):
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/openai/_base_client.py", line 1541, in _request
    response.raise_for_status()
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/openai/_base_client.py", line 1541, in _request
    response.raise_for_status()
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/openai/_base_client.py", line 1541, in _request
    response.raise_for_status()
  File "/Users/bentenner/OmegaReal/.venv/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '429 Too Many Requests' for url 'https://api.openai.com/v1/chat/completions'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
2025-04-01 20:10:52,991 - openai._base_client - DEBUG - Re-raising status error
2025-04-01 20:10:52,991 - src.llm.link_analyzer - ERROR - Error calling OpenAI API: Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}}
2025-04-01 20:10:52,991 - src.pipeline.orchestrator - WARNING - No relevant links found for DOVER BEHAVIORAL HEALTH SYSTEM
2025-04-01 20:10:52,991 - src.pipeline.status_tracker - ERROR - Error marking failure for hospital 52b51be3-6aa7-43c8-8525-d8ebf77b3be6: FOREIGN KEY constraint failed
2025-04-01 20:10:52,992 - src.pipeline.orchestrator - INFO - Search for DOVER BEHAVIORAL HEALTH SYSTEM completed in 3.44 seconds
2025-04-01 20:10:53,000 - scripts.run_price_finder - INFO - Successfully updated database for hospital DOVER BEHAVIORAL HEALTH SYSTEM
2025-04-01 20:10:53,000 - scripts.run_price_finder - INFO - Successfully processed hospital DOVER BEHAVIORAL HEALTH SYSTEM
